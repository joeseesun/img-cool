"use strict";var Vo=Object.create;var Or=Object.defineProperty;var Go=Object.getOwnPropertyDescriptor;var Zo=Object.getOwnPropertyNames;var Yo=Object.getPrototypeOf,Xo=Object.prototype.hasOwnProperty;var Jo=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Zo(t))!Xo.call(e,o)&&o!==r&&Or(e,o,{get:()=>t[o],enumerable:!(n=Go(t,o))||n.enumerable});return e};var Qo=(e,t,r)=>(r=e!=null?Vo(Yo(e)):{},Jo(t||!e||!e.__esModule?Or(r,"default",{value:e,enumerable:!0}):r,e));const s=require("react/jsx-runtime"),Z=require("@plait-board/react-board"),m=require("@plait/core"),E=require("react"),P=require("@plait/common"),j=require("@plait/draw"),I=require("@plait/mind"),ei=require("mobile-detect"),ti=require("react-dom"),D=require("classnames"),F=require("@floating-ui/react"),pe=require("@plait/text-plugins"),ri=require("lodash");function ni(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:()=>e[r]})}}return t.default=e,Object.freeze(t)}const K=ni(E);var ut=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var He={},Tr;function ii(){if(Tr)return He;Tr=1;var e=ti;if(process.env.NODE_ENV==="production")He.createRoot=e.createRoot,He.hydrateRoot=e.hydrateRoot;else{var t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;He.createRoot=function(r,n){t.usingClientEntryPoint=!0;try{return e.createRoot(r,n)}finally{t.usingClientEntryPoint=!1}},He.hydrateRoot=function(r,n,o){t.usingClientEntryPoint=!0;try{return e.hydrateRoot(r,n,o)}finally{t.usingClientEntryPoint=!1}}}return He}var Dn=ii();const Mr=e=>s.jsx("span",{className:"mind-node-emoji",style:{fontSize:`${e.fontSize}px`},children:e.emojiItem.name}),si=e=>{const t=e;return e.setPluginOptions(I.WithMindPluginKey,{emojiPadding:0,spaceBetweenEmojis:4}),t.renderEmoji=(r,n)=>{const o=document.createElement("span");r.appendChild(o);const i=Dn.createRoot(o);i.render(s.jsx(Mr,{...n}));let a={...n};return{destroy:()=>{setTimeout(()=>{i.unmount()},0)},update:c=>{a={...a,...c},i.render(s.jsx(Mr,{...a}))}}},t},Dr=e=>{const t={src:e.imageItem.url,draggable:!1,width:"100%"};return s.jsx("div",{children:s.jsx("img",{...t,className:D("image-origin",{"image-origin--focus":e.isFocus})})})};var qe=(e=>(e.COPY="copy",e.PASTE="paste",e.CUT="cut",e.KEYDOWN="keydown",e.KEYUP="keyup",e.MOUSE_MOVE="mousemove",e.RESIZE="resize",e.UNLOAD="unload",e.FOCUS="focus",e.BLUR="blur",e.DRAG_OVER="dragover",e.DROP="drop",e.GESTURE_END="gestureend",e.BEFORE_UNLOAD="beforeunload",e.GESTURE_START="gesturestart",e.GESTURE_CHANGE="gesturechange",e.POINTER_MOVE="pointermove",e.POINTER_DOWN="pointerdown",e.POINTER_UP="pointerup",e.STATE_CHANGE="statechange",e.WHEEL="wheel",e.TOUCH_START="touchstart",e.TOUCH_END="touchend",e.HASHCHANGE="hashchange",e.VISIBILITY_CHANGE="visibilitychange",e.SCROLL="scroll",e.MENU_ITEM_SELECT="menu.itemSelect",e.MESSAGE="message",e.FULLSCREENCHANGE="fullscreenchange",e))(qe||{});const lr={svg:"image/svg+xml",png:"image/png",jpg:"image/jpeg",gif:"image/gif",webp:"image/webp",bmp:"image/bmp",ico:"image/x-icon",avif:"image/avif",jfif:"image/jfif"},cr={json:"application/json",drawnix:"application/vnd.drawnix+json",...lr},ai={drawnix:1},ur=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),li=ur?Promise.resolve().then(function(){return mi}):Promise.resolve().then(function(){return xi});async function ci(...e){return(await li).default(...e)}ur?Promise.resolve().then(function(){return pi}):Promise.resolve().then(function(){return bi});const ui=ur?Promise.resolve().then(function(){return wi}):Promise.resolve().then(function(){return ji});async function di(...e){return(await ui).default(...e)}const fi=async e=>{const t=await e.getFile();return t.handle=e,t};var hi=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const t=[];e.forEach((o,i)=>{t[i]={description:o.description||"Files",accept:{}},o.mimeTypes?o.mimeTypes.map(a=>{t[i].accept[a]=o.extensions||[]}):t[i].accept["*/*"]=o.extensions||[]});const r=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:t,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),n=await Promise.all(r.map(fi));return e[0].multiple?n:n[0]},mi={__proto__:null,default:hi};function mt(e){function t(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then(function(o){return{value:o,done:n}})}return mt=function(r){this.s=r,this.n=r.next},mt.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var n=this.s.return;return n===void 0?Promise.resolve({value:r,done:!0}):t(n.apply(this.s,arguments))},throw:function(r){var n=this.s.return;return n===void 0?Promise.reject(r):t(n.apply(this.s,arguments))}},new mt(e)}const _n=async(e,t,r=e.name,n)=>{const o=[],i=[];var a,l=!1,c=!1;try{for(var u,d=function(h){var f,g,y,v=2;for(typeof Symbol<"u"&&(g=Symbol.asyncIterator,y=Symbol.iterator);v--;){if(g&&(f=h[g])!=null)return f.call(h);if(y&&(f=h[y])!=null)return new mt(f.call(h));g="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());l=!(u=await d.next()).done;l=!1){const h=u.value,f=`${r}/${h.name}`;h.kind==="file"?i.push(h.getFile().then(g=>(g.directoryHandle=e,g.handle=h,Object.defineProperty(g,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>f})))):h.kind!=="directory"||!t||n&&n(h)||o.push(_n(h,t,f,n))}}catch(h){c=!0,a=h}finally{try{l&&d.return!=null&&await d.return()}finally{if(c)throw a}}return[...(await Promise.all(o)).flat(),...await Promise.all(i)]};var gi=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const t=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await t.values()).next()).done?[t]:_n(t,e.recursive,void 0,e.skipDirectory)},pi={__proto__:null,default:gi},vi=async(e,t=[{}],r=null,n=!1,o=null)=>{Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||"Untitled";const i=[];let a=null;if(e instanceof Blob&&e.type?a=e.type:e.headers&&e.headers.get("content-type")&&(a=e.headers.get("content-type")),t.forEach((u,d)=>{i[d]={description:u.description||"Files",accept:{}},u.mimeTypes?(d===0&&a&&u.mimeTypes.push(a),u.mimeTypes.map(h=>{i[d].accept[h]=u.extensions||[]})):a?i[d].accept[a]=u.extensions||[]:i[d].accept["*/*"]=u.extensions||[]}),r)try{await r.getFile()}catch(u){if(r=null,n)throw u}const l=r||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:i,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1});!r&&o&&o(l);const c=await l.createWritable();return"stream"in e?(await e.stream().pipeTo(c),l):"body"in e?(await e.body.pipeTo(c),l):(await c.write(await e),await c.close(),l)},wi={__proto__:null,default:vi},yi=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((t,r)=>{const n=document.createElement("input");n.type="file";const o=[...e.map(c=>c.mimeTypes||[]),...e.map(c=>c.extensions||[])].join();n.multiple=e[0].multiple||!1,n.accept=o||"",n.style.display="none",document.body.append(n);const i=c=>{typeof a=="function"&&a(),t(c)},a=e[0].legacySetup&&e[0].legacySetup(i,()=>a(r),n),l=()=>{window.removeEventListener("focus",l),n.remove()};n.addEventListener("click",()=>{window.addEventListener("focus",l)}),n.addEventListener("change",()=>{window.removeEventListener("focus",l),n.remove(),i(n.multiple?Array.from(n.files):n.files[0])}),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()})),xi={__proto__:null,default:yi},Ci=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((t,r)=>{const n=document.createElement("input");n.type="file",n.webkitdirectory=!0;const o=a=>{typeof i=="function"&&i(),t(a)},i=e[0].legacySetup&&e[0].legacySetup(o,()=>i(r),n);n.addEventListener("change",()=>{let a=Array.from(n.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(a=a.filter(l=>l.webkitRelativePath.split("/").every(c=>!e[0].skipDirectory({name:c,kind:"directory"})))):a=a.filter(l=>l.webkitRelativePath.split("/").length===2),o(a)}),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()})),bi={__proto__:null,default:Ci},Ei=async(e,t={})=>{Array.isArray(t)&&(t=t[0]);const r=document.createElement("a");let n=e;"body"in e&&(n=await async function(a,l){const c=a.getReader(),u=new ReadableStream({start:f=>async function g(){return c.read().then(({done:y,value:v})=>{if(!y)return f.enqueue(v),g();f.close()})}()}),d=new Response(u),h=await d.blob();return c.releaseLock(),new Blob([h],{type:l})}(e.body,e.headers.get("content-type"))),r.download=t.fileName||"Untitled",r.href=URL.createObjectURL(await n);const o=()=>{typeof i=="function"&&i()},i=t.legacySetup&&t.legacySetup(o,()=>i(),r);return r.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(r.href),3e4),o()}),r.click(),null},ji={__proto__:null,default:Ei};const Bn=e=>{var n,o;const t=(n=e.extensions)==null?void 0:n.reduce((i,a)=>(i.push(cr[a]),i),[]),r=(o=e.extensions)==null?void 0:o.reduce((i,a)=>a==="jpg"?i.concat(".jpg",".jpeg"):i.concat(`.${a}`),[]);return ci({description:e.description,extensions:r,mimeTypes:t,multiple:e.multiple??!1})},ki=(e,t)=>di(e,{fileName:`${t.name}.${t.extension}`,description:t.description,extensions:[`.${t.extension}`]},t.fileHandle);var dr=(e=>(e.drawnix="drawnix",e))(dr||{});const Pi=()=>new Date().getTime().toString(),Fn=async(e,t=Pi())=>{const r=Oi(e),n=new Blob([r],{type:cr.drawnix});return{fileHandle:await ki(n,{name:t,extension:"drawnix",description:"Drawnix file"})}},Si=async e=>{const t=await Bn({description:"Drawnix files"});return Ti(e,await _i(t))},Li=e=>e&&e.type===dr.drawnix&&Array.isArray(e.elements)&&typeof e.viewport=="object",Oi=e=>{const t={type:dr.drawnix,version:ai.drawnix,source:"web",elements:e.children,viewport:e.viewport};return JSON.stringify(t,null,2)},Ti=async(e,t)=>{const r=await Bi(t);let n;try{if(n=JSON.parse(r),Li(n))return n;throw new Error("Error: invalid file")}catch{throw new Error("Error: invalid file")}},Mi=(e,t,r)=>new File([e],r||"",{type:t}),Di=e=>"arrayBuffer"in e?e.arrayBuffer():new Promise((t,r)=>{const n=new FileReader;n.onload=o=>{var i;if(!((i=o.target)!=null&&i.result))return r(new Error("Couldn't convert blob to ArrayBuffer"));t(o.target.result)},n.readAsArrayBuffer(e)}),_i=async e=>{var t;return e.type||(t=e==null?void 0:e.name)!=null&&t.endsWith(".drawnix")&&(e=Mi(await Di(e),cr.drawnix,e.name)),e},Bi=async e=>{let t;return"text"in Blob?t=await e.text():t=await new Promise(r=>{const n=new FileReader;n.readAsText(e,"utf8"),n.onloadend=()=>{n.readyState===FileReader.DONE&&r(n.result)}}),t},Fi=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const o=n.result;t(o)},n.onerror=o=>r(o),n.readAsDataURL(e)}),_r=e=>!!e&&Object.values(lr).includes(e),Ai=e=>new Promise((t,r)=>{const n=new Image;n.onload=()=>{t(n)},n.onerror=o=>{r(o)},n.src=e}),Ii=(e,t,r)=>{const n=e.width>r?r:e.width,o=n/e.width*e.height;return{url:t,width:n,height:o}},pt=async(e,t,r,n)=>{const o=m.getSelectedElements(e)[0]||P.getElementOfFocusedImage(e),i=o?240:400,a=await Fi(t),l=await Ai(a),c=Ii(l,a,i),u=r&&m.getHitElementByPoint(e,r);if(n&&u&&I.MindElement.isMindElement(e,u)){I.MindTransforms.setImage(e,u,c);return}o&&I.MindElement.isMindElement(e,o)&&!n?I.MindTransforms.setImage(e,o,c):j.DrawTransforms.insertImage(e,c,r)};class Ri{constructor(t={}){this.overlay=null,this.imageContainer=null,this.image=null,this.closeButton=null,this.controlsContainer=null,this.delegationHandler=null,this.dragHandler=null,this.mouseUpHandler=null,this.animationFrameId=null,this.pendingUpdate=!1,this.state={zoom:1,x:0,y:0,isDragging:!1,dragStartX:0,dragStartY:0,imageStartX:0,imageStartY:0},this.styleElement=null,this.options={zoomStep:t.zoomStep||.2,minZoom:t.minZoom||.1,maxZoom:t.maxZoom||5,enableKeyboard:t.enableKeyboard!==!1},this.addStyles(),this.bindEvents()}open(t,r=""){this.createOverlay(),this.createImage(t,r),this.resetState(),document.body.style.overflow="hidden"}close(){this.overlay&&(this.cleanupDragEvents(),document.removeEventListener("mousemove",this.delegationHandler),document.removeEventListener("mouseup",this.delegationHandler),document.removeEventListener("keydown",this.delegationHandler),document.removeEventListener("wheel",this.delegationHandler),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),document.body.removeChild(this.overlay),this.overlay=null,this.image=null,this.imageContainer=null,this.closeButton=null,this.controlsContainer=null,this.delegationHandler=null,this.dragHandler=null,this.mouseUpHandler=null,this.pendingUpdate=!1),document.body.style.overflow=""}createOverlay(){this.overlay=document.createElement("div"),this.overlay.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(45, 45, 45, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      cursor: grab;
    `,this.overlay.addEventListener("click",t=>{t.target===this.overlay&&this.close()}),this.createCloseButton(),this.createControls(),document.body.appendChild(this.overlay)}createCloseButton(){this.closeButton=document.createElement("div"),this.closeButton.innerHTML="×",this.closeButton.className="image-viewer-close-btn",this.closeButton.addEventListener("click",()=>this.close()),this.overlay.appendChild(this.closeButton)}createControls(){this.controlsContainer=document.createElement("div"),this.controlsContainer.style.cssText=`
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 10001;
    `,this.addStyles();const t=document.createElement("button");t.innerHTML="+",t.className="image-viewer-control-btn",t.addEventListener("click",()=>this.zoomIn());const r=document.createElement("button");r.innerHTML="-",r.className="image-viewer-control-btn",r.addEventListener("click",()=>this.zoomOut());const n=document.createElement("button");n.innerHTML="⌂",n.className="image-viewer-control-btn",n.addEventListener("click",()=>this.resetState()),this.controlsContainer.appendChild(r),this.controlsContainer.appendChild(n),this.controlsContainer.appendChild(t),this.overlay.appendChild(this.controlsContainer)}createImage(t,r){this.imageContainer=document.createElement("div"),this.imageContainer.style.cssText=`
      position: relative;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
      max-width: calc(100vw - 80px);
      max-height: calc(100vh - 160px);
    `,this.image=document.createElement("img"),this.image.src=t,this.image.alt=r,this.image.style.cssText=`
      max-width: calc(100vw - 80px);
      max-height: calc(100vh - 160px);
      width: auto;
      height: auto;
      display: block;
      user-select: none;
      pointer-events: none;
      object-fit: contain;
    `,this.imageContainer.appendChild(this.image),this.overlay.appendChild(this.imageContainer),this.bindDragEvents()}bindDragEvents(){this.imageContainer&&(this.dragHandler=t=>{if(!this.state.isDragging)return;const r=t.clientX-this.state.dragStartX,n=t.clientY-this.state.dragStartY;this.state.x=this.state.imageStartX+r,this.state.y=this.state.imageStartY+n,this.pendingUpdate||(this.pendingUpdate=!0,this.animationFrameId=requestAnimationFrame(()=>{this.updateImageTransform(),this.pendingUpdate=!1}))},this.mouseUpHandler=()=>{this.state.isDragging&&(this.state.isDragging=!1,this.imageContainer&&(this.imageContainer.style.cursor="grab"),this.overlay&&(this.overlay.style.cursor="grab"),this.cleanupDragEvents())},this.imageContainer.addEventListener("mousedown",t=>{t.preventDefault(),this.state.isDragging=!0,this.state.dragStartX=t.clientX,this.state.dragStartY=t.clientY,this.state.imageStartX=this.state.x,this.state.imageStartY=this.state.y,this.imageContainer&&(this.imageContainer.style.cursor="grabbing"),this.overlay&&(this.overlay.style.cursor="grabbing"),this.dragHandler&&this.mouseUpHandler&&(document.addEventListener("mousemove",this.dragHandler,{passive:!0}),document.addEventListener("mouseup",this.mouseUpHandler,{once:!0}))}))}cleanupDragEvents(){this.dragHandler&&document.removeEventListener("mousemove",this.dragHandler),this.mouseUpHandler&&document.removeEventListener("mouseup",this.mouseUpHandler)}bindEvents(){this.delegationHandler=t=>{if(this.overlay){if(t.type==="keydown"&&this.options.enableKeyboard){const r=t;switch(r.key){case"Escape":this.close();break;case"+":case"=":r.preventDefault(),this.zoomIn();break;case"-":r.preventDefault(),this.zoomOut();break;case"0":r.preventDefault(),this.resetState();break}}else if(t.type==="wheel"){const r=t;r.preventDefault(),r.deltaY<0?this.zoomIn():this.zoomOut()}}},document.addEventListener("keydown",this.delegationHandler),document.addEventListener("wheel",this.delegationHandler,{passive:!1})}zoomIn(){this.state.zoom=Math.min(this.state.zoom+this.options.zoomStep,this.options.maxZoom),this.updateImageTransform()}zoomOut(){this.state.zoom=Math.max(this.state.zoom-this.options.zoomStep,this.options.minZoom),this.updateImageTransform()}resetState(){this.state.zoom=1,this.state.x=0,this.state.y=0,this.updateImageTransform()}updateImageTransform(){this.imageContainer&&(this.imageContainer.style.transform=`
      translate(${this.state.x}px, ${this.state.y}px) 
      scale(${this.state.zoom})
    `)}addStyles(){this.styleElement||(this.styleElement=document.createElement("style"),this.styleElement.textContent=`
        .image-viewer-control-btn {
          background: rgba(0, 0, 0, 0.8);
          color: white;
          border: none;
          padding: 8px 14px;
          border-radius: 4px;
          cursor: pointer;
          font-size: 18px;
          transition: background 0.2s;
          user-select: none;
        }
        
        .image-viewer-control-btn:hover {
          background: rgba(0, 0, 0, 0.4);
        }
        
        .image-viewer-close-btn {
          position: absolute;
          top: 20px;
          right: 30px;
          color: white;
          font-size: 18px;
          cursor: pointer;
          z-index: 10001;
          user-select: none;
          width: 36px;
          height: 34px;
          display: flex;
          border-radius: 50%;
          justify-content: center;
          background: rgba(0, 0, 0, 0.8);
          transition: all 0.2s ease;
          line-height: 34px;
          padding-bottom:2px;
        }
        
        .image-viewer-close-btn:hover {
          background: rgba(0, 0, 0, 0.4);
        }
      `,document.head.appendChild(this.styleElement))}removeStyles(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)}destroy(){this.close(),this.removeStyles()}}const Ni=e=>{const t=e,{insertFragment:r,drop:n,pointerUp:o}=t,i=new Ri({zoomStep:.3,minZoom:.1,maxZoom:5,enableKeyboard:!0});return t.insertFragment=(a,l,c)=>{var u;if((u=a==null?void 0:a.files)!=null&&u.length&&_r(a.files[0].type)){const d=a.files[0];pt(e,d,l,!1);return}r(a,l,c)},t.drop=a=>{var l,c;if((c=(l=a.dataTransfer)==null?void 0:l.files)!=null&&c.length){const u=a.dataTransfer.files[0];if(_r(u.type)){const d=m.toViewBoxPoint(e,m.toHostPoint(e,a.x,a.y));return pt(e,u,d,!0),!0}}return n(a)},t.pointerUp=a=>{const l=P.getElementOfFocusedImage(e);if(l&&!P.isResizing(e)&&!m.isSelectionMoving(e)&&!m.isDragging(e)){const c=m.toViewBoxPoint(e,m.toHostPoint(e,a.x,a.y)),u=m.getHitElementByPoint(e,c);u&&I.MindElement.isMindElement(e,u)&&I.MindElement.hasImage(u)&&I.isHitImage(e,u,c)&&l===u&&i.open(u.data.image.url)}o(a)},t},An=e=>{const t=e;return t.renderImage=(r,n)=>{const o=Dn.createRoot(r);o.render(s.jsx(Dr,{...n}));let i={...n};return{destroy:()=>{setTimeout(()=>{o.unmount()},0)},update:l=>{i={...i,...l},o.render(s.jsx(Dr,{...i}))}}},Ni(t)},ce=E.forwardRef(({children:e,padding:t,className:r,style:n,...o},i)=>s.jsx("div",{className:D("island",r),style:{"--padding":t,...n},ref:i,...o,children:e})),zi=E.forwardRef(({children:e,gap:t,align:r,justifyContent:n,className:o,style:i},a)=>s.jsx("div",{className:D("stack stack_horizontal",o),style:{"--gap":t,alignItems:r,justifyContent:n,...i},ref:a,children:e})),Hi=E.forwardRef(({children:e,gap:t,align:r,justifyContent:n,className:o,style:i},a)=>s.jsx("div",{className:D("stack stack_vertical",o),style:{"--gap":t,justifyItems:r,justifyContent:n,...i},ref:a,children:e})),oe={Row:zi,Col:Hi};class Ui extends DOMException{constructor(t="Request Aborted"){super(t,"AbortError")}}const In=e=>!!e&&typeof e=="object"&&"then"in e&&"catch"in e&&"finally"in e,Rn=(e,t,{checkForDefaultPrevented:r=!0}={})=>function(o){if(e==null||e(o),!r||!(o!=null&&o.defaultPrevented))return t==null?void 0:t(o)},Nn=e=>{const t=e.split(","),r=t[0].match(/:(.*?);/)[1],n=atob(t[1]);let o=n.length;const i=new Uint8Array(o);for(;o--;)i[o]=n.charCodeAt(o);return new Blob([i],{type:r})},zn=(e,t={})=>m.toImage(e,{fillStyle:"transparent",inlineStyleClassNames:".extend,.emojis,.text",padding:20,ratio:4,...t});function Hn(e,t){const r=document.createElement("a"),n=window.URL.createObjectURL(e);r.href=n,r.download=t,document.body.append(r),r.click(),window.URL.revokeObjectURL(n),r.remove()}const Et=(e,t)=>{const r=[];for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r},Jt=e=>(e=e.replace(/\bAlt\b/i,"Alt").replace(/\bShift\b/i,"Shift").replace(/\b(Enter|Return)\b/i,"Enter"),m.IS_APPLE||m.IS_MAC?e.replace(/\bCtrlOrCmd\b/gi,"Cmd").replace(/\bAlt\b/i,"Option"):e.replace(/\bCtrlOrCmd\b/gi,"Ctrl")),A=E.forwardRef((e,t)=>{const{id:r}={id:"drawnix"},n=E.useRef(null);E.useImperativeHandle(t,()=>n.current);const o=`tool-icon_size_${e.size||"medium"}`,[i,a]=E.useState(!1),l=E.useRef(!0),c=async d=>{var f;const h="onClick"in e&&((f=e.onClick)==null?void 0:f.call(e,d));if(In(h))try{a(!0),await h}catch(g){if(g instanceof Ui)console.warn(g);else throw g}finally{l.current&&a(!1)}};E.useEffect(()=>(l.current=!0,()=>{l.current=!1}),[]);const u=E.useRef(null);if(e.type==="button"||e.type==="icon"||e.type==="submit"){const d=e.type==="icon"?"button":e.type;return s.jsxs("button",{className:D("tool-icon_type_button",o,e.className,e.visible&&!e.hidden?"tool-icon_type_button--show":"tool-icon_type_button--hide",{"tool-icon":!e.hidden,"tool-icon--selected":e.selected}),style:e.style,"data-testid":e["data-testid"],hidden:e.hidden,title:e.title,"aria-label":e["aria-label"],type:d,onClick:c,onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,{pointerType:h.pointerType||null,event:h})},onPointerUp:h=>{var f;(f=e.onPointerUp)==null||f.call(e,{pointerType:h.pointerType||null})},ref:n,disabled:i||!!e.disabled,children:[(e.icon||e.label)&&s.jsxs("div",{className:"tool-icon__icon","aria-hidden":"true","aria-disabled":!!e.disabled,children:[e.icon||e.label,e.keyBindingLabel&&s.jsx("span",{className:"tool-icon__keybinding",children:e.keyBindingLabel})]}),e.showAriaLabel&&s.jsx("div",{className:"tool-icon__label",children:e["aria-label"]}),e.children&&s.jsx("div",{className:"tool-icon__icon",children:e.children})]})}return s.jsxs("label",{className:D("tool-icon",e.className),title:e.title,onPointerDown:d=>{var h;u.current=d.pointerType||null,(h=e.onPointerDown)==null||h.call(e,{pointerType:d.pointerType||null,event:d})},onPointerUp:d=>{var h;(h=e.onPointerUp)==null||h.call(e,{pointerType:d.pointerType||null}),requestAnimationFrame(()=>{u.current=null})},children:[s.jsx("input",{className:`tool-icon_type_radio ${o}`,type:"radio",name:e.name,"aria-label":e["aria-label"],"aria-keyshortcuts":e["aria-keyshortcuts"],"data-testid":e["data-testid"],id:`${r}-${e.id}`,onChange:()=>{var d;(d=e.onChange)==null||d.call(e,{pointerType:u.current})},checked:e.checked,ref:n}),s.jsxs("div",{className:"tool-icon__icon",children:[e.icon,e.keyBindingLabel&&s.jsx("span",{className:"tool-icon__keybinding",children:e.keyBindingLabel})]})]})});A.displayName="ToolButton";const S=e=>e,Wi=S(s.jsx("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"Hand",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M8.44583468,0.500225887 C9.07406934,0.510185679 9.54739531,0.839591366 9.86192311,1.34305279 C9.89696656,1.39914649 9.92878401,1.45492964 9.9576026,1.50991157 L9.9576026,1.50991157 L10.0210033,1.64201027 L10.061978,1.62350755 C10.1972891,1.56834247 10.3444107,1.53218464 10.5027907,1.51755353 L10.5027907,1.51755353 L10.6649031,1.51019133 C11.4883708,1.51019133 12.0208782,1.99343346 12.3023042,2.66393278 C12.3903714,2.87392911 12.4344191,3.10047818 12.4339446,3.3257952 L12.4339446,3.3257952 L12.4360033,3.80501027 L12.5160535,3.78341501 C12.6124478,3.76124046 12.7138812,3.74739854 12.820201,3.74250274 L12.820201,3.74250274 L12.9833264,3.74194533 C13.6121166,3.7657478 14.0645887,4.0801724 14.3087062,4.56112689 C14.4521117,4.8436609 14.4987984,5.11349437 14.4999262,5.33449618 L14.4999262,5.33449618 L14.3922653,12.049414 C14.3784752,12.909177 14.0717787,13.7360948 13.5212406,14.3825228 C13.4055676,14.5183496 13.2843697,14.643961 13.1582361,14.7596335 C12.4634771,15.3967716 11.755103,15.6538706 11.1897396,15.7000055 L11.1897396,15.7000055 L7.4723083,15.6798158 C7.14276373,15.634268 6.81580098,15.5154267 6.49455235,15.3472501 C6.25643701,15.2225944 6.06881706,15.0975452 5.88705731,14.9494308 L5.88705731,14.9494308 L2.55198782,11.500873 C2.39559475,11.3769079 2.17626793,11.1748532 1.9548636,10.9139403 C1.57867502,10.4706225 1.33501976,10.0139923 1.30330257,9.52833025 C1.28093191,9.18578476 1.37200912,8.85641102 1.5826788,8.56872564 C1.82538833,8.23725279 2.12881965,8.02107162 2.47470569,7.92957033 C2.95807982,7.80169771 3.42705723,7.92468989 3.86509644,8.18731167 C4.04431391,8.29475961 4.1816109,8.40304483 4.26225571,8.47866867 L4.26225571,8.47866867 L4.61400328,8.79701027 L4.57247249,3.59275349 L4.57628524,3.46204923 C4.5897691,3.23444442 4.64087578,2.95701848 4.75937106,2.66961597 C5.01017272,2.06131302 5.49670227,1.64692543 6.21363856,1.60818786 C6.44223508,1.59583681 6.65042099,1.62176802 6.83696985,1.68057551 L6.83696985,1.68057551 L6.86400328,1.69001027 C6.88501862,1.63593052 6.90764242,1.58175442 6.9331867,1.52672633 L6.9331867,1.52672633 L7.01883595,1.35955614 C7.31549194,0.832047939 7.79476072,0.48993549 8.44583468,0.500225887 Z M8.42684173,1.70001476 C8.26825412,1.69756905 8.16339456,1.77242008 8.06478367,1.94776814 C8.03967773,1.99241107 8.01831703,2.03811495 8.00083464,2.07855067 L8.00083464,2.07855067 L7.94879157,2.2035905 L7.94354455,2.20731401 L7.943,3.161 L7.97170661,3.16123746 L7.97170661,7.60991883 L6.77170661,7.60991883 L6.771,3.338 L6.74362358,3.33880359 C6.74284189,3.29064626 6.73014163,3.20282206 6.7002616,3.11094408 L6.66446012,3.01903385 C6.58982025,2.85766739 6.49843292,2.79455071 6.27838133,2.80644008 C6.07001018,2.81769881 5.95642108,2.91444507 5.86877664,3.12702089 C5.79792279,3.29887224 5.77228127,3.48655908 5.77246879,3.58977183 L5.77246879,3.58977183 L5.83613619,11.5252021 L3.41863956,9.33477657 L3.31637296,9.25979571 L3.24805011,9.21651224 C3.06096922,9.10434987 2.89279975,9.06024641 2.78159879,9.0896637 C2.71007735,9.10858411 2.63607367,9.1613084 2.55086305,9.27768211 C2.51020424,9.33320478 2.49638061,9.38319687 2.50075171,9.4501283 C2.51206889,9.62341997 2.64503022,9.87260054 2.86983366,10.1375191 C3.03268834,10.3294345 3.19762053,10.4813781 3.35554956,10.6131022 L3.35554956,10.6131022 L6.68454317,14.0569073 C6.71106575,14.0773808 6.74806086,14.1037158 6.79369091,14.1335929 L6.79369091,14.1335929 L6.95464838,14.2315311 L7.05111031,14.2841211 C7.25978123,14.3933622 7.46253523,14.4670573 7.55685495,14.4854708 L7.55685495,14.4854708 L11.1407985,14.5022108 C11.1503576,14.5013899 11.1627905,14.4997539 11.1779002,14.4971772 L11.1779002,14.4971772 L11.2991076,14.4694224 C11.3491682,14.4557375 11.4083624,14.437284 11.4751158,14.4130563 C11.769383,14.3062543 12.066676,14.1324596 12.3471758,13.8752234 C12.4371203,13.7927386 12.5240597,13.7026333 12.607654,13.6044743 C12.9760464,13.1719172 13.183059,12.6137678 13.1924195,12.030173 L13.1924195,12.030173 L13.3000132,5.32832551 C13.2997939,5.29016685 13.2826117,5.19085946 13.2386527,5.10425262 C13.1843838,4.99733326 13.1129774,4.94771265 12.9379578,4.94108739 C12.6814739,4.93138871 12.534132,5.11189595 12.4756792,5.39480062 L12.4768718,7.52734922 L11.2768718,7.52734922 L11.276,5.688 L11.2462883,5.6883208 L11.2339541,3.32771285 C11.2341,3.2560396 11.2209054,3.18817621 11.1957482,3.12818892 C11.0820579,2.85732094 10.9199288,2.71019133 10.6649031,2.71019133 C10.456829,2.71019133 10.3197487,2.87378067 10.2524297,3.11264939 L10.2530225,7.512783 L9.05302254,7.512783 L9.053,3.288 L9.01554331,3.28724203 L8.98800328,2.29901027 L8.9629175,2.22263368 C8.94515567,2.17417174 8.92167756,2.11937748 8.8924232,2.06330056 L8.8924232,2.06330056 L8.84420197,1.9788544 C8.72758855,1.79219249 8.59915015,1.70280728 8.42684173,1.70001476 Z"})})})),qi=S(s.jsx("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"selection",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M1.38232686,2.38218266 L5.4143451,14.2246629 L5.45540179,14.3136477 C5.6738376,14.7029541 6.25143564,14.7273637 6.49230627,14.3232393 L8.11486037,11.5990854 L10.8833927,14.4351257 C11.1162256,14.673686 11.4988798,14.6767204 11.7354668,14.4418826 L14.1933351,12.0021862 L14.263123,11.9192708 C14.4260847,11.6858139 14.4039042,11.3621027 14.1959502,11.1531274 L11.3598604,8.30408543 L14.0003903,6.44278167 C14.4042341,6.15799031 14.3099422,5.5344405 13.8399491,5.38178897 L2.13023795,1.60291226 C1.65322163,1.44797961 1.20794286,1.91192855 1.38232686,2.38218266 Z M2.93689198,3.12556703 L12.3288604,6.15308543 L10.0883903,7.73315528 L10.0121747,7.79676991 C9.78025886,8.02517222 9.77056424,8.40723513 10.0088753,8.64671667 L12.9218604,11.5730854 L11.3198604,13.1630854 L8.42938714,10.2026992 L8.35682877,10.1391916 C8.07802132,9.93187508 7.66955488,10.0042813 7.48460396,10.3145856 L6.10286037,12.6310854 L2.93689198,3.12556703 Z"})})})),Ki=S(s.jsx("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"Mind",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M14.5,1.5 C15.3284271,1.5 16,2.17157288 16,3 L16,4.5 C16,5.32842712 15.3284271,6 14.5,6 L10.5,6 C9.70541385,6 9.05512881,5.38217354 9.00332687,4.60070262 L7.75,4.6 C6.70187486,4.6 5.75693372,5.0417832 5.09122946,5.7492967 L5.5,5.75 C6.32842712,5.75 7,6.42157288 7,7.25 L7,8.75 C7,9.57842712 6.32842712,10.25 5.5,10.25 L4.69703093,10.2512226 C5.3493111,11.2442937 6.47308134,11.9 7.75,11.9 L9.004,11.9 L9.00686658,11.85554 C9.07955132,11.0948881 9.72030388,10.5 10.5,10.5 L14.5,10.5 C15.3284271,10.5 16,11.1715729 16,12 L16,13.5 C16,14.3284271 15.3284271,15 14.5,15 L10.5,15 C9.67157288,15 9,14.3284271 9,13.5 L9,13.1 L7.75,13.1 C5.78479628,13.1 4.09258608,11.9311758 3.33061658,10.2507745 L1.5,10.25 C0.671572875,10.25 0,9.57842712 0,8.75 L0,7.25 C0,6.42157288 0.671572875,5.75 1.5,5.75 L3.5932906,5.74973863 C4.44206161,4.34167555 5.98606075,3.4 7.75,3.4 L9,3.4 L9,3 C9,2.17157288 9.67157288,1.5 10.5,1.5 L14.5,1.5 Z M14.5,11.7 L10.5,11.7 C10.3343146,11.7 10.2,11.8343146 10.2,12 L10.2,13.5 C10.2,13.6656854 10.3343146,13.8 10.5,13.8 L14.5,13.8 C14.6656854,13.8 14.8,13.6656854 14.8,13.5 L14.8,12 C14.8,11.8343146 14.6656854,11.7 14.5,11.7 Z M5.5,6.95 L1.5,6.95 C1.33431458,6.95 1.2,7.08431458 1.2,7.25 L1.2,8.75 C1.2,8.91568542 1.33431458,9.05 1.5,9.05 L5.5,9.05 C5.66568542,9.05 5.8,8.91568542 5.8,8.75 L5.8,7.25 C5.8,7.08431458 5.66568542,6.95 5.5,6.95 Z M14.5,2.7 L10.5,2.7 C10.3343146,2.7 10.2,2.83431458 10.2,3 L10.2,4.5 C10.2,4.66568542 10.3343146,4.8 10.5,4.8 L14.5,4.8 C14.6656854,4.8 14.8,4.66568542 14.8,4.5 L14.8,3 C14.8,2.83431458 14.6656854,2.7 14.5,2.7 Z"})})})),$i=S(s.jsx("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"geometry",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M9.3,6.7 L1.7,6.7 L1.7,14.3 L9.3,14.3 L9.3,6.7 Z M10.5,9.8 C12.8748244,9.8 14.8,7.87482442 14.8,5.5 C14.8,3.12517558 12.8748244,1.2 10.5,1.2 C8.12517558,1.2 6.2,3.12517558 6.2,5.5 L9.5,5.5 C10.0522847,5.5 10.5,5.94771525 10.5,6.5 L10.5,9.8 Z M10.5,14.5 C10.5,15.0522847 10.0522847,15.5 9.5,15.5 L1.5,15.5 C0.94771525,15.5 0.5,15.0522847 0.5,14.5 L0.5,6.5 C0.5,5.94771525 0.94771525,5.5 1.5,5.5 L5,5.5 C5,2.46243388 7.46243388,0 10.5,0 C13.5375661,0 16,2.46243388 16,5.5 C16,8.53756612 13.5375661,11 10.5,11 L10.5,14.5 Z"})})})),Vi=S(s.jsx("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"font",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M4.75,14.5069828 C4.41862915,14.5069828 4.15,14.2383536 4.15,13.9069828 C4.15,13.5756119 4.41862915,13.3069828 4.75,13.3069828 L7.3993606,13.306 L7.3993606,2.7 L2.7113606,2.7 L2.7113606,4.10415313 C2.7113606,4.40238689 2.49377099,4.64979988 2.20868371,4.69630014 L2.1113606,4.70415313 C1.77998975,4.70415313 1.5113606,4.43552397 1.5113606,4.10415313 L1.5113606,2.1 C1.5113606,1.76862915 1.77998975,1.5 2.1113606,1.5 L13.8810378,1.5 C14.2124087,1.5 14.4810378,1.76862915 14.4810378,2.1 L14.4810378,4.10415313 C14.4810378,4.43552397 14.2124087,4.70415313 13.8810378,4.70415313 C13.549667,4.70415313 13.2810378,4.43552397 13.2810378,4.10415313 L13.2810378,2.7 L8.5993606,2.7 L8.5993606,13.306 L11.25,13.3069828 C11.5813708,13.3069828 11.85,13.5756119 11.85,13.9069828 C11.85,14.2383536 11.5813708,14.5069828 11.25,14.5069828 L4.75,14.5069828 Z"})})})),Gi=S(s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{stroke:"none",d:"M0 0h24v24H0z"}),s.jsx("path",{d:"M19 20h-10.5l-4.21 -4.3a1 1 0 0 1 0 -1.41l10 -10a1 1 0 0 1 1.41 0l5 5a1 1 0 0 1 0 1.41l-9.2 9.3"}),s.jsx("path",{d:"M18 13.3l-6.3 -6.3"})]})),Zi=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{id:"straight-line",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M8.55595221,-1.5261864 C8.88741773,-1.5261864 9.15621426,-1.25765205 9.15653772,-0.926186684 L9.16739175,10.3828136 L10.9946787,10.3836977 C11.2708211,10.3836977 11.4946787,10.6075553 11.4946787,10.8836977 C11.4946787,10.9607525 11.4768694,11.0367648 11.4426413,11.1058002 L8.8378495,16.3594519 C8.7642512,16.5078936 8.58425218,16.5685662 8.43581043,16.4949679 C8.37895485,16.4667786 8.33250284,16.4212859 8.30313336,16.3650308 L5.56226325,11.1150985 C5.43446412,10.8703088 5.52930372,10.5682659 5.77409341,10.4404667 C5.84552557,10.4031736 5.92491301,10.3836977 6.0054942,10.3836977 L7.96739175,10.3828136 L7.95653772,-0.926186684 C7.95621467,-1.25723416 8.22431979,-1.52586306 8.55536727,-1.52618611 Z",id:"",transform:"translate(8.500035, 7.500035) rotate(-135.000000) translate(-8.500035, -7.500035) "})})})),Yi=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:s.jsx("path",{d:"M3 3h18v18H3z",stroke:"currentColor",strokeWidth:"2",fill:"none"})})),Xi=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:s.jsx("g",{id:"terminal",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M11,3 C13.7614237,3 16,5.23857625 16,8 C16,10.7614237 13.7614237,13 11,13 L5,13 C2.23857625,13 0,10.7614237 0,8 C0,5.23857625 2.23857625,3 5,3 L11,3 Z M11,4.2 L5,4.2 C2.90131795,4.2 1.2,5.90131795 1.2,8 C1.2,10.0330982 2.79664702,11.6932796 4.8044525,11.7950555 L5,11.8 L11,11.8 C13.098682,11.8 14.8,10.098682 14.8,8 C14.8,5.96690176 13.203353,4.30672042 11.1955475,4.20494454 L11,4.2 Z"})})})),Ji=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{id:"ellipse",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M8,1 C11.8659932,1 15,4.13400675 15,8 C15,11.8659932 11.8659932,15 8,15 C4.13400675,15 1,11.8659932 1,8 C1,4.13400675 4.13400675,1 8,1 Z M8,2.2 C4.79674845,2.2 2.2,4.79674845 2.2,8 C2.2,11.2032515 4.79674845,13.8 8,13.8 C11.2032515,13.8 13.8,11.2032515 13.8,8 C13.8,4.79674845 11.2032515,2.2 8,2.2 Z"})})})),Qi=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{id:"triangle",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M8.23125547,1.21366135 C8.3114266,1.25857939 8.37766784,1.32472334 8.42270367,1.40482837 L15.6471754,14.2549655 C15.7825042,14.4956743 15.6970768,14.800513 15.456368,14.9358418 C15.3815505,14.977905 15.2971646,15 15.2113335,15 L0.787227066,15 C0.511084691,15 0.287227066,14.7761424 0.287227066,14.5 C0.287227066,14.414418 0.309194147,14.3302684 0.351025556,14.2556064 L7.55066033,1.40546924 C7.6856352,1.1645618 7.99034802,1.07868648 8.23125547,1.21366135 Z M7.98695902,3.07926294 L1.98095902,13.7992629 L14.014959,13.7992629 L7.98695902,3.07926294 Z"})})})),es=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M13.7636471,2.6449804 C13.7716713,2.69552516 13.7718878,2.74700226 13.7642892,2.79761274 L12.3875778,11.9671885 C12.3550099,12.1841069 12.184864,12.3544698 11.9679874,12.3873141 L2.78433018,13.7781116 C2.511301,13.8194599 2.25644773,13.6316454 2.21509947,13.3586162 C2.20737253,13.307594 2.20759072,13.2556831 2.21574631,13.2047277 L3.67471119,4.08923146 C3.70888725,3.87570215 3.87646006,3.70834166 4.09003253,3.67443635 L13.1914362,2.22955927 C13.4641633,2.18626298 13.7203508,2.37225335 13.7636471,2.6449804 Z M12.4355704,3.5645263 L4.77957044,4.7795263 L3.55157044,12.4485263 L11.2775704,11.2775263 L12.4355704,3.5645263 Z",transform:"translate(7.989647, 8.003560) rotate(-315.000000) translate(-7.989647, -8.003560) "})})})),ts=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M15.3062871,3.5 C15.5824294,3.5 15.8062871,3.72385763 15.8062871,4 C15.8062871,4.05374105 15.7976231,4.10713065 15.7806287,4.15811388 L13.113962,12.1581139 C13.045905,12.362285 12.8548356,12.5 12.6396204,12.5 L0.693712943,12.5 C0.417570568,12.5 0.193712943,12.2761424 0.193712943,12 C0.193712943,11.946259 0.202376883,11.8928694 0.219371294,11.8418861 L2.88603796,3.84188612 C2.95409498,3.63771505 3.14516441,3.5 3.36037961,3.5 L15.3062871,3.5 Z M14.335,4.7 L3.864,4.7 L1.664,11.3 L12.134,11.3 L14.335,4.7 Z"})})})),rs=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M11,3 C13.7614237,3 16,5.23857625 16,8 C16,10.7614237 13.7614237,13 11,13 L5,13 C2.23857625,13 0,10.7614237 0,8 C0,5.23857625 2.23857625,3 5,3 L11,3 Z M11,4.2 L5,4.2 C2.90131795,4.2 1.2,5.90131795 1.2,8 C1.2,10.0330982 2.79664702,11.6932796 4.8044525,11.7950555 L5,11.8 L11,11.8 C13.098682,11.8 14.8,10.098682 14.8,8 C14.8,5.96690176 13.203353,4.30672042 11.1955475,4.20494454 L11,4.2 Z"})})})),ns=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M8.55595221,-1.5261864 C8.88741773,-1.5261864 9.15621426,-1.25765205 9.15653772,-0.926186684 L9.16739175,10.3828136 L10.9946787,10.3836977 C11.2708211,10.3836977 11.4946787,10.6075553 11.4946787,10.8836977 C11.4946787,10.9607525 11.4768694,11.0367648 11.4426413,11.1058002 L8.8378495,16.3594519 C8.7642512,16.5078936 8.58425218,16.5685662 8.43581043,16.4949679 C8.37895485,16.4667786 8.33250284,16.4212859 8.30313336,16.3650308 L5.56226325,11.1150985 C5.43446412,10.8703088 5.52930372,10.5682659 5.77409341,10.4404667 C5.84552557,10.4031736 5.92491301,10.3836977 6.0054942,10.3836977 L7.96739175,10.3828136 L7.95653772,-0.926186684 C7.95621467,-1.25723416 8.22431979,-1.52586306 8.55536727,-1.52618611 Z",transform:"translate(8.500035, 7.500035) rotate(-135.000000) translate(-8.500035, -7.500035) "})})})),os=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M10.0153197,2.75391207 C10.0923746,2.75391207 10.1683869,2.77172133 10.2374222,2.80594949 L15.4910739,5.41074126 C15.6395156,5.48433956 15.7001882,5.66433859 15.6265899,5.81278033 C15.5984006,5.86963592 15.5529079,5.91608792 15.4966529,5.9454574 L10.2467205,8.68632752 C10.0019308,8.81412664 9.69988791,8.71928704 9.57208878,8.47449735 C9.53479568,8.40306519 9.51531974,8.32367776 9.51531974,8.24309656 L9.51458753,6.62591207 L6.16858753,6.62651279 L6.16914066,12.0061269 C6.16914066,12.3043606 5.95155104,12.5517736 5.66646377,12.5982739 L5.56914066,12.6061269 L0.534587532,12.6061269 C0.203216682,12.6061269 -0.0654124678,12.3374977 -0.0654124678,12.0061269 C-0.0654124678,11.674756 0.203216682,11.4061269 0.534587532,11.4061269 L4.96858753,11.4055128 L4.96914066,6.02651279 C4.96914066,5.72827903 5.18673027,5.48086604 5.47181754,5.43436578 L5.56914066,5.42651279 L9.51458753,5.42591207 L9.51531974,3.25391207 C9.51531974,2.9777697 9.73917736,2.75391207 10.0153197,2.75391207 Z"})})})),is=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M10.0153197,2.75391207 C10.0923746,2.75391207 10.1683869,2.77172133 10.2374222,2.80594949 L15.4910739,5.41074126 C15.6395156,5.48433956 15.7001882,5.66433859 15.6265899,5.81278033 C15.5984006,5.86963592 15.5529079,5.91608792 15.4966529,5.9454574 L10.2467205,8.68632752 C10.0019308,8.81412664 9.69988791,8.71928704 9.57208878,8.47449735 C9.53479568,8.40306519 9.51531974,8.32367776 9.51531974,8.24309656 L9.51423005,6.39035523 C5.97984781,6.85936966 3.21691607,9.08498364 1.18879108,13.1285821 C1.04022695,13.4247836 0.679673152,13.5444674 0.383471635,13.3959033 C0.0872701176,13.2473391 -0.0324136308,12.8867853 0.116150501,12.5905838 C2.34388813,8.14900524 5.48945543,5.65776043 9.51468497,5.18078677 L9.51531974,3.25391207 C9.51531974,2.9777697 9.73917736,2.75391207 10.0153197,2.75391207 Z"})})})),Un=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsxs("g",{strokeWidth:"1.5",children:[s.jsx("path",{stroke:"none",d:"M0 0h24v24H0z"}),s.jsx("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),s.jsx("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),s.jsx("line",{x1:"4",y1:"18",x2:"20",y2:"18"})]})})),ss=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:s.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",d:"M7.5 15.833c-3.583 1.167-3.583-2.083-5-2.5m10 4.167v-2.917c0-.833.083-1.166-.417-1.666 2.334-.25 4.584-1.167 4.584-5a3.833 3.833 0 0 0-1.084-2.667 3.5 3.5 0 0 0-.083-2.667s-.917-.25-2.917 1.084a10.25 10.25 0 0 0-5.166 0C5.417 2.333 4.5 2.583 4.5 2.583a3.5 3.5 0 0 0-.083 2.667 3.833 3.833 0 0 0-1.084 2.667c0 3.833 2.25 4.75 4.584 5-.5.5-.5 1-.417 1.666V17.5",strokeWidth:"1.25"})})),as=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:s.jsxs("g",{strokeWidth:"1.25",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",children:[s.jsx("path",{stroke:"none",d:"M0 0h24v24H0z"}),s.jsx("path",{d:"M15 8h.01"}),s.jsx("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),s.jsx("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),s.jsx("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),s.jsx("path",{d:"M19 16v6"}),s.jsx("path",{d:"M22 19l-3 3l-3 -3"})]})})),ls=S(s.jsx("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"zoom-out",stroke:"none",fill:"currentColor",strokeWidth:"1",children:s.jsx("path",{fillRule:"nonzero",d:"M6.85,2.73225886e-13 C10.6331505,2.73225886e-13 13.7,3.06684946 13.7,6.85 C13.7,8.54194045 13.0865836,10.0906098 12.0700142,11.2857448 L15.4201976,14.5717081 C15.6567367,14.8037768 15.6603607,15.1836585 15.4282919,15.4201976 C15.1962232,15.6567367 14.8163415,15.6603607 14.5798024,15.4282919 L14.5798024,15.4282919 L11.2163456,12.128262 C10.0309427,13.1099691 8.50937591,13.7 6.85,13.7 C3.06684946,13.7 4.58522109e-14,10.6331505 4.58522109e-14,6.85 C4.58522109e-14,3.06684946 3.06684946,2.73225886e-13 6.85,2.73225886e-13 Z M6.85,1.2 C3.72959116,1.2 1.2,3.72959116 1.2,6.85 C1.2,9.97040884 3.72959116,12.5 6.85,12.5 C8.31753357,12.5 9.65438791,11.9404957 10.6588859,11.0231643 C10.6855412,10.9625408 10.7245275,10.9050898 10.7743982,10.8542584 C10.8288931,10.7987137 10.8915387,10.7560124 10.9585649,10.7261903 C11.9144009,9.71595758 12.5,8.35136579 12.5,6.85 C12.5,3.72959116 9.97040884,1.2 6.85,1.2 Z M4.6,6.2 L9.12944565,6.2 C9.4608165,6.2 9.72944565,6.46862915 9.72944565,6.8 C9.72944565,7.09823376 9.51185604,7.34564675 9.22676876,7.39214701 L9.12944565,7.4 L4.6,7.4 C4.26862915,7.4 4,7.13137085 4,6.8 C4,6.50176624 4.21758961,6.25435325 4.50267688,6.20785299 L4.6,6.2 L9.12944565,6.2 Z"})})})),cs=S(s.jsx("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"zoom-in",stroke:"none",fill:"currentColor",strokeWidth:"1",children:s.jsx("path",{fillRule:"nonzero",d:"M6.85,-1.81188398e-13 C10.6331505,-1.81188398e-13 13.7,3.06684946 13.7,6.85 C13.7,8.54194045 13.0865836,10.0906098 12.0700142,11.2857448 L15.4201976,14.5717081 C15.6567367,14.8037768 15.6603607,15.1836585 15.4282919,15.4201976 C15.1962232,15.6567367 14.8163415,15.6603607 14.5798024,15.4282919 L14.5798024,15.4282919 L11.2163456,12.128262 C10.0309427,13.1099691 8.50937591,13.7 6.85,13.7 C3.06684946,13.7 4.61852778e-14,10.6331505 4.61852778e-14,6.85 C4.61852778e-14,3.06684946 3.06684946,-1.81188398e-13 6.85,-1.81188398e-13 Z M6.85,1.2 C3.72959116,1.2 1.2,3.72959116 1.2,6.85 C1.2,9.97040884 3.72959116,12.5 6.85,12.5 C8.31753357,12.5 9.65438791,11.9404957 10.6588859,11.0231643 C10.6855412,10.9625408 10.7245275,10.9050898 10.7743982,10.8542584 C10.8288931,10.7987137 10.8915387,10.7560124 10.9585649,10.7261903 C11.9144009,9.71595758 12.5,8.35136579 12.5,6.85 C12.5,3.72959116 9.97040884,1.2 6.85,1.2 Z M6.86472282,3.93527718 C7.16295659,3.93527718 7.41036958,4.15286679 7.45686984,4.43795406 L7.46472282,4.53527718 L7.464,6.19927718 L9.12944565,6.2 C9.42767941,6.2 9.6750924,6.41758961 9.72159266,6.70267688 L9.72944565,6.8 C9.72944565,7.09823376 9.51185604,7.34564675 9.22676876,7.39214701 L9.12944565,7.4 L7.464,7.39927718 L7.46472282,9.06472282 C7.46472282,9.36295659 7.24713321,9.61036958 6.96204594,9.65686984 L6.86472282,9.66472282 C6.56648906,9.66472282 6.31907607,9.44713321 6.27257581,9.16204594 L6.26472282,9.06472282 L6.264,7.39927718 L4.6,7.4 C4.30176624,7.4 4.05435325,7.18241039 4.00785299,6.89732312 L4,6.8 C4,6.50176624 4.21758961,6.25435325 4.50267688,6.20785299 L4.6,6.2 L6.264,6.19927718 L6.26472282,4.53527718 C6.26472282,4.2701805 6.43664548,4.0452385 6.67507642,3.96586557 L6.76739971,3.94313016 L6.86472282,3.93527718 Z"})})})),us=S(s.jsx("svg",{viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"save-file",stroke:"none",fill:"currentColor",children:s.jsx("path",{fillRule:"nonzero",d:"M11.064 9.1l2.645 2.595.03-.029.848.849-3.523 3.323-.848-.848 1.994-1.883H7.5v-1.2h4.712l-1.996-1.958.848-.849zM9.356.3L13.7 3.71V7.9h-1.2l-.001-2.633H8.5V1.5L3.1 1.5a.4.4 0 0 0-.392.32L2.7 1.9v12a.4.4 0 0 0 .32.392l.08.008h3.418v1.2H3.1a1.6 1.6 0 0 1-1.593-1.454L1.5 13.9v-12A1.6 1.6 0 0 1 2.954.307L3.1.3h6.256zM9.7 2.095v1.973l2.51-.001L9.7 2.095z"})})})),ds=S(s.jsx("svg",{viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"save-file",stroke:"currentColor",fill:"none",children:s.jsx("path",{d:"m9.257 6.351.183.183H15.819c.34 0 .727.182 1.051.506.323.323.505.708.505 1.05v5.819c0 .316-.183.7-.52 1.035-.337.338-.723.522-1.037.522H4.182c-.352 0-.74-.181-1.058-.5-.318-.318-.499-.705-.499-1.057V5.182c0-.351.181-.736.5-1.054.32-.321.71-.503 1.057-.503H6.53l2.726 2.726Z",strokeWidth:"1.25"})})})),fs=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"background-color-icon",children:s.jsxs("g",{transform:"translate(1 1)",fillRule:"evenodd",fill:"#000",stroke:"none",children:[s.jsx("circle",{fillOpacity:".04",r:"11",cy:"11",cx:"11"}),s.jsx("path",{d:"M17 20.221V17h3.221A11.06 11.06 0 0 1 17 20.221zm-12 0A11.06 11.06 0 0 1 1.779 17H5v3.221zM20.221 5H17V1.779A11.06 11.06 0 0 1 20.221 5zM9 .181V1H6.411A10.919 10.919 0 0 1 9 .181zM15.589 1H13V.181c.907.167 1.775.445 2.589.819zM13 21.819V21h2.589c-.814.374-1.682.652-2.589.819zm-4 0A10.919 10.919 0 0 1 6.411 21H9v.819zm-8-6.23A10.919 10.919 0 0 1 .181 13H1v2.589zm0-9.178V9H.181C.348 8.093.626 7.225 1 6.411zM21.819 9H21V6.411c.374.814.652 1.682.819 2.589zM21 15.589V13h.819A10.919 10.919 0 0 1 21 15.589zM5 1.779V5H1.779A11.06 11.06 0 0 1 5 1.779zM5 13h4v4H5v-4zm8 0h4v4h-4v-4zM5 5h4v4H5V5zm8 0h4v4h-4V5zm0 12v4H9v-4h4zm8-8v4h-4V9h4zm-8 0v4H9V9h4zM5 9v4H1V9h4zm8-8v4H9V1h4z",fillOpacity:".12"})]})})),hs=S(s.jsx("svg",{viewBox:"0 0 32 32",className:"no-color-icon",children:s.jsxs("g",{xmlns:"http://www.w3.org/2000/svg",fillRule:"nonzero",fill:"currentColor",stroke:"none",children:[s.jsx("path",{d:"M2 16c0 7.733 6.267 14 14 14s14-6.267 14-14S23.733 2 16 2 2 8.267 2 16zm-1 0C1 7.716 7.714 1 16 1c8.284 0 15 6.714 15 15 0 8.284-6.714 15-15 15-8.284 0-15-6.714-15-15z"}),s.jsx("path",{d:"M6.354 26.354l-.708-.708 20-20 .708.708z"})]})})),ms=S(s.jsx("svg",{className:"selected-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("polyline",{points:"20 6 9 17 4 12"})})),gs=S(s.jsx("svg",{viewBox:"0 0 24 24",className:"stroke-icon",children:s.jsxs("g",{xmlns:"http://www.w3.org/2000/svg",stroke:"none",fillRule:"evenodd",fill:"#000",children:[s.jsx("path",{d:"M12 5a7 7 0 1 0 0 14 7 7 0 0 0 0-14zm0-4c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1z",fillRule:"nonzero",fillOpacity:".04"}),s.jsx("path",{d:"M12 5V1c1.491 0 2.914.297 4.21.835L14.68 5.53A6.979 6.979 0 0 0 12 5zm4.95 2.048l2.828-2.828a11.016 11.016 0 0 1 2.388 3.568l-3.697 1.53a7.01 7.01 0 0 0-1.519-2.27zM19 12h4c0 1.491-.297 2.914-.835 4.21l-3.696-1.53c.342-.826.531-1.73.531-2.68zm-2.05 4.95l2.828 2.828a11.016 11.016 0 0 1-3.567 2.387l-1.532-3.696a7.01 7.01 0 0 0 2.27-1.52zM12 19v4c-1.491 0-2.914-.297-4.21-.835l1.53-3.696c.826.342 1.73.531 2.68.531zm-4.95-2.05l-2.828 2.828a11.016 11.016 0 0 1-2.387-3.567l3.696-1.532a7.01 7.01 0 0 0 1.52 2.27zM5 12H1c0-1.491.297-2.914.835-4.21L5.53 9.32A6.979 6.979 0 0 0 5 12zm2.05-4.95L4.222 4.222a11.016 11.016 0 0 1 3.567-2.387L9.321 5.53a7.01 7.01 0 0 0-2.27 1.52z",fillOpacity:".12"})]})})),ps=S(s.jsx("svg",{viewBox:"0 0 24 24",children:s.jsx("g",{xmlns:"http://www.w3.org/2000/svg",id:"icon-border-white",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",opacity:"0.1",children:s.jsxs("g",{id:"Group",children:[s.jsx("path",{d:"M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 Z",fill:"#000000",fillRule:"nonzero"}),s.jsx("path",{d:"M12,19 C15.8659932,19 19,15.8659932 19,12 C19,8.13400675 15.8659932,5 12,5 C8.13400675,5 5,8.13400675 5,12 C5,15.8659932 8.13400675,19 12,19 Z M12,20 C7.581722,20 4,16.418278 4,12 C4,7.581722 7.581722,4 12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 Z",fill:"#000000",fillRule:"nonzero"})]})})})),vs=S(s.jsx("svg",{viewBox:"0 0 24 32",xmlns:"http://www.w3.org/2000/svg",children:s.jsxs("g",{transform:"translate(0 14)",fillRule:"evenodd",fill:"none",children:[s.jsx("path",{d:"M-18-19h60v40h-60z"}),s.jsx("path",{d:"M0 0h24v2H0z",fill:"currentColor"})]})})),ws=S(s.jsx("svg",{viewBox:"0 0 24 32",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{transform:"translate(0 14)",fillRule:"evenodd",fill:"none",children:s.jsx("g",{fill:"currentColor",children:s.jsx("path",{d:"M0 0h6v2H0zM9 0h6v2H9zM18 0h6v2h-6z"})})})})),ys=S(s.jsx("svg",{viewBox:"0 0 24 32",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{transform:"translate(0 14)",fillRule:"evenodd",fill:"none",children:s.jsxs("g",{fill:"currentColor",children:[s.jsx("rect",{rx:"1",height:"2",width:"2"}),s.jsx("rect",{rx:"1",x:"4",height:"2",width:"2"}),s.jsx("rect",{rx:"1",x:"8",height:"2",width:"2"}),s.jsx("rect",{rx:"1",x:"12",height:"2",width:"2"}),s.jsx("rect",{rx:"1",x:"16",height:"2",width:"2"}),s.jsx("rect",{rx:"1",x:"20",height:"2",width:"2"})]})})})),xs=({currentColor:e})=>s.jsx("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",className:"font-color-icon",children:s.jsxs("g",{id:"font-color",strokeWidth:"1",fillRule:"evenodd",stroke:"none",fill:"currentColor",children:[s.jsx("path",{id:"secondary-color",d:"M1.999 15.011h11.998V13.81H1.999z",fill:e||"#333333"}),s.jsx("path",{d:"M6.034 7.59h4.104L8.086 2.297 6.034 7.59zm-.465 1.2l-1.437 3.707H2.845L7.301 1h1.287l-.001.004h.286l4.454 11.492h-1.288L10.603 8.79H5.569z",id:"A"})]})}),Cs=S(s.jsx("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("g",{id:"undo-cion",transform:"translate(1 1)",children:s.jsx("path",{d:"M3.84 5.825a.6.6 0 0 1 .063.774l-.064.075a.6.6 0 0 1-.774.063l-.074-.063L.176 3.859a.6.6 0 0 1-.064-.775l.064-.074L3.01.176a.6.6 0 0 1 .912.774l-.063.074-1.795 1.794h6.851a5.1 5.1 0 0 1 .216 10.196l-.216.004h-4a.6.6 0 0 1-.097-1.192l.097-.008h4a3.9 3.9 0 0 0 .201-7.795l-.2-.005H2.033l1.805 1.807z",id:"undo-icon-path"})})})})),bs=S(s.jsx("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("g",{id:"redo-cion",transform:"matrix(-1 0 0 1 15.015 1)",children:s.jsx("path",{d:"M3.84 5.825a.6.6 0 0 1 .063.774l-.064.075a.6.6 0 0 1-.774.063l-.074-.063L.176 3.859a.6.6 0 0 1-.064-.775l.064-.074L3.01.176a.6.6 0 0 1 .912.774l-.063.074-1.795 1.794h6.851a5.1 5.1 0 0 1 .216 10.196l-.216.004h-4a.6.6 0 0 1-.097-1.192l.097-.008h4a3.9 3.9 0 0 0 .201-7.795l-.2-.005H2.033l1.805 1.807z",id:"redo-icon-path"})})})})),vt=S(s.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",children:s.jsx("path",{strokeWidth:"1.25",d:"M3.333 5.833h13.334M8.333 9.167v5M11.667 9.167v5M4.167 5.833l.833 10c0 .92.746 1.667 1.667 1.667h6.666c.92 0 1.667-.746 1.667-1.667l.833-10M7.5 5.833v-2.5c0-.46.373-.833.833-.833h3.334c.46 0 .833.373.833.833v2.5"})})),Es=S(s.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:s.jsxs("g",{strokeWidth:"1.25",children:[s.jsx("path",{d:"M14.375 6.458H8.958a2.5 2.5 0 0 0-2.5 2.5v5.417a2.5 2.5 0 0 0 2.5 2.5h5.417a2.5 2.5 0 0 0 2.5-2.5V8.958a2.5 2.5 0 0 0-2.5-2.5Z"}),s.jsx("path",{d:"M11.667 3.125c.517 0 .986.21 1.325.55.34.338.55.807.55 1.325v1.458H8.333c-.485 0-.927.185-1.26.487-.343.312-.57.75-.609 1.24l-.005 5.357H5a1.87 1.87 0 0 1-1.326-.55 1.87 1.87 0 0 1-.549-1.325V5c0-.518.21-.987.55-1.326.338-.34.807-.549 1.325-.549h6.667Z"})]})})),fr=S(s.jsx("svg",{viewBox:"0 0 1024 1024",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{d:"M170.794667 896c3.456 0 6.912-0.426667 10.325333-1.28l170.666667-42.666667c7.509333-1.877333 14.378667-5.76 19.84-11.221333L896.128 316.330667c16.128-16.128 25.002667-37.546667 25.002667-60.330667s-8.874667-44.202667-25.002667-60.330667L828.458667 128c-32.256-32.256-88.405333-32.256-120.661334 0L183.296 652.501333a42.794667 42.794667 0 0 0-11.221333 19.797334l-42.666667 170.666666A42.666667 42.666667 0 0 0 170.794667 896z m597.333333-707.669333L835.797333 256l-67.669333 67.669333L700.458667 256l67.669333-67.669333zM251.989333 704.469333l388.138667-388.138666L707.797333 384l-388.181333 388.138667-90.197333 22.528 22.570666-90.197334z"})})),js=S(s.jsx("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("g",{id:"image",stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M10.496 7c-.824 0-1.572-.675-1.498-1.5 0-.825.674-1.5 1.498-1.5.823 0 1.497.675 1.497 1.5S11.319 7 10.496 7zM13.8 9.476V2.2H2.2v5.432l.1-.078C3.132 6.904 4.029 6.5 5 6.5c.823 0 1.552.27 2.342.778.226.145.449.304.735.518.06.045.546.413.69.52 1.634 1.21 2.833 1.6 4.798 1.207l.235-.047zm0 1.523V10.7c-5 1-6.3-3-8.8-3-1.5 0-2.8 1.6-2.8 1.6v4.6h11.6V11zM14 1c.6 0 1 .536 1 1.071v11.784c0 .642-.4 1.071-1 1.071H2c-.6 0-1-.429-1-1.07V2.07c0-.535.4-1.07 1-1.07h12z"})})})),Wn=S(s.jsx("svg",{stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:s.jsxs("g",{strokeWidth:1.8,fill:"none",children:[s.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),s.jsx("path",{d:"M12 3l-4 7h8z"}),s.jsx("path",{d:"M17 17m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"}),s.jsx("path",{d:"M4 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"})]})})),ks=S(s.jsx("svg",{stroke:"currentColor",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",children:s.jsx("path",{stroke:"none",fill:"currentColor",d:"M407.48,111.18C335.587,108.103 269.573,152.338 245.08,220C220.587,152.338 154.573,108.103 82.68,111.18C80.285,168.229 107.577,222.632 154.74,254.82C178.908,271.419 193.35,298.951 193.27,328.27L193.27,379.13L296.9,379.13L296.9,328.27C296.816,298.953 311.255,271.42 335.42,254.82C382.596,222.644 409.892,168.233 407.48,111.18Z"})})),Ps=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",version:"1.1",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M14.85,2.5 C15.4851275,2.5 16,3.01487254 16,3.65 L16,12.35 C16,12.9851275 15.4851275,13.5 14.85,13.5 L1.15,13.5 C0.514872538,13.5 0,12.9851275 0,12.35 L0,3.65 C0,3.01487254 0.514872538,2.5 1.15,2.5 L14.85,2.5 Z M14.85,3.7 L1.15,3.7 C1.17735931,3.7 1.2,3.72264069 1.2,3.75 L1.2,12.25 C1.2,12.2773593 1.17735931,12.3 1.15,12.3 L14.85,12.3 C14.8226407,12.3 14.8,12.2773593 14.8,12.25 L14.8,3.75 C14.8,3.72264069 14.8226407,3.7 14.85,3.7 Z M3.5,10.5 L3.5,5.5 L5.25,5.5 L7,7.8 L8.75,5.5 L10.5,5.5 L10.5,10.5 L8.75,10.5 L8.75,7.5 L7,9.8 L5.25,7.5 L5.25,10.5 L3.5,10.5 Z M12.5,10.5 L11,8.5 L12.5,8.5 L12.5,5.5 L11,5.5 L12.5,5.5 L12.5,8.5 L14,8.5 L12.5,10.5 Z"})})})),Ss=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:s.jsx("g",{stroke:"none",fill:"currentColor",children:s.jsx("path",{d:"M12.253 4.13h-1.2v-1a2.8 2.8 0 0 0-5.6 0v4a2.8 2.8 0 0 0 2.8 2.8v1.2a4 4 0 0 1-4-4v-4a4 4 0 0 1 8 0v1zm-8 8h1.2v1a2.8 2.8 0 0 0 5.6 0v-4a2.8 2.8 0 0 0-2.8-2.8v-1.2a4 4 0 0 1 4 4v4a4 4 0 0 1-8 0v-1z",transform:"rotate(46 8.253 8.13)"})})})),qn=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:s.jsx("g",{stroke:"none",children:s.jsx("path",{d:"M8.44521878,4.21103025 C8.58299906,3.97171622 8.8886944,3.88940684 9.12800843,4.02718711 L15.242109,7.54725833 C15.3194119,7.59176394 15.3834015,7.65613893 15.4274422,7.73370766 C15.5637831,7.97384463 15.4796398,8.27904026 15.2395028,8.41538118 L9.12748155,11.8855614 C9.0176214,11.947936 8.88822223,11.9664118 8.76529593,11.9372749 C8.4965984,11.8735862 8.33040588,11.604134 8.39409456,11.3354364 L9.018,8.69941945 L1.5,8.7 C1.22385763,8.7 1,8.47614237 1,8.2 L1,8 C1,7.72385763 1.22385763,7.5 1.5,7.5 L9.075,7.49941945 L8.39165922,4.57430951 C8.3700078,4.48168206 8.37536432,4.38547957 8.40609313,4.29679626 Z"})})})),Kn=S(s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:s.jsx("g",{stroke:"none",children:s.jsx("rect",{x:"1",y:"7.5",width:"14",height:"1.2",rx:".5"})})})),$n={[m.ThemeColorMode.default]:{strokeColor:m.DEFAULT_COLOR,fill:"#FFFFFF"},[m.ThemeColorMode.colorful]:{strokeColor:"#06ADBF",fill:"#CDEFF2"},[m.ThemeColorMode.soft]:{strokeColor:"#6D89C1",fill:"#DADFEB"},[m.ThemeColorMode.retro]:{strokeColor:"#E9C358",fill:"#F6EDCF"},[m.ThemeColorMode.dark]:{strokeColor:"#FFFFFF",fill:"#434343"},[m.ThemeColorMode.starry]:{strokeColor:"#42ABE5",fill:"#163F5A"}};var de=(e=>(e.eraser="eraser",e.nibPen="nibPen",e.feltTipPen="feltTipPen",e.artisticBrush="artisticBrush",e.markerHighlight="markerHighlight",e))(de||{});const Vn="freehand",ge={isFreehand:e=>e.type===Vn},Ls={zh:{"toolbar.hand":"手形工具 — H","toolbar.selection":"选择 — V","toolbar.mind":"思维导图 — M","toolbar.text":"文本 — T","toolbar.pen":"画笔 — P","toolbar.eraser":"橡皮擦 — E","toolbar.arrow":"箭头 — A","toolbar.shape":"形状","toolbar.image":"图片 — Cmd+U","toolbar.extraTools":"更多工具","zoom.in":"放大 — Cmd++","zoom.out":"缩小 — Cmd+-","zoom.fit":"自适应","zoom.100":"缩放至 100%","theme.default":"默认","theme.colorful":"缤纷","theme.soft":"柔和","theme.retro":"复古","theme.dark":"暗夜","theme.starry":"星空","general.undo":"撤销","general.redo":"重做","general.menu":"应用菜单","general.duplicate":"复制","general.delete":"删除","language.switcher":"语言","language.chinese":"中文","language.english":"English","menu.open":"打开","menu.saveFile":"保存文件","menu.exportImage":"导出图片","menu.exportImage.png":"PNG","menu.exportImage.jpg":"JPG","menu.cleanBoard":"清除画布","menu.github":"GitHub","dialog.mermaid.title":"Mermaid 转 Drawnix","dialog.mermaid.description":"目前仅支持","dialog.mermaid.flowchart":"流程图","dialog.mermaid.sequence":"序列图","dialog.mermaid.class":"类图","dialog.mermaid.otherTypes":"。其他类型在 Drawnix 中将以图片呈现。","dialog.mermaid.syntax":"Mermaid 语法","dialog.mermaid.placeholder":"在此处编写 Mermaid 图表定义...","dialog.mermaid.preview":"预览","dialog.mermaid.insert":"插入","dialog.markdown.description":"支持 Markdown 语法自动转换为思维导图。","dialog.markdown.syntax":"Markdown 语法","dialog.markdown.placeholder":"在此处编写 Markdown 文本定义...","dialog.markdown.preview":"预览","dialog.markdown.insert":"插入","dialog.error.loadMermaid":"加载 Mermaid 库失败","extraTools.mermaidToDrawnix":"Mermaid 到 Drawnix","extraTools.markdownToDrawnix":"Markdown 到 Drawnix","cleanConfirm.title":"清除画布","cleanConfirm.description":"这将会清除整个画布。你是否要继续?","cleanConfirm.cancel":"取消","cleanConfirm.ok":"确认","popupToolbar.fontColor":"字体颜色","popupToolbar.stroke":"边框","popupToolbar.fillColor":"填充颜色","popupToolbar.link":"链接","line.source":"起点","line.target":"终点","line.arrow":"箭头","line.none":"无"},en:{"toolbar.hand":"Hand — H","toolbar.selection":"Selection — V","toolbar.mind":"Mind — M","toolbar.text":"Text — T","toolbar.pen":"Pen — P","toolbar.eraser":"Eraser — E","toolbar.arrow":"Arrow — A","toolbar.shape":"Shape","toolbar.image":"Image — Cmd+U","toolbar.extraTools":"Extra Tools","zoom.in":"Zoom In — Cmd++","zoom.out":"Zoom Out — Cmd+-","zoom.fit":"Fit to Screen","zoom.100":"Zoom to 100%","theme.default":"Default","theme.colorful":"Colorful","theme.soft":"Soft","theme.retro":"Retro","theme.dark":"Dark","theme.starry":"Starry","general.undo":"Undo","general.redo":"Redo","general.menu":"App Menu","general.duplicate":"Duplicate","general.delete":"Delete","language.switcher":"Language","language.chinese":"中文","language.english":"English","menu.open":"Open","menu.saveFile":"Save File","menu.exportImage":"Export Image","menu.exportImage.png":"PNG","menu.exportImage.jpg":"JPG","menu.cleanBoard":"Clear Board","menu.github":"GitHub","dialog.mermaid.title":"Mermaid to Drawnix","dialog.mermaid.description":"Currently supports","dialog.mermaid.flowchart":"flowcharts","dialog.mermaid.sequence":"sequence diagrams","dialog.mermaid.class":"class diagrams","dialog.mermaid.otherTypes":", and other diagram types (rendered as images).","dialog.mermaid.syntax":"Mermaid Syntax","dialog.mermaid.placeholder":"Write your Mermaid chart definition here...","dialog.mermaid.preview":"Preview","dialog.mermaid.insert":"Insert","dialog.markdown.description":"Supports automatic conversion of Markdown syntax to mind map.","dialog.markdown.syntax":"Markdown Syntax","dialog.markdown.placeholder":"Write your Markdown text definition here...","dialog.markdown.preview":"Preview","dialog.markdown.insert":"Insert","dialog.error.loadMermaid":"Failed to load Mermaid library","extraTools.mermaidToDrawnix":"Mermaid to Drawnix","extraTools.markdownToDrawnix":"Markdown to Drawnix","cleanConfirm.title":"Clear Board","cleanConfirm.description":"This will clear the entire board. Do you want to continue?","cleanConfirm.cancel":"Cancel","cleanConfirm.ok":"OK","popupToolbar.fontColor":"Font Color","popupToolbar.stroke":"Stroke","popupToolbar.fillColor":"Fill Color","popupToolbar.link":"Link","line.source":"Start","line.target":"End","line.arrow":"Arrow","line.none":"None"}},Gn=E.createContext(void 0),Zn=({children:e,defaultLanguage:t="zh"})=>{const[r,n]=E.useState(t),o=a=>Ls[r][a]||a,i=E.useMemo(()=>({language:r,setLanguage:n,t:o}),[r]);return s.jsx(Gn.Provider,{value:i,children:e})},te=()=>{const e=E.useContext(Gn);if(!e)throw new Error("useI18n must be used within I18nProvider");return e},Yn=[{icon:fr,pointer:de.feltTipPen,titleKey:"toolbar.pen"},{icon:Gi,pointer:de.eraser,titleKey:"toolbar.eraser"}],Os=Et(Yn,5),Ts=({onPointerUp:e})=>{const{t}=te(),r=Z.useBoard();return s.jsx(ce,{padding:1,children:s.jsx(oe.Col,{gap:1,children:Os.map((n,o)=>s.jsx(oe.Row,{gap:1,children:n.map((i,a)=>s.jsx(A,{className:D({fillable:!1}),selected:r.pointer===i.pointer,type:"icon",size:"small",visible:!0,icon:i.icon,title:t(i.titleKey),"aria-label":t(i.titleKey),onPointerDown:()=>{P.setCreationMode(r,P.BoardCreationMode.dnd),m.BoardTransforms.updatePointerType(r,i.pointer)},onPointerUp:()=>{P.setCreationMode(r,P.BoardCreationMode.drawing),e(i.pointer)}},a))},o))})})},Ms=[{icon:Yi,title:"Rectangle — R",pointer:j.BasicShapes.rectangle},{icon:Ji,title:"Ellipse — O",pointer:j.BasicShapes.ellipse},{icon:Qi,title:"Triangle",pointer:j.BasicShapes.triangle},{icon:Xi,title:"Terminal",pointer:j.FlowchartSymbols.terminal},{icon:es,title:"Diamond",pointer:j.BasicShapes.diamond},{icon:ts,title:"Parallelogram",pointer:j.BasicShapes.parallelogram},{icon:rs,title:"RoundRectangle",pointer:j.BasicShapes.roundRectangle}],Ds=Et(Ms,5),_s=({onPointerUp:e})=>{const t=Z.useBoard();return s.jsx(ce,{padding:1,children:s.jsx(oe.Col,{gap:1,children:Ds.map((r,n)=>s.jsx(oe.Row,{gap:1,children:r.map((o,i)=>s.jsx(A,{className:D({fillable:!1}),type:"icon",size:"small",visible:!0,icon:o.icon,title:o.title,"aria-label":o.title,onPointerDown:()=>{P.setCreationMode(t,P.BoardCreationMode.dnd),m.BoardTransforms.updatePointerType(t,o.pointer)},onPointerUp:()=>{P.setCreationMode(t,P.BoardCreationMode.drawing),e(o.pointer)}},i))},n))})})},Bs=[{icon:ns,title:"Straight Arrow Line",pointer:j.ArrowLineShape.straight},{icon:os,title:"Elbow Arrow Line",pointer:j.ArrowLineShape.elbow},{icon:is,title:"Curve Arrow Line",pointer:j.ArrowLineShape.curve}],Fs=({onPointerUp:e})=>{const t=Z.useBoard();return s.jsx(ce,{padding:1,children:s.jsx(oe.Row,{gap:1,children:Bs.map((r,n)=>s.jsx(A,{className:D({fillable:!1}),type:"icon",size:"small",visible:!0,icon:r.icon,title:r.title,"aria-label":r.title,onPointerDown:()=>{P.setCreationMode(t,P.BoardCreationMode.drawing),m.BoardTransforms.updatePointerType(t,r.pointer)},onPointerUp:()=>{e(r.pointer)}},n))})})};function As({initialOpen:e=!1,placement:t="bottom",modal:r,sideOffset:n,open:o,onOpenChange:i}={}){const[a,l]=K.useState(e),[c,u]=K.useState(),[d,h]=K.useState(),f=o??a,g=i??l,y=F.useFloating({placement:t,open:f,onOpenChange:g,whileElementsMounted:F.autoUpdate,middleware:[F.offset(n||4),F.flip({crossAxis:t.includes("-"),fallbackAxisSideDirection:"end",padding:5}),F.shift({padding:5})]}),v=y.context,x=F.useClick(v,{enabled:o==null}),p=F.useDismiss(v),b=F.useRole(v),C=F.useInteractions([x,p,b]);return K.useMemo(()=>({open:f,setOpen:g,...C,...y,modal:r,labelId:c,descriptionId:d,setLabelId:u,setDescriptionId:h}),[f,g,C,y,r,c,d])}const Xn=K.createContext(null),Jn=()=>{const e=K.useContext(Xn);if(e==null)throw new Error("Popover components must be wrapped in <Popover />");return e};function xe({children:e,modal:t=!1,...r}){const n=As({modal:t,...r});return s.jsx(Xn.Provider,{value:n,children:e})}const Ce=K.forwardRef(function({children:t,asChild:r=!1,...n},o){const i=Jn(),a=t.ref,l=F.useMergeRefs([i.refs.setReference,o,a]);return r&&K.isValidElement(t)?K.cloneElement(t,i.getReferenceProps({ref:l,...n,...t.props,"data-state":i.open?"open":"closed"})):s.jsx("button",{ref:l,type:"button","data-state":i.open?"open":"closed",...i.getReferenceProps(n),children:t})}),be=K.forwardRef(function({container:t,style:r,...n},o){const{context:i,...a}=Jn(),l=F.useMergeRefs([a.refs.setFloating,o]);return i.open?s.jsx(F.FloatingPortal,{root:t,children:s.jsx(F.FloatingFocusManager,{context:i,modal:a.modal,children:s.jsx("div",{ref:l,style:{...a.floatingStyles,...r},"aria-labelledby":a.labelId,"aria-describedby":a.descriptionId,...a.getFloatingProps(n),children:n.children})})}):null});var De=(e=>(e.mermaidToDrawnix="mermaidToDrawnix",e.markdownToDrawnix="markdownToDrawnix",e))(De||{});const Qn=E.createContext(null),ve=()=>{const e=E.useContext(Qn);if(!e)throw new Error("The `useDrawnix` hook must be used inside the <Drawnix> component's context.");return e},Is=()=>{const{appState:e,setAppState:t}=ve();return r=>{t({...e,pointer:r})}},jt=E.createContext({}),Qt=(e="",t=!1)=>`menu-item menu-item-base ${e} ${t?"menu-item--active":""}`.trim(),eo=(e,t)=>{const r=E.useContext(jt);return Rn(e,n=>{var i;const o=new CustomEvent(qe.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});t==null||t(o),o.defaultPrevented||(i=r.onSelect)==null||i.call(r,o)})},Ve=({children:e,className:t="",onSelect:r,style:n})=>{const o=D(`menu ${t}`).trim();return s.jsx(jt.Provider,{value:{onSelect:r},children:s.jsx("div",{className:o,style:n,"data-testid":"menu",children:s.jsx(ce,{className:"menu-container",padding:2,children:e})})})};Ve.displayName="Menu";const to=({icon:e,shortcut:t,children:r})=>s.jsxs(s.Fragment,{children:[e&&s.jsx("div",{className:"menu-item__icon",children:e}),s.jsx("div",{className:"menu-item__text",children:r}),t&&s.jsx("div",{className:"menu-item__shortcut",children:t})]}),se=({icon:e,onSelect:t,children:r,shortcut:n,className:o,selected:i,submenu:a,...l})=>{const[c,u]=E.useState(!1),d=E.useRef(),h=eo(l.onClick,t),f=s.jsx(to,{icon:e,shortcut:n,children:r}),g=()=>{d.current&&window.clearTimeout(d.current),u(!0)},y=()=>{d.current=window.setTimeout(()=>{u(!1)},100)};return a?s.jsxs(xe,{open:c,onOpenChange:u,placement:"right-start",children:[s.jsx(Ce,{asChild:!0,children:s.jsx("button",{...l,type:"button",className:Qt(o,i||c),title:l.title??l["aria-label"],onClick:h,onMouseEnter:g,onMouseLeave:y,children:f})}),s.jsx(be,{onMouseEnter:g,onMouseLeave:y,children:a})]}):s.jsx("button",{...l,onClick:h,type:"button",className:Qt(o,i),title:l.title??l["aria-label"],children:f})};se.displayName="MenuItem";const ro=({children:e})=>s.jsx("div",{style:{display:"inline-flex",marginLeft:"auto",padding:"2px 4px",background:"var(--color-promo)",color:"var(--color-surface-lowest)",borderRadius:6,fontSize:9,fontFamily:"Cascadia, monospace"},children:e});ro.displayName="MenuItemBadge";se.Badge=ro;const no=()=>{const{appState:e,setAppState:t}=ve(),{t:r}=te();return s.jsx(se,{"data-testid":"marmaid-to-drawnix-button",onSelect:()=>{t({...e,openDialogType:De.mermaidToDrawnix})},icon:ks,"aria-label":r("extraTools.mermaidToDrawnix"),children:r("extraTools.mermaidToDrawnix")})};no.displayName="MermaidToDrawnix";const oo=()=>{const{appState:e,setAppState:t}=ve(),{t:r}=te();return s.jsx(se,{"data-testid":"markdown-to-drawnix-button",onSelect:()=>{t({...e,openDialogType:De.markdownToDrawnix})},icon:Ps,"aria-label":r("extraTools.markdownToDrawnix"),children:r("extraTools.markdownToDrawnix")})};oo.displayName="MarkdownToDrawnix";const Rs=()=>{const e=Z.useBoard(),{t}=te(),r=m.PlaitBoard.getBoardContainer(e),[n,o]=E.useState(!1);return s.jsxs(xe,{sideOffset:12,open:n,onOpenChange:i=>{o(i)},placement:"bottom-start",children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{type:"icon",visible:!0,selected:n,icon:Wn,title:t("toolbar.extraTools"),"aria-label":t("toolbar.extraTools"),onPointerDown:()=>{o(!n)}})}),s.jsx(be,{container:r,children:s.jsxs(Ve,{onSelect:()=>{o(!1)},children:[s.jsx(no,{}),s.jsx(oo,{})]})})]},0)},Je=(e,t)=>{const r=m.getSelectedElements(e);zn(e,{elements:r.length>0?r:void 0,fillStyle:t?"transparent":"white"}).then(n=>{if(n){const o=t?"png":"jpg",i=Nn(n),a=`drawnix-${new Date().getTime()}.${o}`;Hn(i,a)}})},hr=async e=>{const t=await Bn({description:"Image",extensions:Object.keys(lr)});pt(e,t)},Tt=e=>e===m.PlaitPointerType.hand||e===m.PlaitPointerType.selection,Br=[{icon:Wi,pointer:m.PlaitPointerType.hand,titleKey:"toolbar.hand"},{icon:qi,pointer:m.PlaitPointerType.selection,titleKey:"toolbar.selection"},{icon:Ki,pointer:I.MindPointerType.mind,titleKey:"toolbar.mind"},{icon:Vi,pointer:j.BasicShapes.text,titleKey:"toolbar.text"},{icon:fr,pointer:de.feltTipPen,titleKey:"toolbar.pen",key:"freehand"},{icon:Zi,titleKey:"toolbar.arrow",key:"arrow",pointer:j.ArrowLineShape.straight},{icon:$i,titleKey:"toolbar.shape",key:"shape",pointer:j.BasicShapes.rectangle},{icon:js,titleKey:"toolbar.image",key:"image"},{icon:Wn,titleKey:"toolbar.extraTools",key:"extra-tools"}],Ns=e=>Object.keys(j.ArrowLineShape).includes(e.pointer),zs=e=>Object.keys(j.BasicShapes).includes(e.pointer)||Object.keys(j.FlowchartSymbols).includes(e.pointer),Hs=()=>{const e=Z.useBoard(),{appState:t}=ve(),{t:r}=te(),n=Is(),o=m.PlaitBoard.getBoardContainer(e),[i,a]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(!1),[h,f]=E.useState(Br.find(p=>p.key==="freehand")),g=p=>{P.setCreationMode(e,P.BoardCreationMode.dnd),m.BoardTransforms.updatePointerType(e,p),n(p)},y=()=>{P.setCreationMode(e,P.BoardCreationMode.drawing)},v=p=>m.PlaitBoard.isPointer(e,p.pointer)&&!l&&!u&&!i,x=p=>m.PlaitBoard.isInPointer(p,[de.feltTipPen,de.eraser]);return s.jsx(ce,{padding:1,className:D("draw-toolbar",m.ATTACHED_ELEMENT_CLASS_NAME),children:s.jsx(oe.Row,{gap:1,children:Br.map((p,b)=>t.isMobile&&p.pointer===m.PlaitPointerType.hand?s.jsx(s.Fragment,{}):p.key==="freehand"?s.jsxs(xe,{open:i||x(e),sideOffset:12,onOpenChange:C=>{a(C)},children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{type:"icon",visible:!0,selected:i||x(e),icon:h.icon,title:h.titleKey?r(h.titleKey):"Freehand","aria-label":h.titleKey?r(h.titleKey):"Freehand",onPointerDown:()=>{a(!i),g(h.pointer)},onPointerUp:()=>{y()}})}),s.jsx(be,{container:o,children:s.jsx(Ts,{onPointerUp:C=>{n(C),f(Yn.find(k=>k.pointer===C))}})})]},b):p.key==="shape"?s.jsxs(xe,{open:u,sideOffset:12,onOpenChange:C=>{d(C)},children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{type:"icon",visible:!0,selected:u||zs(e)&&!m.PlaitBoard.isPointer(e,j.BasicShapes.text),icon:p.icon,title:p.titleKey?r(p.titleKey):"Shape","aria-label":p.titleKey?r(p.titleKey):"Shape",onPointerDown:()=>{d(!u)}})}),s.jsx(be,{container:o,children:s.jsx(_s,{onPointerUp:C=>{d(!1),n(C)}})})]},b):p.key==="arrow"?s.jsxs(xe,{open:l,sideOffset:12,onOpenChange:C=>{c(C)},children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{type:"icon",visible:!0,selected:l||Ns(e),icon:p.icon,title:p.titleKey?r(p.titleKey):"","aria-label":p.titleKey?r(p.titleKey):"",onPointerDown:()=>{c(!l)}})}),s.jsx(be,{container:o,children:s.jsx(Fs,{onPointerUp:C=>{c(!1),n(C)}})})]},b):p.key==="extra-tools"?s.jsx(Rs,{},b):s.jsx(A,{type:"radio",icon:p.icon,checked:v(p),title:p.titleKey?r(p.titleKey):"","aria-label":p.titleKey?r(p.titleKey):"",onPointerDown:()=>{p.pointer&&!Tt(p.pointer)&&g(p.pointer)},onPointerUp:()=>{p.pointer&&!Tt(p.pointer)?y():p.pointer&&Tt(p.pointer)&&(m.BoardTransforms.updatePointerType(e,p.pointer),n(p.pointer)),p.key==="image"&&hr(e)}},b))})})},Us=()=>{var i;const e=Z.useBoard(),{t}=te(),r=m.PlaitBoard.getBoardContainer(e),[n,o]=E.useState(!1);return s.jsx(ce,{padding:1,className:D("zoom-toolbar",m.ATTACHED_ELEMENT_CLASS_NAME),children:s.jsxs(oe.Row,{gap:1,children:[s.jsx(A,{type:"button",icon:ls,visible:!0,title:t("zoom.out"),"aria-label":t("zoom.out"),onPointerUp:()=>{m.BoardTransforms.updateZoom(e,e.viewport.zoom-.1)},className:"zoom-out-button"},0),s.jsxs(xe,{sideOffset:12,open:n,onOpenChange:a=>{o(a)},placement:"bottom-end",children:[s.jsx(Ce,{asChild:!0,children:s.jsxs("div",{title:t("zoom.fit"),"aria-label":t("zoom.fit"),className:D("zoom-menu-trigger",{active:n}),onPointerUp:()=>{o(!n)},children:[Number(((((i=e==null?void 0:e.viewport)==null?void 0:i.zoom)||1)*100).toFixed(0)),"%"]},1)}),s.jsx(be,{container:r,children:s.jsxs(Ve,{onSelect:()=>{o(!1)},children:[s.jsx(se,{"data-testid":"open-button",onSelect:()=>{m.BoardTransforms.fitViewport(e)},"aria-label":t("zoom.fit"),shortcut:"Cmd+Shift+=",children:t("zoom.fit")}),s.jsx(se,{"data-testid":"open-button",onSelect:()=>{m.BoardTransforms.updateZoom(e,1)},"aria-label":t("zoom.100"),shortcut:"Cmd+0",children:t("zoom.100")})]})})]}),s.jsx(A,{type:"button",icon:cs,visible:!0,title:t("zoom.in"),"aria-label":t("zoom.in"),onPointerUp:()=>{m.BoardTransforms.updateZoom(e,e.viewport.zoom+.1)},className:"zoom-in-button"},2)]})})},io="TRANSPARENT",mr="NO_COLOR",gr="#FFFFFF",so=[{name:"Topic Color",value:mr},{name:"Basic Black",value:m.DEFAULT_COLOR},{name:"White",value:gr},{name:"Gray",value:"#808080"},{name:"Deep Blue",value:"#1E90FF"},{name:"Red",value:"#FF4500"},{name:"Green",value:"#2ECC71"},{name:"Yellow",value:"#FFD700"},{name:"Purple",value:"#8A2BE2"},{name:"Orange",value:"#FFA500"},{name:"Pastel Pink",value:"#FFB3BA"},{name:"Cyan",value:"#00CED1"},{name:"Brown",value:"#8B4513"},{name:"Forest Green",value:"#228B22"},{name:"Light Gray",value:"#D3D3D3"}];function Ws(e){return Math.round((100-e)/100*255)}function qs(e){return Math.round((1-e/255)*100)}function Ie(e,t){const n=Ws(100-t).toString(16).padStart(2,"0");return`${e}${n}`}function Re(e){e=e.replace(/^#/,"");let t;if(e.length===8)t=parseInt(e.slice(6,8),16);else if(e.length===4)t=parseInt(e.slice(3,4).repeat(2),16);else return 100;return 100-qs(t)}function ao(e){return e!=="none"}function Oe(e){const t=e.replace(/^#/,"").toUpperCase();return t.length===8?"#"+t.slice(0,6):t.length===4?"#"+t.slice(0,3):t.length===6||t.length===3?"#"+t:e}function Ks(e){return e===io}function pr(e){return e===gr}function vr(e){return e===0}function Ge(e){return e===100}function _e(e){return e===mr}function lo(e){return!e||e===m.DEFAULT_COLOR}const $s=({min:e=0,max:t=100,step:r=1,defaultValue:n=100,disabled:o=!1,onChange:i,beforeStart:a,afterEnd:l})=>{const[c,u]=E.useState(!1),[d,h]=E.useState(n),f=E.useRef(0),g=E.useRef(null),y=E.useRef(null);E.useEffect(()=>{if(g.current&&y.current){const b=g.current.getBoundingClientRect(),C=y.current.getBoundingClientRect();f.current=m.toFixed(C.width/2/b.width*100)}},[y,g]),E.useEffect(()=>{h(n)},[n]);const v=E.useCallback(ri.throttle(b=>{if(g.current&&y.current){const C=g.current.getBoundingClientRect(),k=b.clientX-C.left;let L=Math.min(Math.max(k/C.width,0),1);L>=(100-f.current)/100?L=1:L<=f.current/100&&(L=0);const _=Math.round(L*(t-e)/r)*r+e;h(_),i&&i(_)}},50,{leading:!0,trailing:!0}),[e,t,r,i]),x=E.useCallback(()=>{const b=k=>{u(!0),v(k)},C=()=>{document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",C),l&&l(),setTimeout(()=>{u(!1)},0)};document.addEventListener("pointermove",b),document.addEventListener("pointerup",C)},[v]);let p=(d-e)/(t-e)*100;return p>=100-f.current&&(p=100-f.current),p<=f.current&&(p=f.current),s.jsx("div",{className:D("slider-container",{disabled:o}),children:s.jsxs("div",{ref:g,className:"slider-track",onClick:b=>{o||c||v(b)},onPointerDown:b=>{b.preventDefault(),!o&&(a&&a(),x())},children:[s.jsx("div",{className:"slider-range",style:{width:`${p}%`}}),s.jsx("div",{ref:y,className:"slider-thumb",style:{left:`${p}%`}})]})})},Fr=Et(so,4),wr=E.forwardRef((e,t)=>{const r=Z.useBoard(),{currentColor:n,onColorChange:o,onOpacityChange:i}=e,[a,l]=E.useState(n&&Oe(n)||Fr[0][0].value),[c,u]=E.useState(()=>{const d=n&&Re(n);return m.isNullOrUndefined(d)?100:d});return s.jsxs(oe.Col,{gap:3,children:[s.jsx($s,{step:5,defaultValue:c,onChange:d=>{u(d),i(d)},beforeStart:()=>{m.MERGING.set(r,!0),m.PlaitHistoryBoard.setSplittingOnce(r,!0)},afterEnd:()=>{m.MERGING.set(r,!1)},disabled:a===so[0].value}),s.jsx(oe.Col,{gap:2,children:Fr.map((d,h)=>s.jsx(oe.Row,{gap:2,children:d.map(f=>s.jsxs("button",{className:`color-select-item ${a===f.value?"active":""} ${_e(f.value)?"no-color":""}`,style:{backgroundColor:_e(f.value)?io:f.value,color:lo(f.value)?gr:m.DEFAULT_COLOR},onClick:()=>{l(f.value),f.value===mr&&u(100),o(f.value)},title:f.name,children:[_e(f.value)&&hs,a===f.value&&ms]},f.value))},h))})]})}),yr=(e,t)=>I.MindElement.isMindElement(e,t)||j.PlaitDrawElement.isDrawElement(t)&&j.isClosedDrawElement(t)||j.isClosedCustomGeometry(e,t),xr=(e,t)=>{let r=t.fill;return r||(I.MindElement.isMindElement(e,t)&&(r=I.getFillByElement(e,t)),(j.PlaitDrawElement.isDrawElement(t)||j.PlaitDrawElement.isCustomGeometryElement(e,t))&&(r=j.getFillByElement(e,t))),r},Cr=(e,t)=>{let r=t.strokeColor;return r||(I.MindElement.isMindElement(e,t)&&(r=I.getStrokeColorByElement(e,t)),(j.PlaitDrawElement.isDrawElement(t)||j.PlaitDrawElement.isCustomGeometryElement(e,t))&&(r=j.getStrokeColorByElement(e,t))),r},Vs=(e,t)=>pe.getTextMarksByElement(t).color,Gs=(e,t)=>{P.PropertyTransforms.setFillColor(e,null,{getMemorizeKey:j.getMemorizeKey,callback:(r,n)=>{if(!yr(e,r))return;const o=xr(e,r);if(!ao(o))return;const i=Oe(o),a=Ge(t)?i:Ie(i,t);m.Transforms.setNode(e,{fill:a},n)}})},Zs=(e,t)=>{P.PropertyTransforms.setFillColor(e,null,{getMemorizeKey:j.getMemorizeKey,callback:(r,n)=>{if(!yr(e,r))return;const o=xr(e,r),i=Re(o);_e(t)?m.Transforms.setNode(e,{fill:null},n):m.isNullOrUndefined(i)||Ge(i)?m.Transforms.setNode(e,{fill:t},n):m.Transforms.setNode(e,{fill:Ie(t,i)},n)}})},Ys=(e,t)=>{P.PropertyTransforms.setStrokeColor(e,null,{getMemorizeKey:j.getMemorizeKey,callback:(r,n)=>{const o=Cr(e,r),i=Oe(o),a=Ge(t)?i:Ie(i,t);m.Transforms.setNode(e,{strokeColor:a},n)}})},Xs=(e,t)=>{P.PropertyTransforms.setStrokeColor(e,null,{getMemorizeKey:j.getMemorizeKey,callback:(r,n)=>{const o=Cr(e,r),i=Re(o);_e(t)?m.Transforms.setNode(e,{strokeColor:null},n):m.isNullOrUndefined(i)||Ge(i)?m.Transforms.setNode(e,{strokeColor:t},n):m.Transforms.setNode(e,{strokeColor:Ie(t,i)},n)}})},Js=(e,t,r)=>{const n=Re(t);_e(r)?pe.TextTransforms.setTextColor(e,null):pe.TextTransforms.setTextColor(e,Ie(r,n))},Qs=(e,t,r)=>{const n=Oe(t),o=Ge(r)?n:Ie(n,r);pe.TextTransforms.setTextColor(e,o)},ea=({board:e,currentColor:t,fontColorIcon:r,title:n})=>{const[o,i]=E.useState(!1),a=m.PlaitBoard.getBoardContainer(e);return s.jsxs(xe,{sideOffset:12,open:o,onOpenChange:l=>{i(l)},placement:"top",children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{className:D("property-button"),selected:o,visible:!0,icon:r,type:"button",title:n,"aria-label":n,onPointerUp:()=>{i(!o)}})}),s.jsx(be,{container:a,children:s.jsx(ce,{padding:4,className:D(`${m.ATTACHED_ELEMENT_CLASS_NAME}`),children:s.jsx(wr,{onColorChange:l=>{Js(e,t||l,l)},onOpacityChange:l=>{t&&Qs(e,t,l)},currentColor:t})})})]})},ta=({board:e,currentColor:t,title:r,hasStrokeStyle:n,children:o})=>{const[i,a]=E.useState(!1),l=t&&Oe(t),c=t?Re(t):100,u=m.PlaitBoard.getBoardContainer(e),d=vr(c)?gs:pr(l)?ps:void 0,h=f=>{P.PropertyTransforms.setStrokeStyle(e,f,{getMemorizeKey:j.getMemorizeKey})};return s.jsxs(xe,{sideOffset:12,open:i,onOpenChange:f=>{a(f)},placement:"top",children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{className:D("property-button"),visible:!0,icon:d,type:"button",title:r,"aria-label":r,onPointerUp:()=>{a(!i)},children:!d&&o})}),s.jsx(be,{container:u,children:s.jsx(ce,{padding:4,className:D(`${m.ATTACHED_ELEMENT_CLASS_NAME}`,"stroke-setting",{"has-stroke-style":n}),children:s.jsxs(oe.Col,{children:[n&&s.jsxs(oe.Row,{className:D("stroke-style-picker"),children:[s.jsx(A,{visible:!0,icon:vs,type:"button",title:r,"aria-label":r,onPointerUp:()=>{h(P.StrokeStyle.solid)}}),s.jsx(A,{visible:!0,icon:ws,type:"button",title:r,"aria-label":r,onPointerUp:()=>{h(P.StrokeStyle.dashed)}}),s.jsx(A,{visible:!0,icon:ys,type:"button",title:r,"aria-label":r,onPointerUp:()=>{h(P.StrokeStyle.dotted)}})]}),s.jsx(wr,{onColorChange:f=>{Xs(e,f)},onOpacityChange:f=>{Ys(e,f)},currentColor:t})]})})})]})},ra=({board:e,currentColor:t,title:r,children:n})=>{const[o,i]=E.useState(!1),a=t&&Oe(t),l=t?Re(t):100,c=m.PlaitBoard.getBoardContainer(e),u=!a||vr(l)?fs:void 0;return s.jsxs(xe,{sideOffset:12,open:o,onOpenChange:d=>{i(d)},placement:"top",children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{className:D("property-button"),visible:!0,icon:u,type:"button",title:r,"aria-label":r,onPointerUp:()=>{i(!o)},children:!u&&n})}),s.jsx(be,{container:c,children:s.jsx(ce,{padding:4,className:D(`${m.ATTACHED_ELEMENT_CLASS_NAME}`),children:s.jsx(wr,{onColorChange:d=>{Zs(e,d)},onOpacityChange:d=>{Gs(e,d)},currentColor:t})})})]})};var Mt,Ar;function br(){if(Ar)return Mt;Ar=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Mt=e,Mt}var Dt,Ir;function na(){if(Ir)return Dt;Ir=1;var e=typeof ut=="object"&&ut&&ut.Object===Object&&ut;return Dt=e,Dt}var _t,Rr;function co(){if(Rr)return _t;Rr=1;var e=na(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return _t=r,_t}var Bt,Nr;function oa(){if(Nr)return Bt;Nr=1;var e=co(),t=function(){return e.Date.now()};return Bt=t,Bt}var Ft,zr;function ia(){if(zr)return Ft;zr=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return Ft=t,Ft}var At,Hr;function sa(){if(Hr)return At;Hr=1;var e=ia(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return At=r,At}var It,Ur;function uo(){if(Ur)return It;Ur=1;var e=co(),t=e.Symbol;return It=t,It}var Rt,Wr;function aa(){if(Wr)return Rt;Wr=1;var e=uo(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,o=e?e.toStringTag:void 0;function i(a){var l=r.call(a,o),c=a[o];try{a[o]=void 0;var u=!0}catch{}var d=n.call(a);return u&&(l?a[o]=c:delete a[o]),d}return Rt=i,Rt}var Nt,qr;function la(){if(qr)return Nt;qr=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Nt=r,Nt}var zt,Kr;function ca(){if(Kr)return zt;Kr=1;var e=uo(),t=aa(),r=la(),n="[object Null]",o="[object Undefined]",i=e?e.toStringTag:void 0;function a(l){return l==null?l===void 0?o:n:i&&i in Object(l)?t(l):r(l)}return zt=a,zt}var Ht,$r;function ua(){if($r)return Ht;$r=1;function e(t){return t!=null&&typeof t=="object"}return Ht=e,Ht}var Ut,Vr;function da(){if(Vr)return Ut;Vr=1;var e=ca(),t=ua(),r="[object Symbol]";function n(o){return typeof o=="symbol"||t(o)&&e(o)==r}return Ut=n,Ut}var Wt,Gr;function fa(){if(Gr)return Wt;Gr=1;var e=sa(),t=br(),r=da(),n=NaN,o=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var h=i.test(u);return h||a.test(u)?l(u.slice(2),h?2:8):o.test(u)?n:+u}return Wt=c,Wt}var qt,Zr;function fo(){if(Zr)return qt;Zr=1;var e=br(),t=oa(),r=fa(),n="Expected a function",o=Math.max,i=Math.min;function a(l,c,u){var d,h,f,g,y,v,x=0,p=!1,b=!1,C=!0;if(typeof l!="function")throw new TypeError(n);c=r(c)||0,e(u)&&(p=!!u.leading,b="maxWait"in u,f=b?o(r(u.maxWait)||0,c):f,C="trailing"in u?!!u.trailing:C);function k(N){var ue=d,me=h;return d=h=void 0,x=N,g=l.apply(me,ue),g}function L(N){return x=N,y=setTimeout(B,c),p?k(N):g}function _(N){var ue=N-v,me=N-x,Te=c-ue;return b?i(Te,f-me):Te}function Y(N){var ue=N-v,me=N-x;return v===void 0||ue>=c||ue<0||b&&me>=f}function B(){var N=t();if(Y(N))return Q(N);y=setTimeout(B,_(N))}function Q(N){return y=void 0,C&&d?k(N):(d=h=void 0,g)}function ae(){y!==void 0&&clearTimeout(y),x=0,d=v=h=y=void 0}function re(){return y===void 0?g:Q(t())}function X(){var N=t(),ue=Y(N);if(d=arguments,h=this,v=N,ue){if(y===void 0)return L(v);if(b)return clearTimeout(y),y=setTimeout(B,c),k(v)}return y===void 0&&(y=setTimeout(B,c)),g}return X.cancel=ae,X.flush=re,X}return qt=a,qt}fo();var Kt,Yr;function ha(){if(Yr)return Kt;Yr=1;var e=fo(),t=br(),r="Expected a function";function n(o,i,a){var l=!0,c=!0;if(typeof o!="function")throw new TypeError(r);return t(a)&&(l="leading"in a?!!a.leading:l,c="trailing"in a?!!a.trailing:c),e(o,i,{leading:l,maxWait:i,trailing:c})}return Kt=n,Kt}ha();var ho=Symbol.for("immer-nothing"),Xr=Symbol.for("immer-draftable"),fe=Symbol.for("immer-state"),ma=process.env.NODE_ENV!=="production"?[function(e){return`The plugin for '${e}' has not been loaded into Immer. To enable the plugin, import and call \`enable${e}()\` when initializing your application.`},function(e){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${e}'`},"This object has been frozen and should not be mutated",function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(e){return`'current' expects a draft, got: ${e}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(e){return`'original' expects a draft, got: ${e}`}]:[];function le(e,...t){if(process.env.NODE_ENV!=="production"){const r=ma[e],n=typeof r=="function"?r.apply(null,t):r;throw new Error(`[Immer] ${n}`)}throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ke=Object.getPrototypeOf;function $e(e){return!!e&&!!e[fe]}function Fe(e){var t;return e?mo(e)||Array.isArray(e)||!!e[Xr]||!!((t=e.constructor)!=null&&t[Xr])||Pt(e)||St(e):!1}var ga=Object.prototype.constructor.toString();function mo(e){if(!e||typeof e!="object")return!1;const t=Ke(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===ga}function wt(e,t){kt(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function kt(e){const t=e[fe];return t?t.type_:Array.isArray(e)?1:Pt(e)?2:St(e)?3:0}function er(e,t){return kt(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function go(e,t,r){const n=kt(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function pa(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Pt(e){return e instanceof Map}function St(e){return e instanceof Set}function Me(e){return e.copy_||e.base_}function tr(e,t){if(Pt(e))return new Map(e);if(St(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=mo(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[fe];let o=Reflect.ownKeys(n);for(let i=0;i<o.length;i++){const a=o[i],l=n[a];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[a]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[a]})}return Object.create(Ke(e),n)}else{const n=Ke(e);if(n!==null&&r)return{...e};const o=Object.create(n);return Object.assign(o,e)}}function Er(e,t=!1){return Lt(e)||$e(e)||!Fe(e)||(kt(e)>1&&(e.set=e.add=e.clear=e.delete=va),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>Er(n,!0))),e}function va(){le(2)}function Lt(e){return Object.isFrozen(e)}var wa={};function Ae(e){const t=wa[e];return t||le(0,e),t}var Qe;function po(){return Qe}function ya(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Jr(e,t){t&&(Ae("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function rr(e){nr(e),e.drafts_.forEach(xa),e.drafts_=null}function nr(e){e===Qe&&(Qe=e.parent_)}function Qr(e){return Qe=ya(Qe,e)}function xa(e){const t=e[fe];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function en(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[fe].modified_&&(rr(t),le(4)),Fe(e)&&(e=yt(t,e),t.parent_||xt(t,e)),t.patches_&&Ae("Patches").generateReplacementPatches_(r[fe].base_,e,t.patches_,t.inversePatches_)):e=yt(t,r,[]),rr(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ho?e:void 0}function yt(e,t,r){if(Lt(t))return t;const n=t[fe];if(!n)return wt(t,(o,i)=>tn(e,n,t,o,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return xt(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const o=n.copy_;let i=o,a=!1;n.type_===3&&(i=new Set(o),o.clear(),a=!0),wt(i,(l,c)=>tn(e,n,o,l,c,r,a)),xt(e,o,!1),r&&e.patches_&&Ae("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function tn(e,t,r,n,o,i,a){if(process.env.NODE_ENV!=="production"&&o===r&&le(5),$e(o)){const l=i&&t&&t.type_!==3&&!er(t.assigned_,n)?i.concat(n):void 0,c=yt(e,o,l);if(go(r,n,c),$e(c))e.canAutoFreeze_=!1;else return}else a&&r.add(o);if(Fe(o)&&!Lt(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;yt(e,o),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&xt(e,o)}}function xt(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Er(t,r)}function Ca(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:po(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=n,i=jr;r&&(o=[n],i=et);const{revoke:a,proxy:l}=Proxy.revocable(o,i);return n.draft_=l,n.revoke_=a,l}var jr={get(e,t){if(t===fe)return e;const r=Me(e);if(!er(r,t))return ba(e,r,t);const n=r[t];return e.finalized_||!Fe(n)?n:n===$t(e.base_,t)?(Vt(e),e.copy_[t]=ir(n,e)):n},has(e,t){return t in Me(e)},ownKeys(e){return Reflect.ownKeys(Me(e))},set(e,t,r){const n=vo(Me(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const o=$t(Me(e),t),i=o==null?void 0:o[fe];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(pa(r,o)&&(r!==void 0||er(e.base_,t)))return!0;Vt(e),or(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return $t(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Vt(e),or(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Me(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){le(11)},getPrototypeOf(e){return Ke(e.base_)},setPrototypeOf(){le(12)}},et={};wt(jr,(e,t)=>{et[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});et.deleteProperty=function(e,t){return process.env.NODE_ENV!=="production"&&isNaN(parseInt(t))&&le(13),et.set.call(this,e,t,void 0)};et.set=function(e,t,r){return process.env.NODE_ENV!=="production"&&t!=="length"&&isNaN(parseInt(t))&&le(14),jr.set.call(this,e[0],t,r,e[0])};function $t(e,t){const r=e[fe];return(r?Me(r):e)[t]}function ba(e,t,r){var o;const n=vo(t,r);return n?"value"in n?n.value:(o=n.get)==null?void 0:o.call(e.draft_):void 0}function vo(e,t){if(!(t in e))return;let r=Ke(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Ke(r)}}function or(e){e.modified_||(e.modified_=!0,e.parent_&&or(e.parent_))}function Vt(e){e.copy_||(e.copy_=tr(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Ea=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const a=this;return function(c=i,...u){return a.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&le(6),n!==void 0&&typeof n!="function"&&le(7);let o;if(Fe(t)){const i=Qr(this),a=ir(t,void 0);let l=!0;try{o=r(a),l=!1}finally{l?rr(i):nr(i)}return Jr(i,n),en(o,i)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===ho&&(o=void 0),this.autoFreeze_&&Er(o,!0),n){const i=[],a=[];Ae("Patches").generateReplacementPatches_(t,o,i,a),n(i,a)}return o}else le(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(a,...l)=>this.produceWithPatches(a,c=>t(c,...l));let n,o;return[this.produce(t,r,(a,l)=>{n=a,o=l}),n,o]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Fe(e)||le(8),$e(e)&&(e=ja(e));const t=Qr(this),r=ir(e,void 0);return r[fe].isManual_=!0,nr(t),r}finishDraft(e,t){const r=e&&e[fe];(!r||!r.isManual_)&&le(9);const{scope_:n}=r;return Jr(n,t),en(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));const n=Ae("Patches").applyPatches_;return $e(e)?n(e,t):this.produce(e,o=>n(o,t))}};function ir(e,t){const r=Pt(e)?Ae("MapSet").proxyMap_(e,t):St(e)?Ae("MapSet").proxySet_(e,t):Ca(e,t);return(t?t.scope_:po()).drafts_.push(r),r}function ja(e){return $e(e)||le(10,e),wo(e)}function wo(e){if(!Fe(e)||Lt(e))return e;const t=e[fe];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=tr(e,t.scope_.immer_.useStrictShallowCopy_)}else r=tr(e,!0);return wt(r,(n,o)=>{go(r,n,wo(o))}),t&&(t.finalized_=!1),r}var he=new Ea,ka=he.produce;he.produceWithPatches.bind(he);he.setAutoFreeze.bind(he);he.setUseStrictShallowCopy.bind(he);he.applyPatches.bind(he);he.createDraft.bind(he);he.finishDraft.bind(he);var w={ancestors(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:r=!1}=t,n=w.levels(e,t);return r?n=n.slice(1):n=n.slice(0,-1),n},common(e,t){for(var r=[],n=0;n<e.length&&n<t.length;n++){var o=e[n],i=t[n];if(o!==i)break;r.push(o)}return r},compare(e,t){for(var r=Math.min(e.length,t.length),n=0;n<r;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return 0},endsAfter(e,t){var r=e.length-1,n=e.slice(0,r),o=t.slice(0,r),i=e[r],a=t[r];return w.equals(n,o)&&i>a},endsAt(e,t){var r=e.length,n=e.slice(0,r),o=t.slice(0,r);return w.equals(n,o)},endsBefore(e,t){var r=e.length-1,n=e.slice(0,r),o=t.slice(0,r),i=e[r],a=t[r];return w.equals(n,o)&&i<a},equals(e,t){return e.length===t.length&&e.every((r,n)=>r===t[n])},hasPrevious(e){return e[e.length-1]>0},isAfter(e,t){return w.compare(e,t)===1},isAncestor(e,t){return e.length<t.length&&w.compare(e,t)===0},isBefore(e,t){return w.compare(e,t)===-1},isChild(e,t){return e.length===t.length+1&&w.compare(e,t)===0},isCommon(e,t){return e.length<=t.length&&w.compare(e,t)===0},isDescendant(e,t){return e.length>t.length&&w.compare(e,t)===0},isParent(e,t){return e.length+1===t.length&&w.compare(e,t)===0},isPath(e){return Array.isArray(e)&&(e.length===0||typeof e[0]=="number")},isSibling(e,t){if(e.length!==t.length)return!1;var r=e.slice(0,-1),n=t.slice(0,-1),o=e[e.length-1],i=t[t.length-1];return o!==i&&w.equals(r,n)},levels(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:r=!1}=t,n=[],o=0;o<=e.length;o++)n.push(e.slice(0,o));return r&&n.reverse(),n},next(e){if(e.length===0)throw new Error("Cannot get the next path of a root path [".concat(e,"], because it has no next index."));var t=e[e.length-1];return e.slice(0,-1).concat(t+1)},operationCanTransformPath(e){switch(e.type){case"insert_node":case"remove_node":case"merge_node":case"split_node":case"move_node":return!0;default:return!1}},parent(e){if(e.length===0)throw new Error("Cannot get the parent path of the root path [".concat(e,"]."));return e.slice(0,-1)},previous(e){if(e.length===0)throw new Error("Cannot get the previous path of a root path [".concat(e,"], because it has no previous index."));var t=e[e.length-1];if(t<=0)throw new Error("Cannot get the previous path of a first child path [".concat(e,"] because it would result in a negative index."));return e.slice(0,-1).concat(t-1)},relative(e,t){if(!w.isAncestor(t,e)&&!w.equals(e,t))throw new Error("Cannot get the relative path of [".concat(e,"] inside ancestor [").concat(t,"], because it is not above or equal to the path."));return e.slice(t.length)},transform(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return null;var n=[...e],{affinity:o="forward"}=r;if(e.length===0)return n;switch(t.type){case"insert_node":{var{path:i}=t;(w.equals(i,n)||w.endsBefore(i,n)||w.isAncestor(i,n))&&(n[i.length-1]+=1);break}case"remove_node":{var{path:a}=t;if(w.equals(a,n)||w.isAncestor(a,n))return null;w.endsBefore(a,n)&&(n[a.length-1]-=1);break}case"merge_node":{var{path:l,position:c}=t;w.equals(l,n)||w.endsBefore(l,n)?n[l.length-1]-=1:w.isAncestor(l,n)&&(n[l.length-1]-=1,n[l.length]+=c);break}case"split_node":{var{path:u,position:d}=t;if(w.equals(u,n)){if(o==="forward")n[n.length-1]+=1;else if(o!=="backward")return null}else w.endsBefore(u,n)?n[u.length-1]+=1:w.isAncestor(u,n)&&e[u.length]>=d&&(n[u.length-1]+=1,n[u.length]-=d);break}case"move_node":{var{path:h,newPath:f}=t;if(w.equals(h,f))return n;if(w.isAncestor(h,n)||w.equals(h,n)){var g=f.slice();return w.endsBefore(h,f)&&h.length<f.length&&(g[h.length-1]-=1),g.concat(n.slice(h.length))}else w.isSibling(h,f)&&(w.isAncestor(f,n)||w.equals(f,n))?w.endsBefore(h,n)?n[h.length-1]-=1:n[h.length-1]+=1:w.endsBefore(f,n)||w.equals(f,n)||w.isAncestor(f,n)?(w.endsBefore(h,n)&&(n[h.length-1]-=1),n[f.length-1]+=1):w.endsBefore(h,n)&&(w.equals(f,n)&&(n[f.length-1]+=1),n[h.length-1]-=1);break}}return n}};function tt(e){"@babel/helpers - typeof";return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(e)}function Pa(e,t){if(tt(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tt(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sa(e){var t=Pa(e,"string");return tt(t)==="symbol"?t:String(t)}function Ze(e,t,r){return t=Sa(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rn(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var nn=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return[...t.slice(0,r),...o,...t.slice(r)]},rt=function(t,r,n){for(var o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return[...t.slice(0,r),...i,...t.slice(r+n)]},on=rt,kr=(e,t,r)=>{if(t.length===0)throw new Error("Cannot modify the editor");for(var n=M.get(e,t),o=t.slice(),i=r(n);o.length>1;){var a=o.pop(),l=M.get(e,o);i=q(q({},l),{},{children:rt(l.children,a,1,i)})}var c=o.pop();e.children=rt(e.children,c,1,i)},Ue=(e,t,r)=>{t.length===0?e.children=r(e.children):kr(e,t,n=>{if(G.isText(n))throw new Error("Cannot get the element at path [".concat(t,"] because it refers to a leaf node: ").concat(ie.stringify(n)));return q(q({},n),{},{children:r(n.children)})})},sn=(e,t,r)=>kr(e,t,n=>{if(!G.isText(n))throw new Error("Cannot get the leaf node at path [".concat(t,"] because it refers to a non-leaf node: ").concat(ie.stringify(n)));return r(n)}),La={transform(e,t){var r=!1;switch(t.type){case"insert_node":{var{path:n,node:o}=t;Ue(e,w.parent(n),H=>{var U=n[n.length-1];if(U>H.length)throw new Error('Cannot apply an "insert_node" operation at path ['.concat(n,"] because the destination is past the end of the node."));return nn(H,U,o)}),r=!0;break}case"insert_text":{var{path:i,offset:a,text:l}=t;if(l.length===0)break;sn(e,i,H=>{var U=H.text.slice(0,a),J=H.text.slice(a);return q(q({},H),{},{text:U+l+J})}),r=!0;break}case"merge_node":{var{path:c}=t,u=c[c.length-1],d=w.previous(c),h=d[d.length-1];Ue(e,w.parent(c),H=>{var U=H[u],J=H[h],Ee;if(G.isText(U)&&G.isText(J))Ee=q(q({},J),{},{text:J.text+U.text});else if(!G.isText(U)&&!G.isText(J))Ee=q(q({},J),{},{children:J.children.concat(U.children)});else throw new Error('Cannot apply a "merge_node" operation at path ['.concat(c,"] to nodes of different interfaces: ").concat(ie.stringify(U)," ").concat(ie.stringify(J)));return rt(H,h,2,Ee)}),r=!0;break}case"move_node":{var{path:f,newPath:g}=t,y=f[f.length-1];if(w.isAncestor(f,g))throw new Error("Cannot move a path [".concat(f,"] to new path [").concat(g,"] because the destination is inside itself."));var v=M.get(e,f);Ue(e,w.parent(f),H=>on(H,y,1));var x=w.transform(f,t),p=x[x.length-1];Ue(e,w.parent(x),H=>nn(H,p,v)),r=!0;break}case"remove_node":{var{path:b}=t,C=b[b.length-1];if(Ue(e,w.parent(b),H=>on(H,C,1)),e.selection){var k=q({},e.selection);for(var[L,_]of T.points(k)){var Y=ee.transform(L,t);if(k!=null&&Y!=null)k[_]=Y;else{var B=void 0,Q=void 0;for(var[ae,re]of M.texts(e))if(w.compare(re,b)===-1)B=[ae,re];else{Q=[ae,re];break}var X=!1;B&&Q&&(w.equals(Q[1],b)?X=!w.hasPrevious(Q[1]):X=w.common(B[1],b).length<w.common(Q[1],b).length),B&&!X?k[_]={path:B[1],offset:B[0].text.length}:Q?k[_]={path:Q[1],offset:0}:k=null}}e.selection=k}break}case"remove_text":{var{path:N,offset:ue,text:me}=t;if(me.length===0)break;sn(e,N,H=>{var U=H.text.slice(0,ue),J=H.text.slice(ue+me.length);return q(q({},H),{},{text:U+J})}),r=!0;break}case"set_node":{var{path:Te,properties:Ne,newProperties:Ye}=t;if(Te.length===0)throw new Error("Cannot set properties on the root node!");kr(e,Te,H=>{var U=q({},H);for(var J in Ye){if(J==="children"||J==="text")throw new Error('Cannot set the "'.concat(J,'" property of nodes!'));var Ee=Ye[J];Ee==null?delete U[J]:U[J]=Ee}for(var ct in Ne)Ye.hasOwnProperty(ct)||delete U[ct];return U});break}case"set_selection":{var{newProperties:Se}=t;if(Se==null){e.selection=null;break}if(e.selection==null){if(!T.isRange(Se))throw new Error('Cannot apply an incomplete "set_selection" operation properties '.concat(ie.stringify(Se)," when there is no current selection."));e.selection=q({},Se);break}var ze=q({},e.selection);for(var Le in Se){var at=Se[Le];if(at==null){if(Le==="anchor"||Le==="focus")throw new Error('Cannot remove the "'.concat(Le,'" selection property'));delete ze[Le]}else ze[Le]=at}e.selection=ze;break}case"split_node":{var{path:z,position:lt,properties:Sr}=t,Lr=z[z.length-1];if(z.length===0)throw new Error('Cannot apply a "split_node" operation at path ['.concat(z,"] because the root node cannot be split."));Ue(e,w.parent(z),H=>{var U=H[Lr],J,Ee;if(G.isText(U)){var ct=U.text.slice(0,lt),qo=U.text.slice(lt);J=q(q({},U),{},{text:ct}),Ee=q(q({},Sr),{},{text:qo})}else{var Ko=U.children.slice(0,lt),$o=U.children.slice(lt);J=q(q({},U),{},{children:Ko}),Ee=q(q({},Sr),{},{children:$o})}return rt(H,Lr,1,J,Ee)}),r=!0;break}}if(r&&e.selection){var Ot=q({},e.selection);for(var[Uo,Wo]of T.points(Ot))Ot[Wo]=ee.transform(Uo,t);e.selection=Ot}}},Oa={insertNodes(e,t,r){e.insertNodes(t,r)},liftNodes(e,t){e.liftNodes(t)},mergeNodes(e,t){e.mergeNodes(t)},moveNodes(e,t){e.moveNodes(t)},removeNodes(e,t){e.removeNodes(t)},setNodes(e,t,r){e.setNodes(t,r)},splitNodes(e,t){e.splitNodes(t)},unsetNodes(e,t,r){e.unsetNodes(t,r)},unwrapNodes(e,t){e.unwrapNodes(t)},wrapNodes(e,t,r){e.wrapNodes(t,r)}},Ta={collapse(e,t){e.collapse(t)},deselect(e){e.deselect()},move(e,t){e.move(t)},select(e,t){e.select(t)},setPoint(e,t,r){e.setPoint(t,r)},setSelection(e,t){e.setSelection(t)}},ne=e=>typeof e=="object"&&e!==null,yo=(e,t)=>{for(var r in e){var n=e[r],o=t[r];if(Array.isArray(n)&&Array.isArray(o)){if(n.length!==o.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==o[i])return!1}else if(ne(n)&&ne(o)){if(!yo(n,o))return!1}else if(n!==o)return!1}for(var a in t)if(e[a]===void 0&&t[a]!==void 0)return!1;return!0};function Ma(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function nt(e,t){if(e==null)return{};var r=Ma(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Da=["anchor","focus"];function an(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _a(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?an(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):an(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var T={edges(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:r=!1}=t,{anchor:n,focus:o}=e;return T.isBackward(e)===r?[n,o]:[o,n]},end(e){var[,t]=T.edges(e);return t},equals(e,t){return ee.equals(e.anchor,t.anchor)&&ee.equals(e.focus,t.focus)},surrounds(e,t){var r=T.intersection(e,t);return r?T.equals(r,t):!1},includes(e,t){if(T.isRange(t)){if(T.includes(e,t.anchor)||T.includes(e,t.focus))return!0;var[r,n]=T.edges(e),[o,i]=T.edges(t);return ee.isBefore(r,o)&&ee.isAfter(n,i)}var[a,l]=T.edges(e),c=!1,u=!1;return ee.isPoint(t)?(c=ee.compare(t,a)>=0,u=ee.compare(t,l)<=0):(c=w.compare(t,a.path)>=0,u=w.compare(t,l.path)<=0),c&&u},intersection(e,t){var r=nt(e,Da),[n,o]=T.edges(e),[i,a]=T.edges(t),l=ee.isBefore(n,i)?i:n,c=ee.isBefore(o,a)?o:a;return ee.isBefore(c,l)?null:_a({anchor:l,focus:c},r)},isBackward(e){var{anchor:t,focus:r}=e;return ee.isAfter(t,r)},isCollapsed(e){var{anchor:t,focus:r}=e;return ee.equals(t,r)},isExpanded(e){return!T.isCollapsed(e)},isForward(e){return!T.isBackward(e)},isRange(e){return ne(e)&&ee.isPoint(e.anchor)&&ee.isPoint(e.focus)},*points(e){yield[e.anchor,"anchor"],yield[e.focus,"focus"]},start(e){var[t]=T.edges(e);return t},transform(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e===null)return null;var{affinity:n="inward"}=r,o,i;if(n==="inward"){var a=T.isCollapsed(e);T.isForward(e)?(o="forward",i=a?o:"backward"):(o="backward",i=a?o:"forward")}else n==="outward"?T.isForward(e)?(o="backward",i="forward"):(o="forward",i="backward"):(o=n,i=n);var l=ee.transform(e.anchor,t,{affinity:o}),c=ee.transform(e.focus,t,{affinity:i});return!l||!c?null:{anchor:l,focus:c}}},ln=function(t){var{deep:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ne(t))return!1;var n=typeof t.apply=="function";if(n)return!1;var o=r?M.isNodeList(t.children):Array.isArray(t.children);return o},Pe={isAncestor(e){var{deep:t=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ne(e)&&M.isNodeList(e.children,{deep:t})},isElement:ln,isElementList(e){var{deep:t=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Array.isArray(e)&&e.every(r=>Pe.isElement(r,{deep:t}))},isElementProps(e){return e.children!==void 0},isElementType:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"type";return ln(t)&&t[n]===r},matches(e,t){for(var r in t)if(r!=="children"&&e[r]!==t[r])return!1;return!0}},Ba=["children"],Fa=["text"],M={ancestor(e,t){var r=M.get(e,t);if(G.isText(r))throw new Error("Cannot get the ancestor node at path [".concat(t,"] because it refers to a text node instead: ").concat(ie.stringify(r)));return r},ancestors(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var n of w.ancestors(t,r)){var o=M.ancestor(e,n),i=[o,n];yield i}}()},child(e,t){if(G.isText(e))throw new Error("Cannot get the child of a text node: ".concat(ie.stringify(e)));var r=e.children[t];if(r==null)throw new Error("Cannot get child at index `".concat(t,"` in node: ").concat(ie.stringify(e)));return r},children(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var{reverse:n=!1}=r,o=M.ancestor(e,t),{children:i}=o,a=n?i.length-1:0;n?a>=0:a<i.length;){var l=M.child(o,a),c=t.concat(a);yield[l,c],a=n?a-1:a+1}}()},common(e,t,r){var n=w.common(t,r),o=M.get(e,n);return[o,n]},descendant(e,t){var r=M.get(e,t);if(R.isEditor(r))throw new Error("Cannot get the descendant node at path [".concat(t,"] because it refers to the root editor node instead: ").concat(ie.stringify(r)));return r},descendants(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[r,n]of M.nodes(e,t))n.length!==0&&(yield[r,n])}()},elements(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[r,n]of M.nodes(e,t))Pe.isElement(r)&&(yield[r,n])}()},extractProps(e){if(Pe.isAncestor(e)){var t=nt(e,Ba);return t}else{var t=nt(e,Fa);return t}},first(e,t){for(var r=t.slice(),n=M.get(e,r);n&&!(G.isText(n)||n.children.length===0);)n=n.children[0],r.push(0);return[n,r]},fragment(e,t){if(G.isText(e))throw new Error("Cannot get a fragment starting from a root text node: ".concat(ie.stringify(e)));var r=ka({children:e.children},n=>{var[o,i]=T.edges(t),a=M.nodes(n,{reverse:!0,pass:f=>{var[,g]=f;return!T.includes(t,g)}});for(var[,l]of a){if(!T.includes(t,l)){var c=M.parent(n,l),u=l[l.length-1];c.children.splice(u,1)}if(w.equals(l,i.path)){var d=M.leaf(n,l);d.text=d.text.slice(0,i.offset)}if(w.equals(l,o.path)){var h=M.leaf(n,l);h.text=h.text.slice(o.offset)}}R.isEditor(n)&&(n.selection=null)});return r.children},get(e,t){var r=M.getIf(e,t);if(r===void 0)throw new Error("Cannot find a descendant at path [".concat(t,"] in node: ").concat(ie.stringify(e)));return r},getIf(e,t){for(var r=e,n=0;n<t.length;n++){var o=t[n];if(G.isText(r)||!r.children[o])return;r=r.children[o]}return r},has(e,t){for(var r=e,n=0;n<t.length;n++){var o=t[n];if(G.isText(r)||!r.children[o])return!1;r=r.children[o]}return!0},isNode(e){var{deep:t=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return G.isText(e)||Pe.isElement(e,{deep:t})||R.isEditor(e,{deep:t})},isNodeList(e){var{deep:t=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Array.isArray(e)&&e.every(r=>M.isNode(r,{deep:t}))},last(e,t){for(var r=t.slice(),n=M.get(e,r);n&&!(G.isText(n)||n.children.length===0);){var o=n.children.length-1;n=n.children[o],r.push(o)}return[n,r]},leaf(e,t){var r=M.get(e,t);if(!G.isText(r))throw new Error("Cannot get the leaf node at path [".concat(t,"] because it refers to a non-leaf node: ").concat(ie.stringify(r)));return r},levels(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var n of w.levels(t,r)){var o=M.get(e,n);yield[o,n]}}()},matches(e,t){return Pe.isElement(e)&&Pe.isElementProps(t)&&Pe.matches(e,t)||G.isText(e)&&G.isTextProps(t)&&G.matches(e,t)},nodes(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var{pass:r,reverse:n=!1}=t,{from:o=[],to:i}=t,a=new Set,l=[],c=e;!(i&&(n?w.isBefore(l,i):w.isAfter(l,i)));){if(a.has(c)||(yield[c,l]),!a.has(c)&&!G.isText(c)&&c.children.length!==0&&(r==null||r([c,l])===!1)){a.add(c);var u=n?c.children.length-1:0;w.isAncestor(l,o)&&(u=o[l.length]),l=l.concat(u),c=M.get(e,l);continue}if(l.length===0)break;if(!n){var d=w.next(l);if(M.has(e,d)){l=d,c=M.get(e,l);continue}}if(n&&l[l.length-1]!==0){var h=w.previous(l);l=h,c=M.get(e,l);continue}l=w.parent(l),c=M.get(e,l),a.add(c)}}()},parent(e,t){var r=w.parent(t),n=M.get(e,r);if(G.isText(n))throw new Error("Cannot get the parent of path [".concat(t,"] because it does not exist in the root."));return n},string(e){return G.isText(e)?e.text:e.children.map(M.string).join("")},texts(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[r,n]of M.nodes(e,t))G.isText(r)&&(yield[r,n])}()}};function cn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cn(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Xe={isNodeOperation(e){return Xe.isOperation(e)&&e.type.endsWith("_node")},isOperation(e){if(!ne(e))return!1;switch(e.type){case"insert_node":return w.isPath(e.path)&&M.isNode(e.node);case"insert_text":return typeof e.offset=="number"&&typeof e.text=="string"&&w.isPath(e.path);case"merge_node":return typeof e.position=="number"&&w.isPath(e.path)&&ne(e.properties);case"move_node":return w.isPath(e.path)&&w.isPath(e.newPath);case"remove_node":return w.isPath(e.path)&&M.isNode(e.node);case"remove_text":return typeof e.offset=="number"&&typeof e.text=="string"&&w.isPath(e.path);case"set_node":return w.isPath(e.path)&&ne(e.properties)&&ne(e.newProperties);case"set_selection":return e.properties===null&&T.isRange(e.newProperties)||e.newProperties===null&&T.isRange(e.properties)||ne(e.properties)&&ne(e.newProperties);case"split_node":return w.isPath(e.path)&&typeof e.position=="number"&&ne(e.properties);default:return!1}},isOperationList(e){return Array.isArray(e)&&e.every(t=>Xe.isOperation(t))},isSelectionOperation(e){return Xe.isOperation(e)&&e.type.endsWith("_selection")},isTextOperation(e){return Xe.isOperation(e)&&e.type.endsWith("_text")},inverse(e){switch(e.type){case"insert_node":return $($({},e),{},{type:"remove_node"});case"insert_text":return $($({},e),{},{type:"remove_text"});case"merge_node":return $($({},e),{},{type:"split_node",path:w.previous(e.path)});case"move_node":{var{newPath:t,path:r}=e;if(w.equals(t,r))return e;if(w.isSibling(r,t))return $($({},e),{},{path:t,newPath:r});var n=w.transform(r,e),o=w.transform(w.next(r),e);return $($({},e),{},{path:n,newPath:o})}case"remove_node":return $($({},e),{},{type:"insert_node"});case"remove_text":return $($({},e),{},{type:"insert_text"});case"set_node":{var{properties:i,newProperties:a}=e;return $($({},e),{},{properties:a,newProperties:i})}case"set_selection":{var{properties:l,newProperties:c}=e;return l==null?$($({},e),{},{properties:c,newProperties:null}):c==null?$($({},e),{},{properties:null,newProperties:l}):$($({},e),{},{properties:c,newProperties:l})}case"split_node":return $($({},e),{},{type:"merge_node",path:w.next(e.path)})}}},Aa=function(t){var{deep:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ne(t))return!1;var n=typeof t.addMark=="function"&&typeof t.apply=="function"&&typeof t.deleteFragment=="function"&&typeof t.insertBreak=="function"&&typeof t.insertSoftBreak=="function"&&typeof t.insertFragment=="function"&&typeof t.insertNode=="function"&&typeof t.insertText=="function"&&typeof t.isElementReadOnly=="function"&&typeof t.isInline=="function"&&typeof t.isSelectable=="function"&&typeof t.isVoid=="function"&&typeof t.normalizeNode=="function"&&typeof t.onChange=="function"&&typeof t.removeMark=="function"&&typeof t.getDirtyPaths=="function"&&(t.marks===null||ne(t.marks))&&(t.selection===null||T.isRange(t.selection))&&(!r||M.isNodeList(t.children))&&Xe.isOperationList(t.operations);return n},R={above(e,t){return e.above(t)},addMark(e,t,r){e.addMark(t,r)},after(e,t,r){return e.after(t,r)},before(e,t,r){return e.before(t,r)},deleteBackward(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{unit:r="character"}=t;e.deleteBackward(r)},deleteForward(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{unit:r="character"}=t;e.deleteForward(r)},deleteFragment(e,t){e.deleteFragment(t)},edges(e,t){return e.edges(t)},elementReadOnly(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.elementReadOnly(t)},end(e,t){return e.end(t)},first(e,t){return e.first(t)},fragment(e,t){return e.fragment(t)},hasBlocks(e,t){return e.hasBlocks(t)},hasInlines(e,t){return e.hasInlines(t)},hasPath(e,t){return e.hasPath(t)},hasTexts(e,t){return e.hasTexts(t)},insertBreak(e){e.insertBreak()},insertFragment(e,t,r){e.insertFragment(t,r)},insertNode(e,t){e.insertNode(t)},insertSoftBreak(e){e.insertSoftBreak()},insertText(e,t){e.insertText(t)},isBlock(e,t){return e.isBlock(t)},isEdge(e,t,r){return e.isEdge(t,r)},isEditor(e){return Aa(e)},isElementReadOnly(e,t){return e.isElementReadOnly(t)},isEmpty(e,t){return e.isEmpty(t)},isEnd(e,t,r){return e.isEnd(t,r)},isInline(e,t){return e.isInline(t)},isNormalizing(e){return e.isNormalizing()},isSelectable(e,t){return e.isSelectable(t)},isStart(e,t,r){return e.isStart(t,r)},isVoid(e,t){return e.isVoid(t)},last(e,t){return e.last(t)},leaf(e,t,r){return e.leaf(t,r)},levels(e,t){return e.levels(t)},marks(e){return e.getMarks()},next(e,t){return e.next(t)},node(e,t,r){return e.node(t,r)},nodes(e,t){return e.nodes(t)},normalize(e,t){e.normalize(t)},parent(e,t,r){return e.parent(t,r)},path(e,t,r){return e.path(t,r)},pathRef(e,t,r){return e.pathRef(t,r)},pathRefs(e){return e.pathRefs()},point(e,t,r){return e.point(t,r)},pointRef(e,t,r){return e.pointRef(t,r)},pointRefs(e){return e.pointRefs()},positions(e,t){return e.positions(t)},previous(e,t){return e.previous(t)},range(e,t,r){return e.range(t,r)},rangeRef(e,t,r){return e.rangeRef(t,r)},rangeRefs(e){return e.rangeRefs()},removeMark(e,t){e.removeMark(t)},setNormalizing(e,t){e.setNormalizing(t)},start(e,t){return e.start(t)},string(e,t,r){return e.string(t,r)},unhangRange(e,t,r){return e.unhangRange(t,r)},void(e,t){return e.void(t)},withoutNormalizing(e,t){e.withoutNormalizing(t)},shouldMergeNodesRemovePrevNode:(e,t,r)=>e.shouldMergeNodesRemovePrevNode(t,r)};function un(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?un(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):un(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ee={compare(e,t){var r=w.compare(e.path,t.path);return r===0?e.offset<t.offset?-1:e.offset>t.offset?1:0:r},isAfter(e,t){return ee.compare(e,t)===1},isBefore(e,t){return ee.compare(e,t)===-1},equals(e,t){return e.offset===t.offset&&w.equals(e.path,t.path)},isPoint(e){return ne(e)&&typeof e.offset=="number"&&w.isPath(e.path)},transform(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e===null)return null;var{affinity:n="forward"}=r,{path:o,offset:i}=e;switch(t.type){case"insert_node":case"move_node":{o=w.transform(o,t,r);break}case"insert_text":{w.equals(t.path,o)&&(t.offset<i||t.offset===i&&n==="forward")&&(i+=t.text.length);break}case"merge_node":{w.equals(t.path,o)&&(i+=t.position),o=w.transform(o,t,r);break}case"remove_text":{w.equals(t.path,o)&&t.offset<=i&&(i-=Math.min(i-t.offset,t.text.length));break}case"remove_node":{if(w.equals(t.path,o)||w.isAncestor(t.path,o))return null;o=w.transform(o,t,r);break}case"split_node":{if(w.equals(t.path,o)){if(t.position===i&&n==null)return null;(t.position<i||t.position===i&&n==="forward")&&(i-=t.position,o=w.transform(o,t,dn(dn({},r),{},{affinity:"forward"})))}else o=w.transform(o,t,r);break}default:return e}return{path:o,offset:i}}},fn=void 0,ie={setScrubber(e){fn=e},stringify(e){return JSON.stringify(e,fn)}},Ia=["text"],Ra=["anchor","focus","merge"];function hn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hn(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var G={equals(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},{loose:n=!1}=r;function o(i){var a=nt(i,Ia);return a}return yo(n?o(e):e,n?o(t):t)},isText(e){return ne(e)&&typeof e.text=="string"},isTextList(e){return Array.isArray(e)&&e.every(t=>G.isText(t))},isTextProps(e){return e.text!==void 0},matches(e,t){for(var r in t)if(r!=="text"&&(!e.hasOwnProperty(r)||e[r]!==t[r]))return!1;return!0},decorations(e,t){var r=[{leaf:ke({},e)}];for(var n of t){var{anchor:o,focus:i,merge:a}=n,l=nt(n,Ra),[c,u]=T.edges(n),d=[],h=0,f=c.offset,g=u.offset,y=a??Object.assign;for(var{leaf:v}of r){var{length:x}=v.text,p=h;if(h+=x,f<=p&&h<=g){y(v,l),d.push({leaf:v});continue}if(f!==g&&(f===h||g===p)||f>h||g<p||g===p&&p!==0){d.push({leaf:v});continue}var b=v,C=void 0,k=void 0;if(g<h){var L=g-p;k={leaf:ke(ke({},b),{},{text:b.text.slice(L)})},b=ke(ke({},b),{},{text:b.text.slice(0,L)})}if(f>p){var _=f-p;C={leaf:ke(ke({},b),{},{text:b.text.slice(0,_)})},b=ke(ke({},b),{},{text:b.text.slice(_)})}y(b,l),C&&d.push(C),d.push({leaf:b}),k&&d.push(k)}r=d}if(r.length>1){var Y=0;for(var[B,Q]of r.entries()){var ae=Y,re=ae+Q.leaf.text.length,X={start:ae,end:re};B===0&&(X.isFirst=!0),B===r.length-1&&(X.isLast=!0),Q.position=X,Y=re}}return r}},Na=e=>e.selection?e.selection:e.children.length>0?R.end(e,[]):[0],W;(function(e){e[e.None=0]="None",e[e.Extend=1]="Extend",e[e.ZWJ=2]="ZWJ",e[e.RI=4]="RI",e[e.Prepend=8]="Prepend",e[e.SpacingMark=16]="SpacingMark",e[e.L=32]="L",e[e.V=64]="V",e[e.T=128]="T",e[e.LV=256]="LV",e[e.LVT=512]="LVT",e[e.ExtPict=1024]="ExtPict",e[e.Any=2048]="Any"})(W||(W={}));W.L,W.L|W.V|W.LV|W.LVT,W.LV|W.V,W.V|W.T,W.LVT|W.T,W.T,W.Any,W.Extend|W.ZWJ,W.Any,W.SpacingMark,W.Prepend,W.Any,W.ZWJ,W.ExtPict,W.RI,W.RI;var za={delete(e,t){e.delete(t)},insertFragment(e,t,r){e.insertFragment(t,r)},insertText(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};R.withoutNormalizing(e,()=>{var{voids:n=!1}=r,{at:o=Na(e)}=r;if(w.isPath(o)&&(o=R.range(e,o)),T.isRange(o))if(T.isCollapsed(o))o=o.anchor;else{var i=T.end(o);if(!n&&R.void(e,{at:i}))return;var a=T.start(o),l=R.pointRef(e,a),c=R.pointRef(e,i);Be.delete(e,{at:o,voids:n});var u=l.unref(),d=c.unref();o=u||d,Be.setSelection(e,{anchor:o,focus:o})}if(!(!n&&R.void(e,{at:o})||R.elementReadOnly(e,{at:o}))){var{path:h,offset:f}=o;t.length>0&&e.apply({type:"insert_text",path:h,offset:f,text:t})}})}};function mn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mn(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mn(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Be=dt(dt(dt(dt({},La),Oa),Ta),za),we={},gn;function Ha(){if(gn)return we;gn=1,Object.defineProperty(we,"__esModule",{value:!0});for(var e=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),t={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},r={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:e?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},n={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},o=1;o<20;o++)n["f"+o]=111+o;function i(f,g,y){g&&!("byKey"in g)&&(y=g,g=null),Array.isArray(f)||(f=[f]);var v=f.map(function(b){return c(b,g)}),x=function(C){return v.some(function(k){return u(k,C)})},p=y==null?x:x(y);return p}function a(f,g){return i(f,g)}function l(f,g){return i(f,{byKey:!0},g)}function c(f,g){var y=g&&g.byKey,v={};f=f.replace("++","+add");var x=f.split("+"),p=x.length;for(var b in t)v[t[b]]=!1;var C=!0,k=!1,L=void 0;try{for(var _=x[Symbol.iterator](),Y;!(C=(Y=_.next()).done);C=!0){var B=Y.value,Q=B.endsWith("?")&&B.length>1;Q&&(B=B.slice(0,-1));var ae=h(B),re=t[ae];if(B.length>1&&!re&&!r[B]&&!n[ae])throw new TypeError('Unknown modifier: "'+B+'"');(p===1||!re)&&(y?v.key=ae:v.which=d(B)),re&&(v[re]=Q?null:!0)}}catch(X){k=!0,L=X}finally{try{!C&&_.return&&_.return()}finally{if(k)throw L}}return v}function u(f,g){for(var y in f){var v=f[y],x=void 0;if(v!=null&&(y==="key"&&g.key!=null?x=g.key.toLowerCase():y==="which"?x=v===91&&g.which===93?91:g.which:x=g[y],!(x==null&&v===!1)&&x!==v))return!1}return!0}function d(f){f=h(f);var g=n[f]||f.toUpperCase().charCodeAt(0);return g}function h(f){return f=f.toLowerCase(),f=r[f]||f,f}return we.default=i,we.isHotkey=i,we.isCodeHotkey=a,we.isKeyHotkey=l,we.parseHotkey=c,we.compareHotkey=u,we.toKeyCode=d,we.toKeyName=h,we}var ye=Ha(),xo=globalThis.Node,Ua=globalThis.Text,Co=e=>e&&e.ownerDocument&&e.ownerDocument.defaultView||null,Wa=e=>Ct(e)&&e.nodeType===8,je=e=>Ct(e)&&e.nodeType===1,Ct=e=>{var t=Co(e);return!!t&&e instanceof t.Node},pn=e=>{var t=e&&e.anchorNode&&Co(e.anchorNode);return!!t&&e instanceof t.Selection},qa=e=>{var[t,r]=e;if(je(t)&&t.childNodes.length){var n=r===t.childNodes.length,o=n?r-1:r;for([t,o]=bo(t,o,n?"backward":"forward"),n=o<r;je(t)&&t.childNodes.length;){var i=n?t.childNodes.length-1:0;t=$a(t,i,n?"backward":"forward")}r=n&&t.textContent!=null?t.textContent.length:0}return[t,r]},Ka=e=>{for(var t=e&&e.parentNode;t;){if(t.toString()==="[object ShadowRoot]")return!0;t=t.parentNode}return!1},bo=(e,t,r)=>{for(var{childNodes:n}=e,o=n[t],i=t,a=!1,l=!1;(Wa(o)||je(o)&&o.childNodes.length===0||je(o)&&o.getAttribute("contenteditable")==="false")&&!(a&&l);){if(i>=n.length){a=!0,i=t-1,r="backward";continue}if(i<0){l=!0,i=t+1,r="forward";continue}o=n[i],t=i,i+=r==="forward"?1:-1}return[o,t]},$a=(e,t,r)=>{var[n]=bo(e,t,r);return n},vn=e=>e.getSelection!=null?e.getSelection():document.getSelection(),Eo=(e,t,r)=>{var{target:n}=t;if(je(n)&&n.matches('[contentEditable="false"]'))return!1;var{document:o}=O.getWindow(e);if(o.contains(n))return O.hasDOMNode(e,n,{editable:!0});var i=r.find(a=>{var{addedNodes:l,removedNodes:c}=a;for(var u of l)if(u===n||u.contains(n))return!0;for(var d of c)if(d===n||d.contains(n))return!0});return!i||i===t?!1:Eo(e,i,r)},wn=(e,t)=>!!(e.compareDocumentPosition(t)&xo.DOCUMENT_POSITION_PRECEDING),Va=(e,t)=>!!(e.compareDocumentPosition(t)&xo.DOCUMENT_POSITION_FOLLOWING),Gt,Zt,yn=typeof navigator<"u"&&/Mac OS X/.test(navigator.userAgent),Yt=typeof navigator<"u"&&/Android/.test(navigator.userAgent),ft=typeof navigator<"u"&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),Ga=typeof navigator<"u"&&/Chrome/i.test(navigator.userAgent);typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&/Version\/(\d+)/.test(navigator.userAgent)&&((Gt=navigator.userAgent.match(/Version\/(\d+)/))!==null&&Gt!==void 0&&Gt[1]&&parseInt((Zt=navigator.userAgent.match(/Version\/(\d+)/))===null||Zt===void 0?void 0:Zt[1],10)<17);function ot(e){"@babel/helpers - typeof";return ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(e)}function Za(e,t){if(ot(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ot(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ya(e){var t=Za(e,"string");return ot(t)==="symbol"?t:String(t)}function Xa(e,t,r){return t=Ya(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ja=0;class Qa{constructor(){Xa(this,"id",void 0),this.id="".concat(Ja++)}}var el=new WeakMap,tl=new WeakMap,rl=new WeakMap,nl=new WeakMap,ol=new WeakMap,xn=new WeakMap,il=new WeakMap,Cn=new WeakMap,ht=new WeakMap,sl=new WeakMap,al=new WeakMap,ll=new WeakMap,O={androidPendingDiffs:e=>ll.get(e),androidScheduleFlush:e=>{var t;(t=al.get(e))===null||t===void 0||t()},blur:e=>{var t=O.toDOMNode(e,e),r=O.findDocumentOrShadowRoot(e);ht.set(e,!1),r.activeElement===t&&t.blur()},deselect:e=>{var{selection:t}=e,r=O.findDocumentOrShadowRoot(e),n=vn(r);n&&n.rangeCount>0&&n.removeAllRanges(),t&&Be.deselect(e)},findDocumentOrShadowRoot:e=>{var t=O.toDOMNode(e,e),r=t.getRootNode();return r instanceof Document||r instanceof ShadowRoot?r:t.ownerDocument},findEventRange:(e,t)=>{"nativeEvent"in t&&(t=t.nativeEvent);var{clientX:r,clientY:n,target:o}=t;if(r==null||n==null)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));var i=O.toSlateNode(e,t.target),a=O.findPath(e,i);if(Pe.isElement(i)&&R.isVoid(e,i)){var l=o.getBoundingClientRect(),c=e.isInline(i)?r-l.left<l.left+l.width-r:n-l.top<l.top+l.height-n,u=R.point(e,a,{edge:c?"start":"end"}),d=c?R.before(e,u):R.after(e,u);if(d){var h=R.range(e,d);return h}}var f,{document:g}=O.getWindow(e);if(g.caretRangeFromPoint)f=g.caretRangeFromPoint(r,n);else{var y=g.caretPositionFromPoint(r,n);y&&(f=g.createRange(),f.setStart(y.offsetNode,y.offset),f.setEnd(y.offsetNode,y.offset))}if(!f)throw new Error("Cannot resolve a Slate range from a DOM event: ".concat(t));var v=O.toSlateRange(e,f,{exactMatch:!1,suppressThrow:!1});return v},findKey:(e,t)=>{var r=xn.get(t);return r||(r=new Qa,xn.set(t,r)),r},findPath:(e,t)=>{for(var r=[],n=t;;){var o=tl.get(n);if(o==null){if(R.isEditor(n))return r;break}var i=el.get(n);if(i==null)break;r.unshift(i),n=o}throw new Error("Unable to find the path for Slate node: ".concat(ie.stringify(t)))},focus:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{retries:5};if(!ht.get(t)){if(r.retries<=0)throw new Error("Could not set focus, editor seems stuck with pending operations");if(t.operations.length>0){setTimeout(()=>{O.focus(t,{retries:r.retries-1})},10);return}var n=O.toDOMNode(t,t),o=O.findDocumentOrShadowRoot(t);if(o.activeElement!==n){if(t.selection&&o instanceof Document){var i=vn(o),a=O.toDOMRange(t,t.selection);i==null||i.removeAllRanges(),i==null||i.addRange(a)}t.selection||Be.select(t,R.start(t,[])),ht.set(t,!0),n.focus({preventScroll:!0})}}},getWindow:e=>{var t=rl.get(e);if(!t)throw new Error("Unable to find a host window element for this editor");return t},hasDOMNode:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},{editable:o=!1}=n,i=O.toDOMNode(t,t),a;try{a=je(r)?r:r.parentElement}catch(l){if(l instanceof Error&&!l.message.includes('Permission denied to access property "nodeType"'))throw l}return a?a.closest("[data-slate-editor]")===i&&(!o||a.isContentEditable?!0:typeof a.isContentEditable=="boolean"&&a.closest('[contenteditable="false"]')===i||!!a.getAttribute("data-slate-zero-width")):!1},hasEditableTarget:(e,t)=>Ct(t)&&O.hasDOMNode(e,t,{editable:!0}),hasRange:(e,t)=>{var{anchor:r,focus:n}=t;return R.hasPath(e,r.path)&&R.hasPath(e,n.path)},hasSelectableTarget:(e,t)=>O.hasEditableTarget(e,t)||O.isTargetInsideNonReadonlyVoid(e,t),hasTarget:(e,t)=>Ct(t)&&O.hasDOMNode(e,t),insertData:(e,t)=>{e.insertData(t)},insertFragmentData:(e,t)=>e.insertFragmentData(t),insertTextData:(e,t)=>e.insertTextData(t),isComposing:e=>!!sl.get(e),isFocused:e=>!!ht.get(e),isReadOnly:e=>!!Cn.get(e),isTargetInsideNonReadonlyVoid:(e,t)=>{if(Cn.get(e))return!1;var r=O.hasTarget(e,t)&&O.toSlateNode(e,t);return Pe.isElement(r)&&R.isVoid(e,r)},setFragmentData:(e,t,r)=>e.setFragmentData(t,r),toDOMNode:(e,t)=>{var r=il.get(e),n=R.isEditor(t)?nl.get(e):r==null?void 0:r.get(O.findKey(e,t));if(!n)throw new Error("Cannot resolve a DOM node from Slate node: ".concat(ie.stringify(t)));return n},toDOMPoint:(e,t)=>{var[r]=R.node(e,t.path),n=O.toDOMNode(e,r),o;R.void(e,{at:t})&&(t={path:t.path,offset:0});for(var i="[data-slate-string], [data-slate-zero-width]",a=Array.from(n.querySelectorAll(i)),l=0,c=0;c<a.length;c++){var u=a[c],d=u.childNodes[0];if(!(d==null||d.textContent==null)){var{length:h}=d.textContent,f=u.getAttribute("data-slate-length"),g=f==null?h:parseInt(f,10),y=l+g,v=a[c+1];if(t.offset===y&&v!==null&&v!==void 0&&v.hasAttribute("data-slate-mark-placeholder")){var x,p=v.childNodes[0];o=[p instanceof Ua?p:v,(x=v.textContent)!==null&&x!==void 0&&x.startsWith("\uFEFF")?1:0];break}if(t.offset<=y){var b=Math.min(h,Math.max(0,t.offset-l));o=[d,b];break}l=y}}if(!o)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(ie.stringify(t)));return o},toDOMRange:(e,t)=>{var{anchor:r,focus:n}=t,o=T.isBackward(t),i=O.toDOMPoint(e,r),a=T.isCollapsed(t)?i:O.toDOMPoint(e,n),l=O.getWindow(e),c=l.document.createRange(),[u,d]=o?a:i,[h,f]=o?i:a,g=je(u)?u:u.parentElement,y=!!g.getAttribute("data-slate-zero-width"),v=je(h)?h:h.parentElement,x=!!v.getAttribute("data-slate-zero-width");return c.setStart(u,y?1:d),c.setEnd(h,x?1:f),c},toSlateNode:(e,t)=>{var r=je(t)?t:t.parentElement;r&&!r.hasAttribute("data-slate-node")&&(r=r.closest("[data-slate-node]"));var n=r?ol.get(r):null;if(!n)throw new Error("Cannot resolve a Slate node from DOM node: ".concat(r));return n},toSlatePoint:(e,t,r)=>{var{exactMatch:n,suppressThrow:o,searchDirection:i="backward"}=r,[a,l]=n?t:qa(t),c=a.parentNode,u=null,d=0;if(c){var h,f,g=O.toDOMNode(e,e),y=c.closest('[data-slate-void="true"]'),v=y&&g.contains(y)?y:null,x=c.closest('[contenteditable="false"]'),p=x&&g.contains(x)?x:null,b=c.closest("[data-slate-leaf]"),C=null;if(b){if(u=b.closest('[data-slate-node="text"]'),u){var k=O.getWindow(e),L=k.document.createRange();L.setStart(u,0),L.setEnd(a,l);var _=L.cloneContents(),Y=[...Array.prototype.slice.call(_.querySelectorAll("[data-slate-zero-width]")),...Array.prototype.slice.call(_.querySelectorAll("[contenteditable=false]"))];Y.forEach(z=>{if(Yt&&!n&&z.hasAttribute("data-slate-zero-width")&&z.textContent.length>0&&z.textContext!=="\uFEFF"){z.textContent.startsWith("\uFEFF")&&(z.textContent=z.textContent.slice(1));return}z.parentNode.removeChild(z)}),d=_.textContent.length,C=u}}else if(v){for(var B=v.querySelectorAll("[data-slate-leaf]"),Q=0;Q<B.length;Q++){var ae=B[Q];if(O.hasDOMNode(e,ae)){b=ae;break}}b?(u=b.closest('[data-slate-node="text"]'),C=b,d=C.textContent.length,C.querySelectorAll("[data-slate-zero-width]").forEach(z=>{d-=z.textContent.length})):d=1}else if(p){var re=z=>z?z.querySelectorAll("[data-slate-leaf]:not(:scope [data-slate-editor] [data-slate-leaf])"):[],X=p.closest('[data-slate-node="element"]');if(i==="forward"){var N,ue=[...re(X),...re(X==null?void 0:X.nextElementSibling)];b=(N=ue.find(z=>Va(p,z)))!==null&&N!==void 0?N:null}else{var me,Te=[...re(X==null?void 0:X.previousElementSibling),...re(X)];b=(me=Te.findLast(z=>wn(p,z)))!==null&&me!==void 0?me:null}b&&(u=b.closest('[data-slate-node="text"]'),C=b,i==="forward"?d=0:(d=C.textContent.length,C.querySelectorAll("[data-slate-zero-width]").forEach(z=>{d-=z.textContent.length})))}C&&d===C.textContent.length&&Yt&&C.getAttribute("data-slate-zero-width")==="z"&&(h=C.textContent)!==null&&h!==void 0&&h.startsWith("\uFEFF")&&(c.hasAttribute("data-slate-zero-width")||ft&&(f=C.textContent)!==null&&f!==void 0&&f.endsWith(`

`))&&d--}if(Yt&&!u&&!n){var Ne=c.hasAttribute("data-slate-node")?c:c.closest("[data-slate-node]");if(Ne&&O.hasDOMNode(e,Ne,{editable:!0})){var Ye=O.toSlateNode(e,Ne),{path:Se,offset:ze}=R.start(e,O.findPath(e,Ye));return Ne.querySelector("[data-slate-leaf]")||(ze=l),{path:Se,offset:ze}}}if(!u){if(o)return null;throw new Error("Cannot resolve a Slate point from DOM point: ".concat(t))}var Le=O.toSlateNode(e,u),at=O.findPath(e,Le);return{path:at,offset:d}},toSlateRange:(e,t,r)=>{var n,{exactMatch:o,suppressThrow:i}=r,a=pn(t)?t.anchorNode:t.startContainer,l,c,u,d,h;if(a)if(pn(t)){if(ft&&t.rangeCount>1){u=t.focusNode;var f=t.getRangeAt(0),g=t.getRangeAt(t.rangeCount-1);if(u instanceof HTMLTableRowElement&&f.startContainer instanceof HTMLTableRowElement&&g.startContainer instanceof HTMLTableRowElement){let _=function(Y){return Y.childElementCount>0?_(Y.children[0]):Y};var y=f.startContainer,v=g.startContainer,x=_(y.children[f.startOffset]),p=_(v.children[g.startOffset]);d=0,p.childNodes.length>0?l=p.childNodes[0]:l=p,x.childNodes.length>0?u=x.childNodes[0]:u=x,p instanceof HTMLElement?c=p.innerHTML.length:c=0}else f.startContainer===u?(l=g.endContainer,c=g.endOffset,d=f.startOffset):(l=f.startContainer,c=f.endOffset,d=g.startOffset)}else l=t.anchorNode,c=t.anchorOffset,u=t.focusNode,d=t.focusOffset;Ga&&Ka(l)||ft?h=t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset:h=t.isCollapsed}else l=t.startContainer,c=t.startOffset,u=t.endContainer,d=t.endOffset,h=t.collapsed;if(l==null||u==null||c==null||d==null)throw new Error("Cannot resolve a Slate range from DOM range: ".concat(t));ft&&(n=u.textContent)!==null&&n!==void 0&&n.endsWith(`

`)&&d===u.textContent.length&&d--;var b=O.toSlatePoint(e,[l,c],{exactMatch:o,suppressThrow:i});if(!b)return null;var C=wn(l,u)||l===u&&d<c,k=h?b:O.toSlatePoint(e,[u,d],{exactMatch:o,suppressThrow:i,searchDirection:C?"forward":"backward"});if(!k)return null;var L={anchor:b,focus:k};return T.isExpanded(L)&&T.isForward(L)&&je(u)&&R.void(e,{at:L.focus,mode:"highest"})&&(L=R.unhangRange(e,L,{voids:!0})),L}},cl={bold:"mod+b",compose:["down","left","right","up","backspace","enter"],moveBackward:"left",moveForward:"right",moveWordBackward:"ctrl+left",moveWordForward:"ctrl+right",deleteBackward:"shift?+backspace",deleteForward:"shift?+delete",extendBackward:"shift+left",extendForward:"shift+right",italic:"mod+i",insertSoftBreak:"shift+enter",splitBlock:"enter",undo:"mod+z"},ul={moveLineBackward:"opt+up",moveLineForward:"opt+down",moveWordBackward:"opt+left",moveWordForward:"opt+right",deleteBackward:["ctrl+backspace","ctrl+h"],deleteForward:["ctrl+delete","ctrl+d"],deleteLineBackward:"cmd+shift?+backspace",deleteLineForward:["cmd+shift?+delete","ctrl+k"],deleteWordBackward:"opt+shift?+backspace",deleteWordForward:"opt+shift?+delete",extendLineBackward:"opt+shift+up",extendLineForward:"opt+shift+down",redo:"cmd+shift+z",transposeCharacter:"ctrl+t"},dl={deleteWordBackward:"ctrl+shift?+backspace",deleteWordForward:"ctrl+shift?+delete",redo:["ctrl+y","ctrl+shift+z"]},V=e=>{var t=cl[e],r=ul[e],n=dl[e],o=t&&ye.isHotkey(t),i=r&&ye.isHotkey(r),a=n&&ye.isHotkey(n);return l=>!!(o&&o(l)||yn&&i&&i(l)||!yn&&a&&a(l))};V("bold"),V("compose"),V("moveBackward"),V("moveForward"),V("deleteBackward"),V("deleteForward"),V("deleteLineBackward"),V("deleteLineForward"),V("deleteWordBackward"),V("deleteWordForward"),V("extendBackward"),V("extendForward"),V("extendLineBackward"),V("extendLineForward"),V("italic"),V("moveLineBackward"),V("moveLineForward"),V("moveWordBackward"),V("moveWordForward"),V("redo"),V("insertSoftBreak"),V("splitBlock"),V("transposeCharacter"),V("undo");var bn;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(bn||(bn={}));var Pr=function(e){return Object.freeze(e)},fl=function(){function e(t,r){this.inlineSize=t,this.blockSize=r,Pr(this)}return e}(),hl=function(){function e(t,r,n,o){return this.x=t,this.y=r,this.width=n,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Pr(this)}return e.prototype.toJSON=function(){var t=this,r=t.x,n=t.y,o=t.top,i=t.right,a=t.bottom,l=t.left,c=t.width,u=t.height;return{x:r,y:n,top:o,right:i,bottom:a,left:l,width:c,height:u}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),En=typeof window<"u"?window:{};/msie|trident/i.test(En.navigator&&En.navigator.userAgent);var Xt=function(e,t,r){return e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=!1),new fl((r?t:e)||0,(r?e:t)||0)};Pr({devicePixelContentBoxSize:Xt(),borderBoxSize:Xt(),contentBoxSize:Xt(),contentRect:new hl(0,0,0,0)});function it(e){"@babel/helpers - typeof";return it=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(e)}function ml(e,t){if(it(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(it(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gl(e){var t=ml(e,"string");return it(t)==="symbol"?t:String(t)}function gt(e,t,r){return t=gl(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pl=E.createContext(null),We=O,vl=(e,t)=>{var r=[],n=()=>{r=[]},o=a=>{if(t.current){var l=a.filter(c=>Eo(e,c,a));r.push(...l)}};function i(){r.length>0&&(r.reverse().forEach(a=>{a.type!=="characterData"&&(a.removedNodes.forEach(l=>{a.target.insertBefore(l,a.nextSibling)}),a.addedNodes.forEach(l=>{a.target.removeChild(l)}))}),n())}return{registerMutations:o,restoreDOM:i,clear:n}},wl={subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0};class yl extends E.Component{constructor(){super(...arguments),gt(this,"context",null),gt(this,"manager",null),gt(this,"mutationObserver",null)}observe(){var t,{node:r}=this.props;if(!r.current)throw new Error("Failed to attach MutationObserver, `node` is undefined");(t=this.mutationObserver)===null||t===void 0||t.observe(r.current,wl)}componentDidMount(){var{receivedUserInput:t}=this.props,r=this.context;this.manager=vl(r,t),this.mutationObserver=new MutationObserver(this.manager.registerMutations),this.observe()}getSnapshotBeforeUpdate(){var t,r,n,o=(t=this.mutationObserver)===null||t===void 0?void 0:t.takeRecords();if(o!=null&&o.length){var i;(i=this.manager)===null||i===void 0||i.registerMutations(o)}return(r=this.mutationObserver)===null||r===void 0||r.disconnect(),(n=this.manager)===null||n===void 0||n.restoreDOM(),null}componentDidUpdate(){var t;(t=this.manager)===null||t===void 0||t.clear(),this.observe()}componentWillUnmount(){var t;(t=this.mutationObserver)===null||t===void 0||t.disconnect()}render(){return this.props.children}}gt(yl,"contextType",pl);parseInt(E.version.split(".")[0],10);const xl=({board:e,title:t})=>{const{appState:r,setAppState:n}=ve();return s.jsx(A,{className:D("property-button"),visible:!0,icon:Ss,type:"button",title:t,"aria-label":t,onPointerUp:()=>{const o=m.getSelectedElements(e)[0],i=P.getFirstTextEditor(o);pe.LinkEditor.getLinkElement(i)||pe.LinkEditor.wrapLink(i,"链接",""),setTimeout(()=>{const c=pe.LinkEditor.getLinkElement(i)[0],u=We.toDOMNode(i,c);n({...r,linkState:{editor:i,targetDom:u,targetElement:c,isEditing:!0,isHovering:!1,isHoveringOrigin:!1}})},0)}})},Cl=({end:e,property:t})=>{const r=Z.useBoard(),{marker:n}=t,{t:o}=te(),i=a=>{P.PropertyTransforms.setProperty(r,{[e]:{...t,marker:a}})};return s.jsx(ce,{padding:2,className:D(`${m.ATTACHED_ELEMENT_CLASS_NAME} ${e==="source"?"source-arrow-island":""} `),children:s.jsxs(oe.Row,{gap:1,children:[s.jsx(A,{className:D("property-button"),visible:!0,icon:Kn,type:"button",title:o("line.none"),"aria-label":o("line.none"),selected:n==="none",onPointerUp:()=>{i("none")}}),s.jsx(A,{className:D("property-button"),visible:!0,icon:qn,type:"button",title:o("line.arrow"),"aria-label":o("line.arrow"),selected:n==="arrow",onPointerUp:()=>{i("arrow")}})]})})},jn=({board:e,end:t,endProperty:r})=>{const[n,o]=E.useState(!1),i=r==null?void 0:r.marker,a=m.PlaitBoard.getBoardContainer(e),{t:l}=te(),c=`${l(`line.${t}`)} — ${l(`line.${i}`)}`;return s.jsxs(xe,{sideOffset:12,open:n,onOpenChange:u=>{o(u)},placement:"top",children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{className:D(`property-button  ${t==="source"?"source-arrow-button":""}`),visible:!0,icon:i==="none"?Kn:qn,type:"button",title:c,"aria-label":c,selected:n,onPointerUp:()=>{o(!n)}})}),s.jsx(be,{container:a,children:s.jsx(Cl,{end:t,property:r})})]})},bl=()=>{var g,y;const e=Z.useBoard(),t=m.getSelectedElements(e),[r,n]=E.useState(!1),o=E.useRef(r),i=t.length>0&&!m.isSelectionMoving(e)&&!t.some(j.PlaitDrawElement.isImage),{viewport:a,selection:l,children:c}=e,{refs:u,floatingStyles:d}=F.useFloating({placement:"right-start",middleware:[F.offset(32),F.flip()]});let h={fill:"red"};if(i&&!r){const v=t.some(k=>Pl(e,k))&&!m.PlaitBoard.hasBeenTextEditing(e),x=t.some(k=>Ll(e,k)),p=t.some(k=>jo(e,k))&&!m.PlaitBoard.hasBeenTextEditing(e),b=t.some(k=>Sl(e,k))&&!m.PlaitBoard.hasBeenTextEditing(e),C=t.every(k=>j.PlaitDrawElement.isArrowLine(k));h={...kl(e),hasFill:v,hasFontColor:x,hasStroke:p,hasStrokeStyle:b,hasText:x,isLine:C}}const{t:f}=te();return E.useEffect(()=>{if(i){const v=t.length>0;if(!r&&v){const x=m.getSelectedElements(e),p=m.getRectangleByElements(e,x,!1),[b,C]=m.RectangleClient.getPoints(p),k=m.toScreenPointFromHostPoint(e,m.toHostPointFromViewBoxPoint(e,b)),L=m.toScreenPointFromHostPoint(e,m.toHostPointFromViewBoxPoint(e,C)),_=L[0]-k[0],Y=L[1]-k[1];u.setPositionReference({getBoundingClientRect(){return{width:_,height:Y,x:k[0],y:k[1],top:k[1],left:k[0],right:k[0]+_,bottom:k[1]+Y}}})}}},[a,l,c,r]),E.useEffect(()=>{o.current=r},[r]),E.useEffect(()=>{const{pointerUp:v,pointerMove:x}=e;return e.pointerMove=p=>{(m.isMovingElements(e)||m.isDragging(e))&&!o.current&&n(!0),x(p)},e.pointerUp=p=>{o.current&&(m.isMovingElements(e)||m.isDragging(e))&&n(!1),v(p)},()=>{e.pointerUp=v,e.pointerMove=x}},[e]),s.jsx(s.Fragment,{children:i&&!r&&s.jsx(ce,{padding:1,className:D("popup-toolbar",m.ATTACHED_ELEMENT_CLASS_NAME),ref:u.setFloating,style:d,children:s.jsxs(oe.Row,{gap:1,children:[h.hasFontColor&&s.jsx(ea,{board:e,currentColor:(g=h.marks)==null?void 0:g.color,title:f("popupToolbar.fontColor"),fontColorIcon:s.jsx(xs,{currentColor:(y=h.marks)==null?void 0:y.color})},0),h.hasStroke&&s.jsx(ta,{board:e,currentColor:h.strokeColor,title:f("popupToolbar.stroke"),hasStrokeStyle:h.hasStrokeStyle||!1,children:s.jsx("label",{className:D("stroke-label","color-label"),style:{borderColor:h.strokeColor}})},1),h.hasFill&&s.jsx(ra,{board:e,currentColor:h.fill,title:f("popupToolbar.fillColor"),children:s.jsx("label",{className:D("fill-label","color-label",{"color-white":h.fill&&pr(Oe(h.fill))}),style:{backgroundColor:h.fill}})},2),h.hasText&&s.jsx(xl,{board:e,title:f("popupToolbar.link")},3),h.isLine&&s.jsxs(s.Fragment,{children:[s.jsx(jn,{board:e,end:"source",endProperty:h.source},4),s.jsx(jn,{board:e,end:"target",endProperty:h.target},5)]})]})})})},El=(e,t)=>{const r=pe.getTextMarksByElement(t);return{fill:t.fill,strokeColor:I.getStrokeColorByElement(e,t),marks:r}},jl=(e,t)=>{const r=pe.getTextMarksByElement(t);return{fill:t.fill,strokeColor:j.getStrokeColorByElement(e,t),marks:r,source:(t==null?void 0:t.source)||{},target:(t==null?void 0:t.target)||{}}},kl=e=>{const t=m.getSelectedElements(e)[0];return I.MindElement.isMindElement(e,t)?El(e,t):jl(e,t)},Pl=(e,t)=>I.MindElement.isMindElement(e,t)||j.isClosedCustomGeometry(e,t)?!0:j.PlaitDrawElement.isDrawElement(t)?j.PlaitDrawElement.isShapeElement(t)&&!j.PlaitDrawElement.isImage(t)&&!j.PlaitDrawElement.isText(t)&&j.isClosedDrawElement(t):!1,jo=(e,t)=>I.MindElement.isMindElement(e,t)||ge.isFreehand(t)?!0:j.PlaitDrawElement.isDrawElement(t)?j.PlaitDrawElement.isShapeElement(t)&&!j.PlaitDrawElement.isImage(t)&&!j.PlaitDrawElement.isText(t)||j.PlaitDrawElement.isArrowLine(t)||j.PlaitDrawElement.isVectorLine(t)||j.PlaitDrawElement.isTable(t):!1,Sl=(e,t)=>jo(e,t),Ll=(e,t)=>I.MindElement.isMindElement(e,t)?!0:j.PlaitDrawElement.isDrawElement(t)?j.isDrawElementsIncludeText([t]):!1,ko=({icon:e,shortcut:t,href:r,children:n,onSelect:o,className:i="",selected:a,...l})=>{const c=eo(l.onClick,o);return s.jsx("a",{...l,href:r,target:"_blank",rel:"noreferrer",className:Qt(i,a),title:l.title??l["aria-label"],onClick:c,children:s.jsx(to,{icon:e,shortcut:t,children:n})})};ko.displayName="MenuItemLink";const Po=()=>{const e=Z.useBoard(),{t}=te();return s.jsx(se,{"data-testid":"save-button",onSelect:()=>{Fn(e)},icon:us,"aria-label":t("menu.saveFile"),shortcut:"Cmd+S",children:t("menu.saveFile")})};Po.displayName="SaveToFile";const So=()=>{const e=Z.useBoard(),t=Z.useListRender(),{t:r}=te(),n=(o,i,a)=>{e.children=o,e.viewport=i||{zoom:1},e.theme={themeColorMode:m.ThemeColorMode.default},t.update(e.children,{board:e,parent:e,parentG:m.PlaitBoard.getElementHost(e)}),m.BoardTransforms.fitViewport(e)};return s.jsx(se,{"data-testid":"open-button",onSelect:()=>{Si(e).then(o=>{n(o.elements,o.viewport)})},icon:ds,"aria-label":r("menu.open"),children:r("menu.open")})};So.displayName="OpenFile";const Lo=()=>{const e=Z.useBoard(),t=E.useContext(jt),{t:r}=te();return s.jsx(se,{icon:as,"data-testid":"image-export-button",onSelect:()=>{Je(e,!0)},submenu:s.jsxs(Ve,{onSelect:()=>{var o;const n=new CustomEvent(qe.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});(o=t.onSelect)==null||o.call(t,n)},children:[s.jsx(se,{onSelect:()=>{Je(e,!0)},"aria-label":r("menu.exportImage.png"),children:r("menu.exportImage.png")}),s.jsx(se,{onSelect:()=>{Je(e,!1)},"aria-label":r("menu.exportImage.jpg"),children:r("menu.exportImage.jpg")})]}),shortcut:"Cmd+Shift+E","aria-label":r("menu.exportImage"),children:r("menu.exportImage")})};Lo.displayName="SaveAsImage";const Oo=()=>{const{appState:e,setAppState:t}=ve(),{t:r}=te();return s.jsx(se,{icon:vt,"data-testid":"reset-button",onSelect:()=>{t({...e,openCleanConfirm:!0})},shortcut:"Cmd+Backspace","aria-label":r("menu.cleanBoard"),children:r("menu.cleanBoard")})};Oo.displayName="CleanBoard";const To=()=>s.jsx(ko,{icon:ss,href:"https://github.com/plait-board/drawnix","aria-label":"GitHub",children:"GitHub"});To.displayName="Socials";const Mo=()=>{const{language:e,setLanguage:t,t:r}=te(),n=E.useContext(jt);return s.jsx(se,{icon:Un,"data-testid":"language-switcher-button",onSelect:()=>{},submenu:s.jsxs(Ve,{onSelect:()=>{var i;const o=new CustomEvent(qe.MENU_ITEM_SELECT,{bubbles:!0,cancelable:!0});(i=n.onSelect)==null||i.call(n,o)},children:[s.jsx(se,{onSelect:()=>{t("zh")},"aria-label":r("language.chinese"),selected:e==="zh",children:r("language.chinese")}),s.jsx(se,{onSelect:()=>{t("en")},"aria-label":r("language.english"),selected:e==="en",children:r("language.english")})]}),"aria-label":r("language.switcher"),children:r("language.switcher")})};Mo.displayName="LanguageSwitcherMenu";const Do=()=>s.jsx("div",{style:{height:"1px",backgroundColor:"var(--color-gray-10)",margin:".5rem 0"}});Do.displayName="MenuSeparator";const Ol=()=>{const e=Z.useBoard(),{t}=te(),r=m.PlaitBoard.getBoardContainer(e),n=m.getSelectedElements(e),[o,i]=E.useState(!1),a=e.history.undos.length<=0,l=e.history.redos.length<=0;return s.jsx(ce,{padding:1,className:D("app-toolbar",m.ATTACHED_ELEMENT_CLASS_NAME),children:s.jsxs(oe.Row,{gap:1,children:[s.jsxs(xe,{sideOffset:12,open:o,onOpenChange:c=>{i(c)},placement:"bottom-start",children:[s.jsx(Ce,{asChild:!0,children:s.jsx(A,{type:"icon",visible:!0,selected:o,icon:Un,title:t("general.menu"),"aria-label":t("general.menu"),onPointerDown:()=>{i(!o)}})}),s.jsx(be,{container:r,children:s.jsxs(Ve,{onSelect:()=>{i(!1)},children:[s.jsx(So,{}),s.jsx(Po,{}),s.jsx(Lo,{}),s.jsx(Oo,{}),s.jsx(Do,{}),s.jsx(Mo,{}),s.jsx(To,{})]})})]},0),s.jsx(A,{type:"icon",icon:Cs,visible:!0,title:t("general.undo"),"aria-label":t("general.undo"),onPointerUp:()=>{e.undo()},disabled:a},1),s.jsx(A,{type:"icon",icon:bs,visible:!0,title:t("general.redo"),"aria-label":t("general.redo"),onPointerUp:()=>{e.redo()},disabled:l},2),n.length>0&&s.jsx(A,{className:"duplicate",type:"icon",icon:Es,visible:!0,title:t("general.duplicate"),"aria-label":t("general.duplicate"),onPointerUp:()=>{m.duplicateElements(e)}},3),n.length>0&&s.jsx(A,{className:"trash",type:"icon",icon:vt,visible:!0,title:t("general.delete"),"aria-label":t("general.delete"),onPointerUp:()=>{m.deleteFragment(e)}},4)]})})},Tl=e=>r=>{const{globalKeyDown:n,keyDown:o}=r;return r.globalKeyDown=i=>{if(!(i.target instanceof HTMLInputElement||i.target instanceof HTMLTextAreaElement)&&(m.PlaitBoard.getMovingPointInBoard(r)||m.PlaitBoard.isMovingPointInBoard(r))&&!m.PlaitBoard.hasBeenTextEditing(r)){if(ye.isHotkey(["mod+shift+e"],{byKey:!0})(i)){Je(r,!0),i.preventDefault();return}if(ye.isHotkey(["mod+s"],{byKey:!0})(i)){Fn(r),i.preventDefault();return}if(ye.isHotkey(["mod+backspace"])(i)||ye.isHotkey(["mod+delete"])(i)){e({openCleanConfirm:!0}),i.preventDefault();return}if(ye.isHotkey(["mod+u"])(i)&&hr(r),!i.altKey&&!i.metaKey&&!i.ctrlKey){if(i.key==="h"&&(m.BoardTransforms.updatePointerType(r,m.PlaitPointerType.hand),e({pointer:m.PlaitPointerType.hand})),i.key==="v"&&(m.BoardTransforms.updatePointerType(r,m.PlaitPointerType.selection),e({pointer:m.PlaitPointerType.selection})),i.key==="m"&&(P.setCreationMode(r,P.BoardCreationMode.dnd),m.BoardTransforms.updatePointerType(r,I.MindPointerType.mind),e({pointer:I.MindPointerType.mind})),i.key==="e"&&(P.setCreationMode(r,P.BoardCreationMode.drawing),m.BoardTransforms.updatePointerType(r,de.eraser),e({pointer:de.eraser})),i.key==="p"&&(P.setCreationMode(r,P.BoardCreationMode.drawing),m.BoardTransforms.updatePointerType(r,de.feltTipPen),e({pointer:de.feltTipPen})),i.key==="a"&&!ye.isHotkey(["mod+a"])(i)&&m.getSelectedElements(r).length===0&&(P.setCreationMode(r,P.BoardCreationMode.drawing),m.BoardTransforms.updatePointerType(r,j.ArrowLineShape.straight),e({pointer:j.ArrowLineShape.straight})),i.key==="r"||i.key==="o"||i.key==="t"){const l={r:j.BasicShapes.rectangle,o:j.BasicShapes.ellipse,t:j.BasicShapes.text};l[i.key]===j.BasicShapes.text?P.setCreationMode(r,P.BoardCreationMode.dnd):P.setCreationMode(r,P.BoardCreationMode.drawing),m.BoardTransforms.updatePointerType(r,l[i.key]),e({pointer:l[i.key]})}i.preventDefault();return}}n(i)},r.keyDown=i=>{if(ye.isHotkey(["mod+z"],{byKey:!0})(i)){r.undo(),i.preventDefault();return}if(ye.isHotkey(["mod+shift+z"],{byKey:!0})(i)){r.redo(),i.preventDefault();return}o(i)},r};function Ml(){return[de.feltTipPen,de.eraser]}const kn=(e,t)=>({id:m.idCreator(),type:"freehand",shape:e,points:t}),_o=(e,t,r)=>{const n=m.rotateAntiPointsByElement(e,r,t)||r,o=t.points;return j.isClosedPoints(t.points)&&m.isPointInPolygon(n,o)||j.isHitPolyLine(o,n)},Dl=(e,t,r)=>{const n=m.RectangleClient.getRectangleByPoints([r.anchor,r.focus]);return j.isRectangleHitRotatedPoints(n,t.points,t.angle)},Pn=e=>m.getSelectedElements(e).filter(t=>ge.isFreehand(t)),_l=e=>$n[e].strokeColor,Bl=e=>$n[e].fill,Fl=(e,t)=>{const r=_l(e.theme.themeColorMode);return t.strokeColor||r},Al=(e,t)=>{const r=ge.isFreehand(t)&&j.isClosedCustomGeometry(e,t)?Bl(e.theme.themeColorMode):j.DefaultDrawStyle.fill;return t.fill||r};function Il(e,t){return Math.exp(-(e*e)/(2*t*t))}function Rl(e,t,r){if(e.length<2)return e;const n=Math.floor(r/2),o=[];function i(l){if(l<0){const c=-l-1;if(c<e.length)return[2*e[0][0]-e[c][0],2*e[0][1]-e[c][1]]}else if(l>=e.length){const c=2*e.length-l-1;if(c>=0)return[2*e[e.length-1][0]-e[c][0],2*e[e.length-1][1]-e[c][1]]}return e[l]}function a(l){const c=Math.min(l,e.length-1-l);return Math.min(n,c+Math.floor(n/2))}for(let l=0;l<e.length;l++){let c=0,u=0,d=0;const h=a(l);for(let f=-h;f<=h;f++){const g=l+f,y=i(g);let v=Il(f,t);if(l<n||l>=e.length-n){const x=1+.5*(1-Math.abs(f)/h);v*=f===0?x:1}c+=y[0]*v,u+=y[1]*v,d+=v}l===0||l===e.length-1?o.push([e[l][0],e[l][1]]):o.push([c/d,u/d])}return o}class Bo extends P.Generator{draw(t){const r=j.getStrokeWidthByElement(t),n=Fl(this.board,t),o=Al(this.board,t),i={strokeWidth:r,stroke:n,fill:o,fillStyle:"solid"},a=m.PlaitBoard.getRoughSVG(this.board).curve(Rl(t.points,1,3),i);return m.setStrokeLinecap(a,"round"),a}canDraw(t){return!0}}class Nl extends P.CommonElementFlavour{constructor(){super()}initializeGenerator(){this.activeGenerator=P.createActiveGenerator(this.board,{getRectangle:t=>m.RectangleClient.getRectangleByPoints(t.points),getStrokeWidth:()=>m.ACTIVE_STROKE_WIDTH,getStrokeOpacity:()=>1,hasResizeHandle:()=>P.hasResizeHandle(this.board,this.element)}),this.generator=new Bo(this.board)}initialize(){super.initialize(),this.initializeGenerator(),this.generator.processDrawing(this.element,this.getElementG())}onContextChanged(t,r){t.element!==r.element||t.hasThemeChanged?(this.generator.processDrawing(this.element,this.getElementG()),this.activeGenerator.processDrawing(this.element,m.PlaitBoard.getActiveHost(this.board),{selected:this.selected})):(t.selected!==r.selected||t.selected)&&this.activeGenerator.processDrawing(this.element,m.PlaitBoard.getActiveHost(this.board),{selected:this.selected})}destroy(){var t;super.destroy(),(t=this.activeGenerator)==null||t.destroy()}}class zl{constructor(t={}){this.defaultOptions={smoothing:.65,velocityWeight:.2,curvatureWeight:.3,minDistance:.2,maxPoints:8,pressureSensitivity:.5,tiltSensitivity:.3,velocityThreshold:800,samplingRate:5},this.points=[],this.lastProcessedTime=0,this.movingAverageVelocity=[],this.velocityWindowSize=3,this.options={...this.defaultOptions,...t}}process(t,r={}){const n=r.timestamp??Date.now();if(this.points.length===0){const c={point:t,timestamp:n,...r};return this.points.push(c),this.lastProcessedTime=n,t}if(n-this.lastProcessedTime<this.options.samplingRate&&n-this.lastProcessedTime<2)return null;const o={point:t,timestamp:n,...r};if(!this.checkDistance(t)&&this.points.length>1&&n-this.lastProcessedTime<32)return null;this.updatePoints(o);const a=this.calculateDynamicParameters(o),l=this.smooth(t,a);return this.lastProcessedTime=n,l}reset(){this.points=[],this.lastProcessedTime=0,this.movingAverageVelocity=[]}updatePoints(t){this.points.push(t),this.points.length>this.options.maxPoints&&this.points.shift()}checkDistance(t){if(this.points.length===0)return!0;const r=this.points[this.points.length-1].point,n=this.getDistance(r,t);let o=this.options.minDistance;if(this.movingAverageVelocity.length>0){const i=this.getAverageVelocity();o*=Math.max(.5,Math.min(1.5,i/200))}return n>=o}calculateDynamicParameters(t){const r=this.calculateVelocity(t);this.updateMovingAverage(r);const n=this.getAverageVelocity(),o={...this.options};if(t.pressure!==void 0){const a=Math.pow(t.pressure,1.2);o.smoothing*=1-a*o.pressureSensitivity*.8}const i=Math.min(n/o.velocityThreshold,1);if(o.velocityWeight=.2+i*.3,o.smoothing*=1+i*.2,t.tiltX!==void 0&&t.tiltY!==void 0){const a=Math.sqrt(t.tiltX**2+t.tiltY**2)/90;o.smoothing*=1+a*o.tiltSensitivity*.7}return o}smooth(t,r){if(this.points.length<2)return t;const n=this.calculateWeights(r),o=n.reduce((a,l)=>a+l,0);if(o===0)return t;const i=[0,0];for(let a=0;a<this.points.length;a++){const l=n[a]/o;i[0]+=this.points[a].point[0]*l,i[1]+=this.points[a].point[1]*l}return i}calculateWeights(t){const r=[],n=this.points.length-1;for(let o=0;o<this.points.length;o++){let i=Math.pow(t.smoothing,(n-o)*.8);if(o<n){const a=this.getPointVelocity(o);i*=1+a*t.velocityWeight*.8}if(o>0&&o<n){const a=this.getPointCurvature(o);i*=1+a*t.curvatureWeight*.7}r.push(i)}return r}getDistance(t,r){return m.distanceBetweenPointAndPoint(t[0],t[1],r[0],r[1])}calculateVelocity(t){if(this.points.length<2)return 0;const r=this.points[this.points.length-1],n=this.getDistance(r.point,t.point),o=t.timestamp-r.timestamp;return o>0?n/o:0}updateMovingAverage(t){this.movingAverageVelocity.push(t),this.movingAverageVelocity.length>this.velocityWindowSize&&this.movingAverageVelocity.shift()}getAverageVelocity(){return this.movingAverageVelocity.length===0?0:this.movingAverageVelocity.reduce((t,r)=>t+r)/this.movingAverageVelocity.length}getPointVelocity(t){if(t>=this.points.length-1)return 0;const r=this.points[t],n=this.points[t+1],o=this.getDistance(r.point,n.point),i=n.timestamp-r.timestamp;return i>0?o/i:0}getPointCurvature(t){if(t<=0||t>=this.points.length-1)return 0;const r=this.points[t-1].point,n=this.points[t].point,o=this.points[t+1].point,i=this.getDistance(r,n),a=this.getDistance(n,o),l=this.getDistance(r,o),c=(i+a+l)/2;return 4*Math.sqrt(Math.max(0,c*(c-i)*(c-a)*(c-l)))/(i*a*l+1e-4)}}const Hl=e=>{const{pointerDown:t,pointerMove:r,pointerUp:n,globalPointerUp:o}=e;let i=!1,a=!1,l=[],c=null;const u=new Bo(e),d=new zl({smoothing:.7,pressureSensitivity:.6});let h=null;const f=g=>{if(i){const y=m.PlaitBoard.getPointer(e);a&&l.push(l[0]),h=kn(y,l)}h&&!g&&m.Transforms.insertNode(e,h,[e.children.length]),u==null||u.destroy(),h=null,i=!1,l=[],d.reset()};return e.pointerDown=g=>{const y=Ml();if(m.PlaitBoard.isInPointer(e,y)&&P.isDrawingMode(e)){i=!0,c=[g.x,g.y];const x=d.process(c),p=m.toViewBoxPoint(e,m.toHostPoint(e,x[0],x[1]));l.push(p)}t(g)},e.pointerMove=g=>{if(i){const y=[g.x,g.y];c&&m.distanceBetweenPointAndPoint(c[0],c[1],y[0],y[1])<8?a=!0:a=!1;const v=d.process(y);if(v){u==null||u.destroy();const x=m.toViewBoxPoint(e,m.toHostPoint(e,v[0],v[1]));l.push(x);const p=m.PlaitBoard.getPointer(e);h=kn(p,l),u.processDrawing(h,m.PlaitBoard.getElementTopHost(e))}return}r(g)},e.pointerUp=g=>{f(),n(g)},e.globalPointerUp=g=>{f(!0),o(g)},e},Ul=e=>{const t=e,{getDeletedFragment:r,buildFragment:n,insertFragment:o}=t;return t.getDeletedFragment=i=>{const a=Pn(t);return a.length&&i.push(...a),r(i)},t.buildFragment=(i,a,l,c)=>{const u=Pn(t);if(u.length){const d=P.buildClipboardData(t,u,a?[a.x,a.y]:[0,0]);i=m.addOrCreateClipboardContext(i,{text:"",type:m.WritableClipboardType.elements,elements:d})}return n(i,a,l,c)},t.insertFragment=(i,a,l)=>{var u;const c=(u=i==null?void 0:i.elements)==null?void 0:u.filter(d=>ge.isFreehand(d));c&&c.length>0&&P.insertClipboardData(t,c,a),o(i,a,l)},t},Wl=e=>{const{pointerDown:t,pointerMove:r,pointerUp:n,globalPointerUp:o}=e;let i=!1;const a=new Set,l=d=>{const h=m.toViewBoxPoint(e,m.toHostPoint(e,d[0],d[1]));e.children.filter(g=>ge.isFreehand(g)).forEach(g=>{!a.has(g.id)&&_o(e,g,h)&&(m.PlaitElement.getElementG(g).style.opacity="0.2",a.add(g.id))})},c=()=>{if(a.size>0){const d=e.children.filter(h=>a.has(h.id));d.length>0&&m.CoreTransforms.removeElements(e,d)}},u=()=>{i&&(c(),i=!1,a.clear())};return e.pointerDown=d=>{if(m.PlaitBoard.isInPointer(e,[de.eraser])&&P.isDrawingMode(e)){i=!0,a.clear();const f=[d.x,d.y];l(f);return}t(d)},e.pointerMove=d=>{if(i){m.throttleRAF(e,"with-freehand-erase",()=>{const h=[d.x,d.y];l(h)});return}r(d)},e.pointerUp=d=>{if(i){u();return}n(d)},e.globalPointerUp=d=>{if(i){u();return}o(d)},e},ql=e=>{const{getRectangle:t,drawElement:r,isHit:n,isRectangleHit:o,getOneHitElement:i,isMovable:a,isAlign:l}=e;return e.drawElement=c=>ge.isFreehand(c.element)?Nl:r(c),e.getRectangle=c=>ge.isFreehand(c)?m.RectangleClient.getRectangleByPoints(c.points):t(c),e.isRectangleHit=(c,u)=>ge.isFreehand(c)?Dl(e,c,u):o(c,u),e.isHit=(c,u,d)=>ge.isFreehand(c)?_o(e,c,u):n(c,u,d),e.getOneHitElement=c=>c.every(d=>ge.isFreehand(d))?j.getHitDrawElement(e,c):i(c),e.isMovable=c=>ge.isFreehand(c)?!0:a(c),e.isAlign=c=>ge.isFreehand(c)?!0:l(c),e.setPluginOptions(j.WithDrawPluginKey,{customGeometryTypes:[Vn]}),Wl(Ul(Hl(e)))},Kl=()=>{const e=Z.useBoard(),{t}=te(),r=e.theme;return s.jsx(ce,{padding:1,className:D("theme-toolbar",m.ATTACHED_ELEMENT_CLASS_NAME),children:s.jsxs("select",{onChange:n=>{const o=n.target.value;m.BoardTransforms.updateThemeColor(e,o)},value:r.themeColorMode,children:[s.jsx("option",{value:"default",children:t("theme.default")}),s.jsx("option",{value:"colorful",children:t("theme.colorful")}),s.jsx("option",{value:"soft",children:t("theme.soft")}),s.jsx("option",{value:"retro",children:t("theme.retro")}),s.jsx("option",{value:"dark",children:t("theme.dark")}),s.jsx("option",{value:"starry",children:t("theme.starry")})]})})},Fo=new WeakMap,Sn=e=>!!Fo.get(e),Ao=(e,t)=>{Fo.set(e,t)},$l=e=>r=>{const{pointerDown:n}=r;return r.pointerDown=o=>{m.isPencilEvent(o)&&!Sn(r)&&(Ao(r,!0),e({isPencilMode:!0})),!(Sn(r)&&!m.isPencilEvent(o))&&n(o)},r},Vl=()=>{const e=Z.useBoard(),{appState:t,setAppState:r}=ve();return s.jsx(s.Fragment,{children:t.isPencilMode&&s.jsx("div",{className:"pencil-mode-toolbar",children:s.jsx(A,{type:"button",visible:!0,title:"X Pencil","aria-label":"Arrow",label:"Pencil X",onPointerDown:()=>{r({...t,isPencilMode:!1}),Ao(e,!1)}})})})};function Gl({initialOpen:e=!1,open:t,onOpenChange:r}={}){const[n,o]=K.useState(e),[i,a]=K.useState(),[l,c]=K.useState(),u=t??n,d=r??o,h=F.useFloating({open:u,onOpenChange:d}),f=h.context,g=F.useClick(f,{enabled:t==null}),y=F.useDismiss(f,{outsidePressEvent:"mousedown"}),v=F.useRole(f),x=F.useInteractions([g,y,v]);return K.useMemo(()=>({open:u,setOpen:d,...x,...h,labelId:i,descriptionId:l,setLabelId:a,setDescriptionId:c}),[u,d,x,h,i,l])}const Io=K.createContext(null),st=()=>{const e=K.useContext(Io);if(e==null)throw new Error("Dialog components must be wrapped in <Dialog />");return e};function sr({children:e,...t}){const r=Gl(t);return s.jsx(Io.Provider,{value:r,children:e})}K.forwardRef(function({children:t,asChild:r=!1,...n},o){const i=st(),a=t.ref,l=F.useMergeRefs([i.refs.setReference,o,a]);return r&&K.isValidElement(t)?K.cloneElement(t,i.getReferenceProps({ref:l,...n,...t.props,"data-state":i.open?"open":"closed"})):s.jsx("button",{ref:l,"data-state":i.open?"open":"closed",...i.getReferenceProps(n),children:t})});const ar=K.forwardRef(function(t,r){const{context:n,...o}=st(),i=F.useMergeRefs([o.refs.setFloating,r]);return n.open?s.jsx(F.FloatingPortal,{root:t.container,children:s.jsx(F.FloatingOverlay,{className:"Dialog-overlay",lockScroll:!0,children:s.jsx(F.FloatingFocusManager,{context:n,children:s.jsx("div",{ref:i,"aria-labelledby":o.labelId,"aria-describedby":o.descriptionId,...o.getFloatingProps(t),children:t.children})})})}):null});K.forwardRef(function({children:t,...r},n){const{setLabelId:o}=st(),i=F.useId();return K.useLayoutEffect(()=>(o(i),()=>o(void 0)),[i,o]),s.jsx("h2",{...r,ref:n,id:i,children:t})});K.forwardRef(function({children:t,...r},n){const{setDescriptionId:o}=st(),i=F.useId();return K.useLayoutEffect(()=>(o(i),()=>o(void 0)),[i,o]),s.jsx("p",{...r,ref:n,id:i,children:t})});K.forwardRef(function(t,r){const{setOpen:n}=st();return s.jsx("button",{type:"button",...t,ref:r,onClick:()=>n(!1)})});const Ro=({children:e})=>s.jsx("div",{className:"ttd-dialog-panels",children:e}),bt=({label:e,children:t,panelAction:r,panelActionDisabled:n=!1,onTextSubmitInProgress:o,renderTopRight:i,renderSubmitShortcut:a,renderBottomRight:l})=>s.jsxs("div",{className:"ttd-dialog-panel",children:[s.jsxs("div",{className:"ttd-dialog-panel__header",children:[s.jsx("label",{children:e}),i==null?void 0:i()]}),t,s.jsxs("div",{className:D("ttd-dialog-panel-button-container",{invisible:!r}),style:{display:"flex",alignItems:"center"},children:[s.jsx("button",{className:"ttd-dialog-panel-button drawnix-button ",onClick:r&&r.action,disabled:n||o,children:s.jsxs("div",{className:D({invisible:o}),children:[r==null?void 0:r.label,(r==null?void 0:r.icon)&&s.jsx("span",{children:r.icon})]})}),!n&&!o&&(a==null?void 0:a()),l==null?void 0:l()]})]}),Ln={CTRL_OR_CMD:m.IS_IOS||m.IS_APPLE?"metaKey":"ctrlKey",ENTER:"Enter"},No=({input:e,placeholder:t,onChange:r,onKeyboardSubmit:n})=>{const o=E.useRef(null),i=E.useRef(n);return i.current=n,E.useEffect(()=>{if(!i.current)return;const a=o.current;if(a){const l=c=>{var u;c[Ln.CTRL_OR_CMD]&&c.key===Ln.ENTER&&(c.preventDefault(),(u=i.current)==null||u.call(i))};return a.addEventListener(qe.KEYDOWN,l),()=>{a.removeEventListener(qe.KEYDOWN,l)}}},[]),s.jsx("textarea",{className:"ttd-dialog-input",onChange:r,value:e,placeholder:t,autoFocus:!0,ref:o})},Zl=({error:e})=>s.jsxs("div",{"data-testid":"ttd-dialog-output-error",className:"ttd-dialog-output-error",children:["Error! ",s.jsx("p",{children:e})]}),zo=({error:e,value:t,loaded:r})=>{const n=[j.withDraw,I.withMind,P.withGroup,An],o={readonly:!0,hideScrollbar:!1,disabledScrollOnNonFocus:!0,themeColors:I.MindThemeColors};return s.jsxs("div",{className:"ttd-dialog-output-wrapper",children:[e&&s.jsx(Zl,{error:e.message}),s.jsx("div",{style:{opacity:e?"0.15":1},className:"ttd-dialog-output-canvas-container",children:s.jsx(Z.Wrapper,{value:t,options:o,plugins:n,children:s.jsx(Z.Board,{})})})]})},Ho=()=>s.jsxs("div",{className:"ttd-dialog-submit-shortcut",children:[s.jsx("div",{className:"ttd-dialog-submit-shortcut__key",children:Jt("CtrlOrCmd")}),s.jsx("div",{className:"ttd-dialog-submit-shortcut__key",children:Jt("Enter")})]}),Yl=`flowchart TD
 A[Christmas] -->|Get money| B(Go shopping)
 B --> C{Let me think}
 C -->|One| D[Laptop]
 C -->|Two| E[iPhone]
 C -->|Three| F[Car]`,Xl=()=>{const{appState:e,setAppState:t}=ve(),{t:r,language:n}=te(),[o,i]=E.useState({loaded:!1,api:Promise.resolve({parseMermaidToDrawnix:async()=>({elements:[]})})});E.useEffect(()=>{(async()=>{try{const x=await import("@plait-board/mermaid-to-drawnix");i({loaded:!0,api:Promise.resolve(x)})}catch(x){console.error("Failed to load mermaid library:",x),f(new Error(r("dialog.error.loadMermaid")))}})()},[]);const[a,l]=E.useState(()=>Yl),[c,u]=E.useState(()=>[]),d=E.useDeferredValue(a.trim()),[h,f]=E.useState(null),g=Z.useBoard();E.useEffect(()=>{(async()=>{try{const x=await o.api;let p;try{p=await x.parseMermaidToDrawnix(d)}catch{p=await x.parseMermaidToDrawnix(d.replace(/"/g,"'"))}const{elements:b}=p;u(b),f(null)}catch(x){f(x)}})()},[d,o]);const y=()=>{if(!c.length)return;const v=m.PlaitBoard.getBoardContainer(g).getBoundingClientRect(),x=[v.width/2,v.height/2],p=g.viewport.zoom,b=m.getViewportOrigination(g),C=b[0]+x[0]/p,k=b[1]+x[1]/p,L=c,_=m.RectangleClient.getBoundingRectangle(L.filter(B=>!m.PlaitGroupElement.isGroup(B)).map(B=>m.RectangleClient.getRectangleByPoints(B.points))),Y=[C-_.width/2,k-_.height/2];g.insertFragment({elements:JSON.parse(JSON.stringify(L))},Y,m.WritableClipboardOperationType.paste),t({...e,openDialogType:null})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ttd-dialog-desc",children:n==="zh"?s.jsxs(s.Fragment,{children:[r("dialog.mermaid.description")," ",s.jsx("a",{href:"https://mermaid.js.org/syntax/flowchart.html",target:"_blank",rel:"noreferrer",children:r("dialog.mermaid.flowchart")}),"、",s.jsx("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",target:"_blank",rel:"noreferrer",children:r("dialog.mermaid.sequence")})," ","和"," ",s.jsx("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",target:"_blank",rel:"noreferrer",children:r("dialog.mermaid.class")}),r("dialog.mermaid.otherTypes")]}):s.jsxs(s.Fragment,{children:[r("dialog.mermaid.description")," ",s.jsx("a",{href:"https://mermaid.js.org/syntax/flowchart.html",target:"_blank",rel:"noreferrer",children:r("dialog.mermaid.flowchart")}),","," ",s.jsx("a",{href:"https://mermaid.js.org/syntax/sequenceDiagram.html",target:"_blank",rel:"noreferrer",children:r("dialog.mermaid.sequence")}),","," ",s.jsx("a",{href:"https://mermaid.js.org/syntax/classDiagram.html",target:"_blank",rel:"noreferrer",children:r("dialog.mermaid.class")}),r("dialog.mermaid.otherTypes")]})}),s.jsxs(Ro,{children:[s.jsx(bt,{label:r("dialog.mermaid.syntax"),children:s.jsx(No,{input:a,placeholder:r("dialog.mermaid.placeholder"),onChange:v=>l(v.target.value),onKeyboardSubmit:()=>{y()}})}),s.jsx(bt,{label:r("dialog.mermaid.preview"),panelAction:{action:()=>{y()},label:r("dialog.mermaid.insert")},renderSubmitShortcut:()=>s.jsx(Ho,{}),children:s.jsx(zo,{value:c,loaded:o.loaded,error:h})})]})]})},On=e=>e==="zh"?`# 我开始了

- 让我看看是谁搞出了这个 bug 🕵️ ♂️ 🔍
  - 😯 💣
    - 原来是我 👈 🎯 💘

- 竟然不可以运行，为什么呢 🚫 ⚙️ ❓
  - 竟然可以运行了，为什么呢？🎢 ✨
    - 🤯 ⚡ ➡️ 🎉

- 能运行起来的 🐞 🚀
  - 就不要去动它 🛑 ✋
    - 👾 💥 🏹 🎯
    
## 男孩还是女孩 👶 ❓ 🤷 ♂️ ♀️

### Hello world 👋 🌍 ✨ 💻

#### 哇 是个程序员 🤯 ⌨️ 💡 👩 💻`:`# I have started

- Let me see who made this bug 🕵️ ♂️ 🔍
  - 😯 💣
    - Turns out it was me 👈 🎯 💘

- Unexpectedly, it cannot run; why is that 🚫 ⚙️ ❓
  - Unexpectedly, it can run now; why is that? 🎢 ✨
    - 🤯 ⚡ ➡️ 🎉

- What can run 🐞 🚀
  - then do not touch it 🛑 ✋
    - 👾 💥 🏹 🎯
    
## Boy or girl 👶 ❓ 🤷 ♂️ ♀️

### Hello world 👋 🌍 ✨ 💻

#### Wow, a programmer 🤯 ⌨️ 💡 👩 💻`,Jl=()=>{const{appState:e,setAppState:t}=ve(),{t:r,language:n}=te(),[o,i]=E.useState({loaded:!1,api:Promise.resolve({parseMarkdownToDrawnix:(v,x)=>null})});E.useEffect(()=>{(async()=>{try{const x=await Promise.resolve().then(()=>require("./index-CrWg6Lvq.js"));i({loaded:!0,api:Promise.resolve(x)})}catch(x){console.error("Failed to load mermaid library:",x),f(new Error(r("dialog.error.loadMermaid")))}})()},[]);const[a,l]=E.useState(()=>On(n)),[c,u]=E.useState(()=>[]),d=E.useDeferredValue(a.trim()),[h,f]=E.useState(null),g=Z.useBoard();E.useEffect(()=>{l(On(n))},[n]),E.useEffect(()=>{(async()=>{try{const x=await o.api;let p;try{p=await x.parseMarkdownToDrawnix(d)}catch{p=await x.parseMarkdownToDrawnix(d.replace(/"/g,"'"))}const b=p;b.points=[[0,0]],b&&(u([b]),f(null))}catch(x){f(x)}})()},[d,o]);const y=()=>{if(!c.length)return;const v=m.PlaitBoard.getBoardContainer(g).getBoundingClientRect(),x=[v.width/4,v.height/2-20],p=g.viewport.zoom,b=m.getViewportOrigination(g),C=b[0]+x[0]/p,k=b[1]+x[1]/p,L=c;g.insertFragment({elements:JSON.parse(JSON.stringify(L))},[C,k],m.WritableClipboardOperationType.paste),t({...e,openDialogType:null})};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ttd-dialog-desc",children:r("dialog.markdown.description")}),s.jsxs(Ro,{children:[s.jsx(bt,{label:r("dialog.markdown.syntax"),children:s.jsx(No,{input:a,placeholder:r("dialog.markdown.placeholder"),onChange:v=>l(v.target.value),onKeyboardSubmit:()=>{y()}})}),s.jsx(bt,{label:r("dialog.markdown.preview"),panelAction:{action:()=>{y()},label:r("dialog.markdown.insert")},renderSubmitShortcut:()=>s.jsx(Ho,{}),children:s.jsx(zo,{value:c,loaded:o.loaded,error:h})})]})]})},Ql=({container:e})=>{const{appState:t,setAppState:r}=ve();return s.jsxs(s.Fragment,{children:[s.jsx(sr,{open:t.openDialogType===De.mermaidToDrawnix,onOpenChange:n=>{r({...t,openDialogType:n?De.mermaidToDrawnix:null})},children:s.jsx(ar,{className:"Dialog ttd-dialog",container:e,children:s.jsx(Xl,{})})}),s.jsx(sr,{open:t.openDialogType===De.markdownToDrawnix,onOpenChange:n=>{r({...t,openDialogType:n?De.markdownToDrawnix:null})},children:s.jsx(ar,{className:"Dialog ttd-dialog",container:e,children:s.jsx(Jl,{})})})]})},ec=({container:e})=>{const{appState:t,setAppState:r}=ve(),{t:n}=te(),o=Z.useBoard();return s.jsx(sr,{open:t.openCleanConfirm,onOpenChange:i=>{r({...t,openCleanConfirm:i})},children:s.jsxs(ar,{className:"clean-confirm",container:e,children:[s.jsx("h2",{className:"clean-confirm__title",children:n("cleanConfirm.title")}),s.jsx("p",{className:"clean-confirm__description",children:n("cleanConfirm.description")}),s.jsxs("div",{className:"clean-confirm__actions",children:[s.jsx("button",{className:"clean-confirm__button clean-confirm__button--cancel",onClick:()=>{r({...t,openCleanConfirm:!1})},children:n("cleanConfirm.cancel")}),s.jsx("button",{className:"clean-confirm__button clean-confirm__button--ok",autoFocus:!0,onClick:()=>{o.deleteFragment(o.children),r({...t,openCleanConfirm:!1})},children:n("cleanConfirm.ok")})]})]})})},Tn=e=>{const{appState:t}=e;return t&&t.linkState&&t.linkState.isHovering},Mn=e=>{const{appState:t}=e;return t&&t.linkState&&t.linkState.isEditing},tc=e=>r=>{const{pointerMove:n}=r;let o=null,i=null;return r.pointerMove=a=>{(m.PlaitBoard.isPointer(r,m.PlaitPointerType.selection)||m.PlaitBoard.isPointer(r,m.PlaitPointerType.hand))&&!m.isMovingElements(r)&&!P.isResizing(r)&&!Tn(r)&&!Mn(r)&&m.throttleRAF(r,"with-text-link",()=>{const l=a.target.closest(".plait-board-link");if(l&&l!==o){const c=l.closest(".plait-text-container"),u=We.toSlateNode(void 0,c),d=We.toSlateNode(void 0,l);o=l,e({linkState:{targetDom:l,targetElement:d,editor:u,isEditing:!1,isHovering:!1,isHoveringOrigin:!0}}),clearTimeout(i)}else!l&&o&&(i=setTimeout(()=>{!Tn(r)&&!Mn(r)&&e({linkState:null})},300),o=null)}),n(a)},r},rc="sk-o2VwufJTd4Un6aUgTfSwON547FA1Ztz3upNEmepySuPPRgI2",nc="https://api.tu-zi.com/v1";async function oc(e,t){var r,n,o,i;try{const a=e.map(h=>({type:"image_url",image_url:{url:h}})),l=await fetch(`${nc}/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${rc}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gemini-2.5-flash-image",messages:[{role:"user",content:[{type:"text",text:t},...a]}],stream:!0})});if(!l.ok)throw new Error(`API调用失败: ${l.statusText}`);let c="";const u=(r=l.body)==null?void 0:r.getReader();if(u){const h=new TextDecoder;for(;;){const{done:f,value:g}=await u.read();if(f)break;const v=h.decode(g).split(`
`);for(const x of v)if(x.startsWith("data: ")&&x!=="data: [DONE]")try{const b=(i=(o=(n=JSON.parse(x.slice(6)).choices)==null?void 0:n[0])==null?void 0:o.delta)==null?void 0:i.content;b&&(c+=b)}catch{}}}const d=c.match(/data:image\/[^;]+;base64,([A-Za-z0-9+/=]+)/);return d?{success:!0,imageUrl:d[0]}:{success:!1,error:"未找到生成的图片"}}catch(a){return{success:!1,error:a instanceof Error?a.message:"未知错误"}}}const ic=e=>{const t={...e},{pointerDown:r}=e;return t.pointerDown=n=>{if(n.button===2&&m.getSelectedElements(e).some(a=>a.type==="image"||I.MindElement.isMindElement(e,a)&&I.MindElement.hasImage(a))&&window.__drawnix_ai_image_handler){n.preventDefault(),window.__drawnix_ai_image_handler.showMenu(e,{x:n.clientX,y:n.clientY});return}r(n)},t};async function sc(e,t){const r=m.getSelectedElements(e),n=[];if(r.forEach(o=>{if(o.type==="image"){const i=o;n.push(i.url)}else if(I.MindElement.isMindElement(e,o)&&I.MindElement.hasImage(o)){const i=o;n.push(i.data.image.url)}}),n.length===0)return alert("请先选择图片"),!1;try{const o=await oc(n,t);if(o.success&&o.imageUrl){const a=await(await fetch(o.imageUrl)).blob(),l=new File([a],"ai-processed.png",{type:"image/png"});return await pt(e,l),!0}else return alert(`处理失败: ${o.error}`),!1}catch(o){return alert(`处理失败: ${o}`),!1}}const ac=()=>{var v,x,p,b;const[e,t]=E.useState(""),{appState:r,setAppState:n}=ve(),o=Z.useBoard(),{refs:i,floatingStyles:a}=F.useFloating({placement:"top",middleware:[F.offset(20),F.flip()]}),l=r.linkState,c=((v=r.linkState)==null?void 0:v.targetDom)||null,u=((x=r.linkState)==null?void 0:x.isEditing)||!1,d=((p=r.linkState)==null?void 0:p.isHoveringOrigin)||!1,h=((b=r.linkState)==null?void 0:b.isHovering)||!1,f=u||d||h,g=E.useRef(r.linkState);E.useEffect(()=>{g.current=r.linkState,r.linkState?t(r.linkState.targetElement.url):t("")},[r.linkState]),E.useEffect(()=>{if(c){const C=c.getBoundingClientRect();i.setPositionReference({getBoundingClientRect(){return{x:C.x,y:C.y,width:C.width,height:C.height,top:C.y,left:C.x,right:C.x+C.width,bottom:C.y+C.height}}})}},[o.viewport,c]),E.useEffect(()=>{const C=k=>{if(i.floating.current&&!i.floating.current.contains(k.target)){if(g.current){const L=pe.LinkEditor.getLinkElement(g.current.editor);L&&!L[0].url.trim()&&pe.LinkEditor.unwrapLink(g.current.editor)}n({...r,linkState:null})}};return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[]);const y=()=>{if(e!==l.targetElement.url){const k=l.editor,L=l.targetElement,_=We.findPath(k,L);Be.setNodes(k,{url:e},{at:_})}const C=pe.LinkEditor.getLinkElement(l.editor);n({...r,linkState:{...r.linkState,targetElement:C[0],isEditing:!1,isHoveringOrigin:!0}})};return f&&s.jsx(ce,{ref:i.setFloating,style:a,padding:1,className:D("link-popup"),onPointerEnter:()=>{h||n({...r,linkState:{...r.linkState,isHovering:!0}})},onPointerLeave:()=>{u||n({...r,linkState:{...r.linkState,isHovering:!1}})},children:s.jsx(oe.Row,{gap:1,align:"center",children:u?s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"text",value:e,onChange:C=>{t(C.target.value)},onKeyDown:C=>{C.key==="Enter"&&y()},className:"link-popup__input",autoFocus:!0}),s.jsx(A,{type:"icon",visible:!0,icon:vt,title:"Delete link","aria-label":"Delete link",onPointerDown:()=>{const C=l.editor,k=l.targetElement,L=We.findPath(C,k);Be.unwrapNodes(C,{at:L}),n({...r,linkState:null})}})]}):s.jsxs(s.Fragment,{children:[s.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"link-popup__link",children:e}),s.jsx(A,{className:"link-popup__edit",type:"icon",visible:!0,icon:fr,title:"Edit link","aria-label":"Edit link",onPointerDown:({event:C})=>{C.preventDefault(),n({...r,linkState:{...r.linkState,isEditing:!0}})}}),s.jsx(A,{type:"icon",visible:!0,icon:vt,title:"Delete link","aria-label":"Delete link",onPointerDown:()=>{const C=l.editor,k=l.targetElement,L=We.findPath(C,k);Be.unwrapNodes(C,{at:L}),n({...r,linkState:null})}})]})})})},lc=({board:e})=>{const[t,r]=E.useState(!1),[n,o]=E.useState({x:0,y:0}),[i,a]=E.useState(""),[l,c]=E.useState(!1);E.useEffect(()=>{if(!e)return;window.__drawnix_ai_image_handler={showMenu:(f,g)=>{o(g),r(!0),a("")}};const h=f=>{const g=f.target;t&&!g.closest("[data-ai-menu]")&&r(!1)};return document.addEventListener("click",h),()=>{delete window.__drawnix_ai_image_handler,document.removeEventListener("click",h)}},[e,t]);const u=async()=>{if(!(!e||!i.trim())){c(!0);try{await sc(e,i)&&r(!1)}finally{c(!1)}}},d=()=>{r(!1),a("")};return!t||!e?null:s.jsxs("div",{"data-ai-menu":!0,style:{position:"fixed",left:n.x,top:n.y,background:"white",border:"1px solid #e1e5e9",borderRadius:"8px",padding:"16px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"320px",maxWidth:"400px"},onClick:h=>h.stopPropagation(),children:[s.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:"600",color:"#2c3e50"},children:"🤖 AI 图片处理"}),s.jsx("textarea",{value:i,onChange:h=>a(h.target.value),placeholder:`输入处理指令，例如：
• 将图片转为黑白风格
• 去除背景
• 增强图片对比度`,style:{width:"100%",height:"80px",border:"1px solid #e1e5e9",borderRadius:"6px",padding:"12px",resize:"none",fontSize:"13px",fontFamily:"system-ui, -apple-system, sans-serif",lineHeight:"1.4"},autoFocus:!0}),s.jsxs("div",{style:{display:"flex",gap:"8px",marginTop:"12px",justifyContent:"flex-end"},children:[s.jsx("button",{onClick:d,style:{background:"transparent",color:"#6c757d",border:"1px solid #e1e5e9",borderRadius:"6px",padding:"8px 16px",cursor:"pointer",fontSize:"13px",fontWeight:"500"},children:"取消"}),s.jsx("button",{onClick:u,disabled:l||!i.trim(),style:{background:l?"#e9ecef":"#007AFF",color:l?"#6c757d":"white",border:"none",borderRadius:"6px",padding:"8px 16px",cursor:l?"default":"pointer",fontSize:"13px",fontWeight:"500"},children:l?"🔄 处理中...":"✨ 处理"})]})]})},cc=({value:e,viewport:t,theme:r,onChange:n,onSelectionChange:o,onViewportChange:i,onThemeChange:a,onValueChange:l,afterInit:c})=>{const u={readonly:!1,hideScrollbar:!1,disabledScrollOnNonFocus:!1,themeColors:I.MindThemeColors},[d,h]=E.useState(()=>{const p=new ei(window.navigator.userAgent);return{pointer:m.PlaitPointerType.hand,isMobile:p.mobile()!==null,isPencilMode:!1,openDialogType:null,openCleanConfirm:!1}}),[f,g]=E.useState(null);f&&(f.appState=d);const y=p=>{h({...d,...p})},v=[j.withDraw,P.withGroup,I.withMind,si,An,ic,Tl(y),ql,$l(y),tc(y)],x=E.useRef(null);return s.jsx(Zn,{children:s.jsx(Qn.Provider,{value:{appState:d,setAppState:h},children:s.jsx("div",{className:D("drawnix",{"drawnix--mobile":d.isMobile}),ref:x,children:s.jsxs(Z.Wrapper,{value:e,viewport:t,theme:r,options:u,plugins:v,onChange:p=>{n&&n(p)},onSelectionChange:o,onViewportChange:i,onThemeChange:a,onValueChange:l,children:[s.jsx(Z.Board,{afterInit:p=>{g(p),c&&c(p)}}),s.jsx(Ol,{}),s.jsx(Hs,{}),s.jsx(Us,{}),s.jsx(Kl,{}),s.jsx(bl,{}),s.jsx(ac,{}),s.jsx(lc,{board:f}),s.jsx(Vl,{}),s.jsx(Ql,{container:x.current}),s.jsx(ec,{container:x.current})]})})})})};exports.Drawnix=cc;exports.I18nProvider=Zn;exports.addImage=hr;exports.applyOpacityToHex=Ie;exports.base64ToBlob=Nn;exports.boardToImage=zn;exports.composeEventHandlers=Rn;exports.download=Hn;exports.getCurrentFill=xr;exports.getCurrentFontColor=Vs;exports.getCurrentStrokeColor=Cr;exports.getDefaultExportFromCjs=oi;exports.getShortcutKey=Jt;exports.hexAlphaToOpacity=Re;exports.isClosedElement=yr;exports.isDefaultStroke=lo;exports.isFullyOpaque=Ge;exports.isFullyTransparent=vr;exports.isNoColor=_e;exports.isPromiseLike=In;exports.isTransparent=Ks;exports.isValidColor=ao;exports.isWhite=pr;exports.removeHexAlpha=Oe;exports.saveAsImage=Je;exports.splitRows=Et;exports.useI18n=te;
